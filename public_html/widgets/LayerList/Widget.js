// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/query jimu/dijit/CheckBox jimu/dijit/DropMenu ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html dojo/dom-class dojo/dom-style ./NlsStrings".split(" "),function(s,q,c,f,g,n,h,p,t,u,r,b,a,e,k){return q([s,r],{templateString:b,_currentSelectedLayerRowNode:null,operationsDropMenu:null,postMixInProperties:function(){this.inherited(arguments);
this.nls=k.value},postCreate:function(){f.forEach(this.operLayerInfos.getLayerInfoArray(),function(d){this.drawListNode(d,0,this.layerListTable,!0)},this);f.forEach(this.operLayerInfos.getTableInfoArray(),function(d){this.drawListNode(d,0,this.tableListTable,!0)},this);this._initOperations()},drawListNode:function(d,l,v){var e;this.isLayerHiddenInWidget(d)||(0===d.newSubLayers.length?(e=this.addLayerNode(d,l,v),this.config.showLegend?this.addLegendNode(d,l,e.subNode):(d=h(".showLegend-div",e.currentNode)[0])&&
a.add(d,"hidden")):(e=this.addLayerNode(d,l,v),f.forEach(d.newSubLayers,c.hitch(this,function(d,l){this.drawListNode(l,d+1,e.subNode)},l))))},addLayerNode:function(d,l,a){var b=g.create("tr",{"class":"jimu-widget-row layer-row ",layerTrNodeId:d.id},a),m,k,f,t,h;m=g.create("td",{"class":"col col1"},b);for(f=0;f<l;f++)g.create("div",{"class":"begin-blank-div jimu-float-leading",innerHTML:""},m);h=g.create("div",{"class":"showLegend-div jimu-float-leading",imageShowLegendDivId:d.id},m);k=g.create("div",
{"class":"div-select jimu-float-leading"},m);f=new p({checked:d.isVisible(),"class":"visible-checkbox-"+d.id});g.place(f.domNode,k);t=g.create("div",{"class":"noLegend-div jimu-float-leading"},m);g.create("img",{"class":"noLegend-image",src:this.layerListWidget.folderUrl+(d.isTable?"images/table.png":"images/noLegend.png"),alt:"l"},t);if(d.noLegend||d.isTable)e.set(h,"display","none"),e.set(k,"display","none"),e.set(t,"display","block");e.set(m,"width",12*l+40+"px");l=g.create("td",{"class":"col col2"},
b);m="";try{d.isInScale()||(m="grayed-title")}catch(r){console.warn(r.message)}g.create("div",{innerHTML:d.title,"class":"layer-title-div-"+d.id+" div-content jimu-float-leading "+m},l);m=g.create("td",{"class":"col col3"},b);m=g.create("div",{"class":"layers-list-popupMenu-div"},m);k=(new u({_layerInfo:d,box:this.layerListWidget.domNode.parentNode,popupMenuNode:m,layerListWidget:this.layerListWidget,_config:this.config})).placeAt(m);this.own(n(k,"onMenuClick",c.hitch(this,this._onPopupMenuItemClick,
d,k)));a=g.create("tr",{"class":"",layerContentTrNodeId:d.id},a);a=g.create("td",{"class":"",colspan:"3"},a);a=g.create("table",{"class":"layer-sub-node",subNodeId:d.id},a);this.own(n(l,"click",c.hitch(this,this._onRowTrClick,d,h,b,a)));this.own(n(h,"click",c.hitch(this,this._onRowTrClick,d,h,b,a)));this.own(n(b,"mouseover",c.hitch(this,this._onLayerNodeMouseover,b,k)));this.own(n(b,"mouseout",c.hitch(this,this._onLayerNodeMouseout,b,k)));this.own(n(f.domNode,"click",c.hitch(this,this._onCkSelectNodeClick,
d,f)));this.own(n(m,"click",c.hitch(this,this._onPopupMenuClick,d,k,b)));return{currentNode:b,subNode:a}},addLegendNode:function(d,l,a){a=g.create("tr",{"class":"legend-node-tr"},a);a=g.create("td",{"class":"legend-node-td"},a);try{var b=d.createLegendsNode();e.set(b,"font-size",12*(l+1)+"px");g.place(b,a)}catch(c){console.error(c)}},_foldSwitch:function(d,l,a){return"none"===e.get(a,"display")?this._foldOrUnfoldLayer(d,!1,l,a):this._foldOrUnfoldLayer(d,!0,l,a)},_foldOrUnfoldLayer:function(d,l,b,
c){var m=m?b:h("div[imageShowLegendDivId\x3d'"+d.id+"']",this.layerListTable)[0],k=k?c:h("table[subNodeId\x3d'"+d.id+"']",this.layerListTable)[0];b=null;m&&k&&(l?(e.set(k,"display","none"),a.remove(m,"unfold"),b=!0):(e.set(k,"display","table"),a.add(m,"unfold"),b=!1,d.isLeaf()&&(l=h(".legends-div",k)[0],m=h(".legends-loading-img",l)[0],l&&m&&d.drawLegends(l,this.layerListWidget.appConfig.portalUrl))));return b},redrawLegends:function(d){var a=h("div[legendsDivId\x3d'"+d.id+"']",this.layerListTable)[0];
a&&(a._legendDijit&&a._legendDijit.destroy&&a._legendDijit.destroy(),d.drawLegends(a,this.layerListWidget.appConfig.portalUrl))},_foldOrUnfoldLayers:function(d,a){f.forEach(d,function(d){this._foldOrUnfoldLayer(d,a)},this)},_onCkSelectNodeClick:function(d,a,b){b.ctrlKey||b.metaKey?d.isRootLayer()?this.turnAllRootLayers(a.checked):this.turnAllSameLevelLayers(d,a.checked):d.setTopLayerVisible(a.checked);b.stopPropagation()},_onPopupMenuClick:function(d,a,b,e){this._changeSelectedLayerRow(b);a&&"opened"===
a.state?a.closeDropMenu():(this._hideCurrentPopupMenu(),a&&(this.currentPopupMenu=a,a.openDropMenu()));this.operationsDropMenu&&"opened"===this.operationsDropMenu.state&&this.operationsDropMenu.closeDropMenu();e.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&"opened"===this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerNodeMouseover:function(d){a.add(d,"layer-row-mouseover")},_onLayerNodeMouseout:function(d){a.remove(d,"layer-row-mouseover")},_onLayerListWidgetPaneClick:function(){this.operationsDropMenu&&
this.operationsDropMenu.closeDropMenu()},_onRowTrClick:function(d,a,b,e,c){this._changeSelectedLayerRow(b);a=this._foldSwitch(d,a,e);if(c.ctrlKey||c.metaKey)d.isRootLayer()?this.foldOrUnfoldAllRootLayers(a):this.foldOrUnfoldSameLevelLayers(d,a)},_changeSelectedLayerRow:function(d){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===d||(this._currentSelectedLayerRowNode&&a.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),a.add(d,"jimu-widget-row-selected"),this._currentSelectedLayerRowNode=
d)},_onPopupMenuItemClick:function(d,a,b,c){c={itemKey:b.key,extraData:c,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===b.key?"none"===e.get(a.transparencyDiv,"display")?a.showTransNode(d.getOpacity()):a.hideTransNode():(d=a.popupMenuInfo.onPopupMenuClick(c),d.closeMenu&&a.closeDropMenu())},_exchangeLayerTrNode:function(d,a){var b=h("tr[layerTrNodeId\x3d'"+d.id+"']",this.layerListTable)[0],e=h("tr[layerTrNodeId\x3d'"+a.id+"']",this.layerListTable)[0],c=h("tr[layerContentTrNodeId\x3d'"+
a.id+"']",this.layerListTable)[0];b&&(e&&c)&&(this.layerListTable.removeChild(e),this.layerListTable.insertBefore(e,b),this.layerListTable.removeChild(c),this.layerListTable.insertBefore(c,b))},_getMovedSteps:function(d,a){var b=1,e,c=this.operLayerInfos.getLayerInfoArray();f.forEach(c,function(a,b){d.id===a.id&&(e=b)},this);if("moveup"===a)for(;!c[e].isFirst;)if(e--,this.isLayerHiddenInWidget(c[e])&&!c[e].isFirst)b++;else break;else for(;!c[e].isLast;)if(e++,this.isLayerHiddenInWidget(c[e])&&!c[e].isLast)b++;
else break;return b},_initOperations:function(){this.operationsDropMenu=(new t({items:[{key:"turnAllLayersOn",label:this.nls.turnAllLayersOn},{key:"turnAllLayersOff",label:this.nls.turnAllLayersOff},{key:"separator"},{key:"expandAllLayers",label:this.nls.expandAllLayers},{key:"collapseAlllayers",label:this.nls.collapseAlllayers}],box:this.layerListWidget.domNode.parentNode})).placeAt(this.layerListOperations);var d=h("div.jimu-dropmenu \x3e div:first-child",this.layerListOperations)[0];d&&(a.remove(d,
["jimu-icon-btn","popup-menu-button"]),a.add(d,["feature-action","icon-operation"]));this.operationsDropMenu.btnNode&&this.own(n(this.operationsDropMenu.btnNode,"click",c.hitch(this,this._onLayerListOperationsClick)));this.own(n(this.operationsDropMenu,"onMenuClick",c.hitch(this,this._onOperationsMenuItemClick)))},_onLayerListOperationsClick:function(){this._hideCurrentPopupMenu()},_onOperationsMenuItemClick:function(d){switch(d.key){case "turnAllLayersOn":this.turnAllRootLayers(!0);break;case "turnAllLayersOff":this.turnAllRootLayers(!1);
break;case "expandAllLayers":this.foldOrUnfoldAllRootLayers(!1);break;case "collapseAlllayers":this.foldOrUnfoldAllRootLayers(!0)}},isFirstDisplayedLayerInfo:function(d){var a,b;d.isFirst||!d.isRootLayer()?a=!0:(a=this._getMovedSteps(d,"moveup"),b=this.operLayerInfos.getLayerInfoArray(),d=this.operLayerInfos._getTopLayerInfoIndexById(d.id),a=this.isLayerHiddenInWidget(b[d-a])?!0:!1);return a},isLastDisplayedLayerInfo:function(d){var a,b;d.isLast||!d.isRootLayer()?a=!0:(a=this._getMovedSteps(d,"movedown"),
b=this.operLayerInfos.getLayerInfoArray(),d=this.operLayerInfos._getTopLayerInfoIndexById(d.id),a=this.isLayerHiddenInWidget(b[d+a])?!0:!1);return a},moveUpLayer:function(d){var a=this._getMovedSteps(d,"moveup");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(a=this.operLayerInfos.moveUpLayer(d,a))&&this._exchangeLayerTrNode(a,d)},moveDownLayer:function(d){var a=this._getMovedSteps(d,"movedown");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(a=this.operLayerInfos.moveDownLayer(d,
a))&&this._exchangeLayerTrNode(d,a)},isLayerHiddenInWidget:function(d){var a=!1,b=d;if(d&&this.config.layerOptions&&void 0!==this.config.layerOptions[d.id])for(;b&&!(a=a||!this.config.layerOptions[b.id].display);)b=b.parentLayerInfo;else a=!1;return a},turnAllRootLayers:function(a){var b=this.operLayerInfos.getLayerInfoArray();f.forEach(b,function(b){this.isLayerHiddenInWidget(b)||b.setTopLayerVisible(a)},this)},turnAllSameLevelLayers:function(a,b){var e={},k=a.getRootLayerInfo();k.traversal(c.hitch(this,
function(c){c.parentLayerInfo&&c.parentLayerInfo.id===a.parentLayerInfo.id&&!this.isLayerHiddenInWidget(c)?e[c.id]={visible:b}:e[c.id]={visible:c.isVisible()}}));k.resetLayerObjectVisibility(e)},foldOrUnfoldAllRootLayers:function(a){var b=f.filter(this.operLayerInfos.getLayerInfoArray(),function(a){return!this.isLayerHiddenInWidget(a)},this);this._foldOrUnfoldLayers(b,a)},foldOrUnfoldSameLevelLayers:function(a,b){var e;a.parentLayerInfo&&(e=f.filter(a.parentLayerInfo.getSubLayers(),function(a){return!this.isLayerHiddenInWidget(a)},
this),this._foldOrUnfoldLayers(e,b))}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented ../utils".split(" "),function(s,q,c,f,g,n,h,p){return s([q,h],{baseClass:"jimu-dropmenu",declaredClass:"jimu.dijit.DropMenu",constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=g.create("div",{"class":"popup-menu-button"},this.domNode);this.own(n(this.btnNode,"click",c.hitch(this,this._onBtnClick)));
this.box||(this.box=this.domNode.parentNode);this.own(n(this.box,"click",c.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(c){c.stopPropagation();this.dropMenuNode||this._createDropMenuNode();"closed"===this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=g.create("div",{"class":"drop-menu",style:{display:"none"}},this.domNode);this.items||(this.items=[]);f.forEach(this.items,function(f){var h;f.key&&"separator"===
f.key?g.create("hr",{"class":"menu-item-identification menu-item-line",itemId:f.key},this.dropMenuNode):f.key&&(h=g.create("div",{"class":"menu-item-identification menu-item",itemId:f.key,innerHTML:f.label},this.dropMenuNode),this.own(n(h,"click",c.hitch(this,function(c){this.selectItem(f,c)}))))},this)},_getDropMenuPosition:function(){var c=g.getContentBox(this.box),f=g.getMarginBox(this.domNode),h=g.getMarginBox(this.btnNode),b=g.getMarginBox(this.dropMenuNode),a={},e,k;a.l=f.l;a.t=f.t+h.h;a.t+
b.h>c.h&&(k=f.t,e=c.h-f.t-h.h,e=Math.max(k,e),e===k&&(a.t=0-b.h));a.l+b.w>c.w&&(b=f.l,c=c.w-f.l-h.w,e=Math.max(b,c),e===b&&(a.l="",a.r=0));a.left=a.l;a.top=a.t;a.right=a.r;return a},selectItem:function(c){this.closeDropMenu();this.emit("onMenuClick",c)},openDropMenu:function(){this.state="opened";g.setStyle(this.dropMenuNode,"display","");g.setStyle(this.dropMenuNode,p.getPositionStyle(this._getDropMenuPosition()));this.emit("onOpenMenu")},closeDropMenu:function(){this.state="closed";g.setStyle(this.dropMenuNode,
"display","none");this.emit("onCloseMenu")}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/Deferred jimu/dijit/DropMenu jimu/dijit/LoadingIndicator dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style ./NlsStrings ./PopupMenuInfo".split(" "),function(s,q,c,f,g,n,h,p,t,u,r,b,a,e,k){return s([h,t],{templateString:b,popupMenuInfo:null,loading:null,
_deniedItems:null,_deniedItemsFromConfig:null,_layerInfo:null,constructor:function(){this.nls=e.value},postCreate:function(){this.inherited(arguments);this._initDeniedItems();this.loading=new p({hidden:!0});this.loading.placeAt(this.popupMenuNode);this.hasContentMenu()||this.hide()},_initDeniedItems:function(){var a=[],b={ZoomTo:"zoomto",Transparency:"transparency",EnableOrDisablePopup:"controlPopup",MoveupOrMovedown:"moveup movedown",OpenAttributeTable:"table",DescriptionOrShowItemDetailsOrDownload:"url"};
this._deniedItems=[];this._deniedItemsFromConfig=[];for(var c in this._config.contextMenu)this._config.contextMenu.hasOwnProperty(c)&&("function"!==typeof this._config.contextMenu[c]&&!1===this._config.contextMenu[c])&&(a=a.concat(b[c].split(" ")));q.forEach(a,f.hitch(this,function(a){this._deniedItemsFromConfig.push({key:a,denyType:"hidden"})}))},_getDropMenuPosition:function(){return{top:"40px",right:"0px",zIndex:1}},_getTransNodePosition:function(){return{top:"28px",right:"2px"}},_onBtnClick:function(){},
_refresh:function(){this._denyItems();this._changeItemsUI()},_denyItems:function(){var a=g("[class~\x3d'menu-item-identification']",this.dropMenuNode);a.forEach(function(a){c.removeClass(a,"menu-item-dissable");c.removeClass(a,"menu-item-hidden")},this);c.removeClass(this.dropMenuNode,"no-border");q.forEach(this._deniedItems,function(a){var d=g("div[itemId\x3d'"+a.key+"']",this.dropMenuNode)[0];d&&("disable"===a.denyType?(c.addClass(d,"menu-item-dissable"),"url"===a.key&&g(".menu-item-description",
d).forEach(function(a){c.setAttr(a,"href","#");c.removeAttr(a,"target")})):c.addClass(d,"menu-item-hidden"))},this);for(var b=-1,e=0;e<a.length;e++)c.hasClass(a[e],"menu-item-line")&&(-1===b||c.hasClass(a[b],"menu-item-line"))&&c.addClass(a[e],"menu-item-hidden"),c.hasClass(a[e],"menu-item-hidden")||(b=e);a=q.filter(a,function(a){return!c.hasClass(a,"menu-item-hidden")});0===a.length?c.addClass(this.dropMenuNode,"no-border"):(c.removeClass(this.dropMenuNode,"no-border"),c.hasClass(a[a.length-1],"menu-item-line")&&
c.addClass(a[a.length-1],"menu-item-hidden"))},_changeItemsUI:function(){var a=g("[itemid\x3dcontrolPopup]",this.dropMenuNode)[0];a&&this._layerInfo.controlPopupInfo&&(this._layerInfo.controlPopupInfo.enablePopup?c.setAttr(a,"innerHTML",this.nls.removePopup):c.setAttr(a,"innerHTML",this.nls.enablePopup))},selectItem:function(a,b){for(var e=!1,c=0;c<this._deniedItems.length;c++)if(this._deniedItems[c].key===a.key){e=!0;break}e||this.emit("onMenuClick",a);b.stopPropagation(b)},openDropMenu:function(){var a=
f.hitch(this,this.inherited,arguments),b=new n;this.loading.show();this.dropMenuNode?b.resolve(this.popupMenuInfo):k.create(this._layerInfo,this.layerListWidget).then(f.hitch(this,function(a){this.items=a.getDisplayItems();this.popupMenuInfo=a;this._createDropMenuNode();b.resolve(this.popupMenuInfo)}));b.then(f.hitch(this,function(){this.popupMenuInfo.getDeniedItems().then(f.hitch(this,function(b){this._deniedItems=this._deniedItemsFromConfig.concat(b);this._refresh();a(arguments);this.loading.hide()}),
f.hitch(this,function(){this.loading.hide()}))}),f.hitch(this,function(){this.loading.hide()}))},closeDropMenu:function(){this.inherited(arguments);this.hideTransNode()},_onTransparencyDivClick:function(a){a.stopPropagation()},showTransNode:function(d){this.transHorizSlider||(this._createTransparencyWidget(),this.transHorizSlider.set("value",1-d));a.set(this.transparencyDiv,"top",this._getTransNodePosition().top);isRTL?a.set(this.transparencyDiv,"left",this._getTransNodePosition().right):a.set(this.transparencyDiv,
"right",this._getTransNodePosition().right);a.set(this.transparencyDiv,"display","block")},hideTransNode:function(){a.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(){this.transHorizSlider=new u({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",f.hitch(this,function(a){this.emit("onMenuClick",{key:"transparencyChanged"},{newTransValue:a})})));new r({container:"bottomDecoration"},this.transparencyRule)},hide:function(){a.set(this.domNode,
"display","none")},show:function(){a.set(this.domNode,"display","block")},hasContentMenu:function(){var a=!1,b;if(this._config.contextMenu)for(b in this._config.contextMenu)this._config.contextMenu.hasOwnProperty(b)&&"function"!==typeof this._config.contextMenu[b]&&(a=a||this._config.contextMenu[b]);else a=!0;return a}})})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"widgets/LayerList/PopupMenuInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all jimu/portalUrlUtils jimu/WidgetManager esri/lang esri/graphicsUtils ./NlsStrings".split(" "),
function(s,q,c,f,g,n,h,p,t,u){var r=s([],{_candidateMenuItems:null,_displayItems:null,_layerInfo:null,_layerType:null,_appConfig:null,constructor:function(b,a,e,c){this.nls=u.value;this._layerInfo=b;this._layerType=e;this.layerListWidget=c;this._initCandidateMenuItems();this._initDisplayItems(a)},_getATagLabel:function(){var b,a;b=this._layerInfo.isItemLayer&&this._layerInfo.isItemLayer();a=this._layerInfo.getUrl();b?(b=n.getItemDetailsPageUrl(n.getStandardPortalUrl(this.layerListWidget.appConfig.portalUrl),
b),a=this.nls.itemShowItemDetails):a&&("CSVLayer"===this._layerType||"KMLLayer"===this._layerType)?(b=a,a=this.nls.itemDownload):(b=a&&"WMSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":"?")+"SERVICE\x3dWMS\x26REQUEST\x3dGetCapabilities":a&&"WFSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":"?")+"SERVICE\x3dWFS\x26REQUEST\x3dGetCapabilities":a?a:"",a=this.nls.itemDesc);return'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d"'+b+'"\x3e'+a+"\x3c/a\x3e"},_initCandidateMenuItems:function(){this._candidateMenuItems=
[{key:"separator",label:""},{key:"empty",label:this.nls.empty},{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",label:this.nls.itemTransparency},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:"table",label:this.nls.itemToAttributeTable},{key:"controlPopup",label:this.nls.removePopup},{key:"url",label:this._getATagLabel()}]},_initDisplayItems:function(b){this._displayItems=[];q.forEach(b,function(a){q.forEach(this._candidateMenuItems,function(b){a.key===
b.key&&(this._displayItems.push(c.clone(b)),a.onClick&&(this._displayItem.onClick=a.onClick))},this)},this)},_isSupportedByAT:function(){return!0},_isSupportedByAT_bk:function(b,a){var c;c=b.config;c=0===c.layerInfos.length?!0:q.some(c.layerInfos,function(a){if(a.id===this._layerInfo.id&&a.show)return!0},this);return!a.isSupportedLayer||!a.isSupportQuery||a.otherReasonCanNotSupport||!c?!1:!0},getDeniedItems:function(){var b=new f,a=[];this.layerListWidget.layerListView.isFirstDisplayedLayerInfo(this._layerInfo)&&
a.push({key:"moveup",denyType:"disable"});this.layerListWidget.layerListView.isLastDisplayedLayerInfo(this._layerInfo)&&a.push({key:"movedown",denyType:"disable"});this._layerInfo.getUrl()||a.push({key:"url",denyType:"disable"});var e=this._layerInfo.loadInfoTemplate(),k=this._layerInfo.getSupportTableInfo();g({infoTemplate:e,supportTableInfo:k}).then(c.hitch(this,function(d){d.infoTemplate||a.push({key:"controlPopup",denyType:"disable"});d=d.supportTableInfo;var c=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];
!c||!c.visible?a.push({key:"table",denyType:"hidden"}):this._isSupportedByAT(c,d)||(this._layerInfo.parentLayerInfo&&this._layerInfo.parentLayerInfo.isMapNotesLayerInfo()?a.push({key:"table",denyType:"hidden"}):a.push({key:"table",denyType:"disable"}));b.resolve(a)}),function(){b.resolve(a)});return b},getDisplayItems:function(){return this._displayItems},onPopupMenuClick:function(b){var a={closeMenu:!0};switch(b.itemKey){case "zoomto":this._onItemZoomToClick(b);break;case "moveup":this._onMoveUpItemClick(b);
break;case "movedown":this._onMoveDownItemClick(b);break;case "table":this._onTableItemClick(b);break;case "transparencyChanged":this._onTransparencyChanged(b);a.closeMenu=!1;break;case "controlPopup":this._onControlPopup()}return a},_onItemZoomToClick:function(b){this._layerInfo.getExtent().then(c.hitch(this,function(a){var b=null;a=a&&0<a.length&&a[0];this._isValidExtent(a)&&(b=a);b?this._layerInfo.map.setExtent(b):0<=this._layerInfo.map.graphicsLayerIds.indexOf(this._layerInfo.id)&&this._layerInfo.getLayerObject().then(c.hitch(this,
function(a){if(a.graphics&&0<a.graphics.length){try{b=t.graphicsExtent(a.graphics)}catch(d){console.error(d)}b&&this._layerInfo.map.setExtent(b)}}))}))},_isValidExtent:function(b){var a=!1;p.isDefined(b)&&p.isDefined(b.xmin)&&(isFinite(b.xmin)&&p.isDefined(b.ymin)&&isFinite(b.ymin)&&p.isDefined(b.xmax)&&isFinite(b.xmax)&&p.isDefined(b.ymax)&&isFinite(b.ymax))&&(a=!0);return a},_onMoveUpItemClick:function(b){this._layerInfo.isFirst||b.layerListView.moveUpLayer(this._layerInfo)},_onMoveDownItemClick:function(b){this._layerInfo.isLast||
b.layerListView.moveDownLayer(this._layerInfo)},_onTableItemClick:function(b){this._layerInfo.getSupportTableInfo().then(c.hitch(this,function(a){var e=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];this._isSupportedByAT(e,a)&&(a=h.getInstance(),a.triggerWidgetOpen(e.id).then(c.hitch(this,function(){b.layerListWidget.publishData({target:"AttributeTable",layer:this._layerInfo})})))}))},_onTransparencyChanged:function(b){this._layerInfo.setOpacity(1-b.extraData.newTransValue)},
_onControlPopup:function(b){this._layerInfo.controlPopupInfo.enablePopup?this._layerInfo.disablePopup():this._layerInfo.enablePopup();this._layerInfo.map.infoWindow.hide()}});r.create=function(b,a){var e=new f,k=b.isRootLayer(),d={RootLayer:[{key:"zoomto"},{key:"transparency"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"url"}],RootLayerAndFeatureLayer:[{key:"zoomto"},{key:"transparency"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"moveup"},{key:"movedown"},
{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],FeatureLayer:[{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],GroupLayer:[{key:"url"}],Table:[{key:"table"},{key:"separator"},{key:"url"}],"default":[{key:"url",onClick:null}]};b.getLayerType().then(c.hitch(this,function(c){var f="",f=k&&("FeatureLayer"===c||"CSVLayer"===c||"ArcGISImageServiceLayer"===c||"StreamLayer"===c||"ArcGISImageServiceVectorLayer"===c)?"RootLayerAndFeatureLayer":k?"RootLayer":
"FeatureLayer"===c||"CSVLayer"===c?"FeatureLayer":"GroupLayer"===c?"GroupLayer":"Table"===c?"Table":"default";e.resolve(new r(b,d[f],c,a))}),c.hitch(this,function(){e.resolve(new r(b,[{key:"empty"}]))}));return e};return r})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\r\n    \x3cdiv class\x3d"label"\x3e\r\n      \x3cdiv class\x3d"label-left jimu-float-leading"\x3e${nls.itemOpaque}\x3c/div\x3e\r\n      \x3cdiv class\x3d"label-right jimu-float-trailing"\x3e${nls.itemTransparent}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \r\n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3cdiv\x3e\r\n',
"url:widgets/LayerList/LayerListView.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layer-list-operations" data-dojo-attach-point\x3d"layerListOperations"\x3e\r\n    \x3c!--div class\x3d"setting-image jimu-icon jimu-icon-setting jimu-state-disabled"\x3e\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3ctable class\x3d"layer-list-table"\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"tableListTable"\x3e\x3c/tbody\x3e       \r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\r\n    \x3cdiv class\x3d"layer-list-title"\x3e${nls.titleLayers}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/LayerList/css/style.css":'.jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px; z-index: 0; position: relative;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; color: #000000; margin-bottom: 14px; font-family: "Avenir Heavy"; margin-left: 8px; margin-right: 8px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{background-color: #ffffff; height: 40px;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word; cursor: pointer;}.jimu-widget-layerList .col3{width: 24px;}.jimu-widget-layerList .begin-blank-div{width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 13px; height: 13px; cursor: pointer; margin-left: 3px; margin-top: 3px; background-image: url("../images/v_right.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .layer-selector .showLegend-div{background-image: url("../images/v_left.png"); margin-left: 0; margin-right: 3px;} .jimu-widget-layerList .showLegend-div.unfold{background-image: url("../images/v.png");}.jimu-widget-layerList .showLegend-div.hidden{background-image: none; cursor: auto;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{width: 33px; text-align: right; display: none;}.jimu-widget-layerList .noLegend-image{display: block; margin: 0 auto;}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{position: relative; font-size: 2px;}.jimu-widget-layerList .div-select .checkbox{cursor: auto;}.jimu-widget-layerList .div-content{position: relative; color: #000000; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .div-content.grayed-title{opacity: 0.3;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden; font-size: 11px;}.jimu-widget-layerList .legend-symbol{}.jimu-widget-layerList .legend-label{margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .esriLegendService {padding-bottom: 0;}.jimu-widget-layerList .esriLegendLayerLabel {padding-top: 0; height: 0; display: none;}.jimu-widget-layerList .esriLegendServiceLabel {display: none;}.jimu-widget-layerList .esriLegendLayer{font-size: 12px;}.jimu-widget-layerList .esriLegendMsg{display: none;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 22px; height: 40px; cursor: pointer; border-radius: 2px; float: right; padding-top: 14px;}.jimu-widget-layerList .layers-list-popupMenu-div .loading-section {width: 17px; height: 17px; top: 14px; left: 2px; z-index: 1; margin: 0;} .jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .loading-section {left: auto; right: 2px;}.jimu-widget-layerList .layers-list-popupMenu-div .jimu-loading{width: 17px; height: 17px; margin: 0; border-radius: 25px;}.jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .jimu-loading{}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 220px; height:50px; padding-left: 2%; padding-right: 2%; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .jimu-dropmenu .popup-menu-button{width: 22px; height: 22px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 22px; height: 22px; min-width: 13px; background-image: url("../images/more_normal.svg"); background-color: rgba(255, 255, 255, 0); border: 0 solid;}.jimu-widget-layerList .layers-list-popupMenu-div:hover .jimu-icon-btn{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{min-width: 180px; max-width: 250px; outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; color: #000000; font-size: 12px; z-index: 2; right: 0px; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .jimu-dropmenu .drop-menu.no-border{outline-style: none; border: none; box-shadow: none;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .drop-menu{left: 0px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{position: relative; height: 40px; line-height: 40px; white-space: nowrap; padding: 0px 24px; margin: 0 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-layerList .jimu-dropmenu .menu-item:hover{color: #000000; text-decoration: initial; background-color: #f3f3f3; font-family: "Avenir Medium";}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{opacity: 0.4;}.jimu-widget-layerList .jimu-dropmenu .menu-item-hidden{display: none;}.jimu-widget-layerList .jimu-dropmenu .menu-item a{position: absolute; padding: 0 24px; width: 100%; left: 0;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .menu-item a{right: auto; left: 0;}.jimu-widget-layerList .legends-loading-img{width: 45px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}.jimu-widget-layerList .layer-list-operations{position: absolute; right: 0; top: 0;}.jimu-rtl .jimu-widget-layerList .layer-list-operations{right: auto; left: 0;}.jimu-widget-layerList .layer-list-operations .setting-image{position: relative; right: 11px; top: -1px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .setting-image{right: auto; left: 11px;}.jimu-widget-layerList .layer-list-operations .jimu-icon-btn{background-image: url("../images/operation_normal.svg"); background-color: rgba(255, 255, 255, 0);}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-icon-btn{left: auto; right: -8px;}.jimu-widget-layerList .layer-list-operations:hover .jimu-icon-btn{background-image: url("../images/operation_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .layer-list-operations .drop-menu{min-width:147px !important; top: 21px !important; right: 0 !important; left: auto !important; z-index: 1 !important; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none !important;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .drop-menu{right: auto !important; left: 0 !important;}.jimu-widget-layerList .layer-list-operations .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item{margin: 0; padding: 0 7px; font-size: 12px; padding: 0 20px;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}',
"*now":function(s){s(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom dojo/on dojo/query dijit/registry ./LayerListView ./NlsStrings jimu/LayerInfos/LayerInfos".split(" "),function(s,q,c,f,g,n,h,p,t,u,r,b){return q([s],{baseClass:"jimu-widget-layerList",name:"layerList",_denyLayerInfosReorderResponseOneTime:null,layerListView:null,operLayerInfos:null,startup:function(){this.inherited(arguments);r.value=this.nls;this._denyLayerInfosReorderResponseOneTime=!1;if(this.map.itemId)b.getInstance(this.map,
this.map.itemInfo).then(c.hitch(this,function(a){this.operLayerInfos=a;this.showLayers();this.bindEvents();n.setSelectable(this.layersSection,!1)}));else{var a=this._obtainMapLayers();b.getInstance(this.map,a).then(c.hitch(this,function(a){this.operLayerInfos=a;this.showLayers();this.bindEvents();n.setSelectable(this.layersSection,!1)}))}},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var a=[],b=[],c={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};
f.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);a.isOperationalLayer&&b.push({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "})},this);f.forEach(this.map.layerIds,function(d){d=this.map.getLayer(d);d.isOperationalLayer?b.push({layerObject:d,title:d.label||d.title||d.name||d.id||" ",id:d.id||" "}):a.push({layerObject:d,id:d.id||" "})},this);c.itemData.baseMap.baseMapLayers=a;c.itemData.operationalLayers=b;return c},showLayers:function(){this.layerListView=
(new u({operLayerInfos:this.operLayerInfos,layerListWidget:this,config:this.config})).placeAt(this.layerListBody)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},_refresh:function(){this._clearLayers();this.showLayers()},bindEvents:function(){this.own(h(this.operLayerInfos,"layerInfosChanged",c.hitch(this,this._onLayerInfosChanged)));this.own(h(this.operLayerInfos,"tableInfosChanged",c.hitch(this,this._onLayerInfosChanged)));
this.own(this.operLayerInfos.on("layerInfosIsVisibleChanged",c.hitch(this,this._onLayerInfosIsVisibleChanged)));this.own(h(this.operLayerInfos,"updated",c.hitch(this,this._onLayerInfosObjUpdated)));this.own(h(this.operLayerInfos,"layerInfosReorder",c.hitch(this,this._onLayerInfosReorder)));this.own(h(this.map,"zoom-end",c.hitch(this,this._onZoomEnd)));this.own(h(this.operLayerInfos,"layerInfosRendererChanged",c.hitch(this,this._onLayerInfosRendererChanged)));this.own(h(this.operLayerInfos,"layerInfosOpacityChanged",
c.hitch(this,this._onLayerInfosOpacityChanged)))},_onLayerInfosChanged:function(){this._refresh()},_onLayerInfosIsVisibleChanged:function(a){f.forEach(a,function(a){p("[class~\x3d'visible-checkbox-"+a.id+"']",this.domNode).forEach(function(b){b=t.byNode(b);a.isVisible()?b.check():b.uncheck()},this)},this)},_onLayerInfosObjUpdated:function(){this._refresh()},_onZoomEnd:function(){this.operLayerInfos.traversal(c.hitch(this,function(a){p("[class~\x3d'layer-title-div-"+a.id+"']",this.domNode).forEach(function(b){try{a.isInScale()?
g.removeClass(b,"grayed-title"):g.addClass(b,"grayed-title")}catch(c){console.warn(c.message)}},this)}))},_onLayerInfosReorder:function(){this._denyLayerInfosReorderResponseOneTime?this._denyLayerInfosReorderResponseOneTime=!1:this._refresh()},_onLayerInfosRendererChanged:function(a){try{f.forEach(a,function(a){this.layerListView.redrawLegends(a)},this)}catch(b){this._refresh()}},_onLayerInfosOpacityChanged:function(a){f.forEach(a,function(a){var b=void 0===a.layerObject.opacity?1:a.layerObject.opacity;
a=p("[layercontenttrnodeid\x3d'"+a.id+"']",this.domNode)[0];p(".legends-div.jimu-legends-div-flag img",a).style("opacity",b)},this)},onAppConfigChanged:function(a,b,c){this.appConfig=a}})});