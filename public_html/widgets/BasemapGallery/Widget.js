// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/Basemap":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../request ./BasemapLayer".split(" "),function(g,k,e,q,f,m,s){return g(null,{declaredClass:"esri.dijit.Basemap",id:null,title:"",thumbnailUrl:null,layers:null,itemId:null,basemapGallery:null,constructor:function(f,e){f=f||{};!f.layers&&!f.itemId&&console.error("esri.dijit.Basemap: unable to find the 'layers' property in parameters");this.id=f.id;this.itemId=f.itemId;this.layers=
f.layers;this.title=f.title||"";this.thumbnailUrl=f.thumbnailUrl;this.basemapGallery=e},getLayers:function(g){if(this.layers)return this.layers;if(this.itemId)return g=m({url:(g||f.dijit._arcgisUrl)+"/content/items/"+this.itemId+"/data",content:{f:"json"},callbackParamName:"callback",error:e.hitch(this,function(f,e){if(this.basemapGallery)this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item.");else console.error("esri.dijit.Basemap: could not access basemap item.")})}),g.addCallback(e.hitch(this,
function(f,e){if(f.baseMap)return this.layers=[],k.forEach(f.baseMap.baseMapLayers,function(f){this.layers.push(new s(f))},this),this.layers;if(this.basemapGallery)this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item.");else console.error("esri.dijit.Basemap: could not access basemap item.");return[]})),g}})})},"esri/dijit/BasemapLayer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(g,k,e,q){return g(null,{declaredClass:"esri.dijit.BasemapLayer",
constructor:function(f){f=f||{};!f.url&&!f.type&&console.error("esri.dijit.BasemapLayer: unable to find the 'url' or 'type' property in parameters");this.url=f.url;this.type=f.type;this.isReference=!0===f.isReference?!0:!1;this.opacity=f.opacity;this.visibleLayers=f.visibleLayers;this.displayLevels=f.displayLevels;this.exclusionAreas=f.exclusionAreas;this.bandIds=f.bandIds;this.templateUrl=f.templateUrl;this.copyright=f.copyright;this.subDomains=f.subDomains;this.fullExtent=f.fullExtent;this.initialExtent=
f.initialExtent;this.tileInfo=f.tileInfo;this.tileServers=f.tileServers;this.styleUrl=f.styleUrl}})})},"esri/dijit/BasemapGallery":function(){define("require dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/_base/kernel dojo/_base/sniff dojo/has dojo/query dojo/Deferred dojo/DeferredList dojo/dom dojo/dom-construct dojo/dom-class dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ../request ../geometry/Extent ../SpatialReference ../virtualearth/VETiledLayer ../layers/OpenStreetMapLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/WebTiledLayer ../layers/VectorTileLayer ../layers/TileInfo ../layers/ArcGISImageServiceLayer ../layers/ImageServiceParameters ../layers/ImageParameters ./Basemap ./_EventedWidget dojo/text!./templates/BasemapGallery.html".split(" "),
function(g,k,e,q,f,m,s,u,y,p,r,v,n,w,t,b,c,d,l,h,A,z,B,I,C,D,J,E,K,F,G,H,L,M,N){return k([M,t,b],{declaredClass:"esri.dijit.BasemapGallery",widgetsInTemplate:!0,templateString:N,loaded:!1,basemaps:[],bingMapsKey:null,flowContainer:null,_hasUI:!1,_supportsVTL:null,_selectedBasemap:null,_selectBasemapInProgress:!1,_eventMap:{load:!0,"selection-change":!0,add:["basemap"],remove:["basemap"],error:["message"]},constructor:function(a,O){a=a||{};a.map||console.error("esri.dijit.BasemapGallery: Unable to find the 'map' property in parameters");
this.map=a.map;this._hasUI=O?!0:!1;this.bingMapsKey=a.bingMapsKey&&0<a.bingMapsKey.length?a.bingMapsKey:null;this.showArcGISBasemaps=!1!==a.showArcGISBasemaps;this.basemaps=a.basemaps||[];this.basemapIds=a.basemapIds;this.referenceIds=a.referenceIds;this.basemapsGroup=a.basemapsGroup;this.arcgisUrl=c.dijit._arcgisUrl;a.portalUrl&&(this.arcgisUrl=a.portalUrl+"/sharing/rest");0>this.arcgisUrl.indexOf("://")?this.arcgisUrl=l.getProtocolForWebResource()+"//"+this.arcgisUrl:"https:"===window.location.protocol&&
(this.arcgisUrl=this.arcgisUrl.replace("http:","https:"));this.init()},init:function(){this.inherited(arguments);e.forEach(this.basemaps,function(a){if(!a.id||0===a.id.length)a.id=this._getUniqueId();e.forEach(a.layers,function(a){a.opacity=0<=a.opacity?a.opacity:1;a.visibility=!0},this)},this);this.basemapIds&&0<this.basemapIds.length&&e.forEach(this.basemapIds,function(a){this.map.getLayer(a)._basemapGalleryLayerType="basemap"},this);this.referenceIds&&0<this.referenceIds.length&&e.forEach(this.referenceIds,
function(a){a=this.map.getLayer(a);a._basemapGalleryLayerType="reference";a.attr("data-reference",!0)},this);this.basemapsGroup&&(this.basemapsGroup.owner&&this.basemapsGroup.title||this.basemapsGroup.id)?this._findCustomBasemapsGroup(f.hitch(this,"_handleArcGISBasemapsResponse")):this.showArcGISBasemaps?this._findArcGISBasemapsGroup(f.hitch(this,"_handleArcGISBasemapsResponse")):this._finishStartup();this._checkVTLSupport().then(f.hitch(this,function(a){this._supportsVTL=a}))},startup:function(){this.loaded?
this._refreshUI():q.connect(this,"onLoad",f.hitch(this,function(){this._refreshUI()}))},select:function(a){this._select(a)},getSelected:function(){return this._selectedBasemap},get:function(a){var b;for(b=0;b<this.basemaps.length;b++)if(this.basemaps[b].id===a)return this.basemaps[b];return null},add:function(a){return a&&!a.id?(a.id=this._getUniqueId(),this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):a&&this._isUniqueId(a.id)?(this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):!1},
remove:function(a){var b;for(b=0;b<this.basemaps.length;b++){var c=this.basemaps[b];if(c.id===a)return this._selectedBasemap&&this._selectedBasemap.id===c.id&&(this._selectedBasemap=null),this.basemaps.splice(b,1),this._refreshUI(),this.onRemove(c),c}return null},onLoad:function(){},onSelectionChange:function(){},onAdd:function(a){},onRemove:function(a){},onError:function(a){},_defaultBasemapGalleryGroupQuery:'title:"ArcGIS Online Basemaps" AND owner:esri',_basemapGalleryGroupQuery:null,_finishStartup:function(){this.loaded=
!0;this.onLoad();0===this.map.layerIds.length&&(0<this.basemaps.length&&!this._selectBasemapInProgress)&&this._select(this.basemaps[0].id)},_findCustomBasemapsGroup:function(a){this.basemapsGroup&&this.basemapsGroup.id?this._findArcGISBasemaps(this.basemapsGroup.id,a):(this._basemapGalleryGroupQuery='title:"'+this.basemapsGroup.title+'" AND owner:'+this.basemapsGroup.owner,this._findArcGISBasemapsGroup(a))},_findArcGISBasemapsGroup:function(a){if(this._basemapGalleryGroupQuery)this._findArcGISBasemapsGroupContent(a);
else{var b=this.arcgisUrl+"/portals/self",c={f:"json"};c.culture=m.locale;h({url:b,content:c,callbackParamName:"callback",load:f.hitch(this,function(b,c){this._basemapGalleryGroupQuery=b&&b.basemapGalleryGroupQuery?b.basemapGalleryGroupQuery:this._defaultBasemapGalleryGroupQuery;this._findArcGISBasemapsGroupContent(a)}),error:f.hitch(this,function(a,b){this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery})})}},_findArcGISBasemapsGroupContent:function(a){var b=f.hitch(this,"_findArcGISBasemaps"),
c=this.arcgisUrl+"/community/groups",d={};d.q=this._basemapGalleryGroupQuery;d.f="json";h({url:c,content:d,callbackParamName:"callback",load:f.hitch(this,function(c,d){if(0<c.results.length)b(c.results[0].id,a);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:f.hitch(this,function(a){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_findArcGISBasemaps:function(a,b){var c=this.arcgisUrl+"/search",d={};d.q="group:"+a+' AND type:"web map"';
d.sortField="name";d.sortOrder="desc";d.num=50;d.f="json";h({url:c,content:d,callbackParamName:"callback",load:f.hitch(this,function(a,c){if(0<a.results.length)b(a.results);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:f.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_handleArcGISBasemapsResponse:function(a){0<a.length&&(e.forEach(a,function(a,b){if(this.bingMapsKey||!this.bingMapsKey&&a.title&&
-1===a.title.indexOf("Bing Maps")){var d={};d.id=this._getUniqueId();d.title=a.title;d.thumbnailUrl="";if(a.thumbnail&&a.thumbnail.length&&(d.thumbnailUrl=this.arcgisUrl+"/content/items/"+a.id+"/info/"+a.thumbnail,c.id)){var h=c.id.findCredential(l.urlToObject(this.arcgisUrl).path);h&&(d.thumbnailUrl+="?token\x3d"+h.token)}d.itemId=a.id;d=new L(d,this);this.basemaps.splice(0,0,d)}},this),this._finishStartup())},_refreshUI:function(){this._hasUI&&(n.empty(this.flowContainer),e.forEach(this.basemaps,
function(a,b){a.id||(a.id="basemap_"+b);this.flowContainer.appendChild(this._buildNodeLayout(a))},this),n.create("br",{style:{clear:"both"}},this.flowContainer),this._markSelected(this._selectedBasemap))},_buildNodeLayout:function(a){var b=n.create("div",{id:"galleryNode_"+a.id,"class":"esriBasemapGalleryNode"}),c=n.create("a",{href:"javascript:void(0);"},b);q.connect(c,"onclick",f.hitch(this,"_onNodeClick",a));var d=a.title||"";a.thumbnailUrl?n.create("img",{"class":"esriBasemapGalleryThumbnail",
src:a.thumbnailUrl,title:d,alt:d},c):n.create("img",{"class":"esriBasemapGalleryThumbnail",src:g.toUrl("./images/transparent.gif"),title:d,alt:d},c);a=n.create("div",{"class":"esriBasemapGalleryLabelContainer"},b);n.create("span",{innerHTML:d,alt:d,title:d},a);return b},_onNodeClick:function(a,b){b.preventDefault();this._markSelected(a);this.select(a.id)},_markSelected:function(a){a&&(e.forEach(m.query(".esriBasemapGallerySelectedNode",this.domNode),function(a){w.remove(a,"esriBasemapGallerySelectedNode")}),
(a=v.byId("galleryNode_"+a.id))&&w.add(a,"esriBasemapGallerySelectedNode"))},_select:function(a){this._selectBasemapInProgress=!0;var b=this.get(a);b?(b.layers?this._getServiceInfos(b):(a=b.getLayers(this.arcgisUrl),f.isArray(a)?this._getServiceInfos(b):a.addCallback(f.hitch(this,function(a){this._getServiceInfos(b)}))),this._markSelected(b)):this._selectBasemapInProgress=!1},_getServiceInfos:function(a){"https:"===location.protocol&&e.forEach(a.layers,function(a){if(this._isAgolService(a.url)||this._isHostedService(a.url))a.url=
a.url.replace("http:","https:")},this);this._selectedBasemap=a;var b=[];e.forEach(a.layers,function(a){a.url&&(0<a.url.length&&!a.isReference&&!a.type)&&(a.deferredsPos=b.length,b.push(this._getServiceInfo(a.url)))},this);0<b.length?(new r(b)).addCallback(f.hitch(this,function(b){var c=null;e.forEach(a.layers,function(a){if(0===a.deferredsPos||a.deferredsPos){a.serviceInfoResponse=b[a.deferredsPos][1];var d=a.serviceInfoResponse.fullExtent;d||(d=a.serviceInfoResponse.extent);c=c?c.union(new A(d)):
new A(d)}},this);this.map.extent&&5>this._getIntersectionPercent(c,this.map.extent)&&this.map.setExtent(c,!0);this._switchBasemapLayers(a);this._updateReferenceLayer(a)})):(this._switchBasemapLayers(a),this._updateReferenceLayer(a))},_checkVTLSupport:function(){var a=new p;s("ie")?a.resolve(!1):a.resolve(E.supported());return a},_switchBasemapLayers:function(a){var b=a.layers,c=!1,d,h,l;e.forEach(b,function(a){"VectorTileLayer"===a.type&&(c=!0)});if(c&&!0!==this._supportsVTL)this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because layer type is not supported by your current browser version.");
else if(0<this.map.layerIds.length&&0===this.map.getNumLevels()&&("OpenStreetMap"===b[0].type||b[0].type&&-1<b[0].type.indexOf("BingMaps")||"WebTiledLayer"===b[0].type||"VectorTileLayer"===b[0].type))this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");else{e.forEach(b,function(a){if(!a.isReference&&a.type&&-1<a.type.indexOf("BingMaps")&&!this.bingMapsKey)this.onError("esri.dijit.BasemapGallery: Invalid Bing Maps key.")},
this);var g=0;e.forEach(b,function(a,c){if(!a.isReference){var e;if("OpenStreetMap"===a.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}e=new I({id:"layer_osm",opacity:a.opacity})}else if(a.type&&-1<a.type.indexOf("BingMaps")){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");
return}e=B.MAP_STYLE_AERIAL_WITH_LABELS;"BingMapsAerial"===a.type?e=B.MAP_STYLE_AERIAL:"BingMapsRoad"===a.type&&(e=B.MAP_STYLE_ROAD);e=new B({id:"layer_bing",bingMapsKey:this.bingMapsKey,mapStyle:e,opacity:a.opacity})}else if("WebTiledLayer"===a.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}e=a.initialExtent||a.fullExtent;e=
new J(a.templateUrl||a.url,{visible:a.visibility,opacity:a.opacity,copyright:a.copyright,fullExtent:a.fullExtent&&new A(a.fullExtent),initialExtent:e&&new A(e),subDomains:a.subDomains,tileInfo:a.tileInfo?new K(a.tileInfo):null,tileServers:a.tileServers})}else if("VectorTileLayer"===a.type){e=new E(a.styleUrl,{visible:a.visibility,opacity:a.opacity});0===c&&1<b.length&&this._removeBasemapLayers();var x=this;q.connect(e,"onLoad",f.hitch(this,function(a,c,d){var h;if(x._sameSpatialReference(d.spatialReference,
x.map.spatialReference))if(0<x.map.getNumLevels())if(h=x._sameTilingScheme(d.tileInfo,x.map.__tileInfo))0===c&&1===b.length&&x._removeBasemapLayers(),d._basemapGalleryLayerType="basemap",x.map.addLayer(d,a);else x.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");else x.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");else x.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.")},
g,c))}else if(a.serviceInfoResponse&&a.serviceInfoResponse.mapName){d=new z(a.serviceInfoResponse.spatialReference);h=this._sameSpatialReference(d,this.map.spatialReference);if(this.map.spatialReference&&!h){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");return}if(!0===a.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()){if(l=this._sameTilingScheme(a.serviceInfoResponse.tileInfo,this.map.__tileInfo),!l){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");
return}}else if(!0===a.serviceInfoResponse.singleFusedMapCache&&-1<a.serviceInfoResponse.capabilities.toLowerCase().indexOf("tilesonly")&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}e=(0===this.map.layerIds.length||0<this.map.getNumLevels())&&!0===a.serviceInfoResponse.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a)}else if(a.serviceInfoResponse&&
a.serviceInfoResponse.pixelSizeX){d=new z(a.serviceInfoResponse.spatialReference);h=this._sameSpatialReference(d,this.map.spatialReference);if(!h){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");return}if(!0===a.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()&&(l=this._sameTilingScheme(a.serviceInfoResponse.tileInfo,this.map.__tileInfo),!l)){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");
return}a.serviceInfoResponse.singleFusedMapCache?e=new C(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(e=new G,e.bandIds=a.bandIds,!a.bandIds&&(a.serviceInfoResponse.bandCount&&3<parseInt(a.serviceInfoResponse.bandCount,10))&&(e.bandIds=[0,1,2]),e=new F(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageServiceParameters:e})):(e=new H,e.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&
-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(e.format="png32"),e=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:e}))}"VectorTileLayer"===a.type?g++:e&&(0===c&&this._removeBasemapLayers(),e._basemapGalleryLayerType="basemap",this.map.addLayer(e,g),g++)}},this);this._selectBasemapInProgress=!1;this.onSelectionChange()}},_removeBasemapLayers:function(){var a=this.map.layerIds,b=[];e.forEach(a,function(a){a=this.map.getLayer(a);
"basemap"===a._basemapGalleryLayerType&&b.push(a)},this);0===b.length&&0<a.length&&b.push(this.map.getLayer(a[0]));0<b.length&&e.forEach(b,function(a){this.map.removeLayer(a)},this)},_updateReferenceLayer:function(a){var b;this._removeReferenceLayer();for(b=0;b<a.layers.length;b++)!0===a.layers[b].isReference&&this._addReferenceLayer(a.layers[b])},_removeReferenceLayer:function(){var a;for(a=this.map.layerIds.length-1;0<=a;a--){var b=this.map.getLayer(this.map.layerIds[a]);"reference"===b._basemapGalleryLayerType&&
this.map.removeLayer(b)}},_addReferenceLayer:function(a){"VectorTileLayer"===a.type?this._handleReferenceServiceInfoResponse(a):this._getServiceInfo(a.url,f.hitch(this,"_handleReferenceServiceInfoResponse",a))},_handleReferenceServiceInfoResponse:function(a,b,c){var d;a.serviceInfoResponse=b;"VectorTileLayer"===a.type?d=new E(a.styleUrl,{visible:a.visibility,opacity:a.opacity}):b&&b.mapName?d=!0===b.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a):b&&b.pixelSizeX&&(a.serviceInfoResponse.singleFusedMapCache?
d=new C(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(c=new G,c.bandIds=a.bandIds,!a.bandIds&&(b.bandCount&&3<parseInt(b.bandCount,10))&&(c.bandIds=[0,1,2]),d=new F(a.url,{resourceInfo:b,opacity:a.opacity,visible:a.visibility,imageServiceParameters:c})):(b=new H,b.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(b.format="png32"),b.transparent=
!0,d=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:b})));d&&(d._basemapGalleryLayerType="reference",d.attr("data-reference",!0),this.map.addLayer(d))},_getServiceInfo:function(a,b){return h({url:a,content:{f:"json"},callbackParamName:"callback",load:function(a,c){b&&b(a,c)},error:f.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: service not accessible.")})})},_loadAsCached:function(a){var b=[];a.displayLevels||(b=e.map(a.serviceInfoResponse.tileInfo.lods,
function(a){return a.level}));var c=null;a.exclusionAreas&&a.exclusionAreas.length&&(c=[],e.forEach(a.exclusionAreas,function(a){c.push({minZoom:a.minZoom,maxZoom:a.maxZoom,minScale:a.minScale,maxScale:a.maxScale,geometry:new A(a.geometry)})}));return new C(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,exclusionAreas:c,displayLevels:a.displayLevels||b})},_loadAsDynamic:function(a){var b=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility});
a.visibleLayers&&b.setVisibleLayers(a.visibleLayers);return b},_getIntersectionPercent:function(a,b){var c=b.intersects(a);if(c){var c=c.getWidth()*c.getHeight(),d=b.getWidth()*b.getHeight();return 100*(c/d)}return 0},_getIds:function(){var a=[];e.forEach(this.basemaps,function(b){a.push(b.id)},this);return a},_getUniqueId:function(){for(var a=","+this._getIds().toString()+",",b=0;;)if(-1<a.indexOf(",basemap_"+b+","))b++;else return"basemap_"+b},_isUniqueId:function(a){return-1===(","+this._getIds().toString()+
",").indexOf(","+a+",")?!0:!1},_isAgolService:function(a){return!a?!1:-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/")},_isHostedService:function(a){return!a?!1:-1!==a.indexOf(".arcgis.com/")},_sameSpatialReference:function(a,b){return a&&b&&a.wkt==b.wkt&&(a.wkid===b.wkid||d.isDefined(a.latestWkid)&&a.latestWkid===b.wkid||d.isDefined(b.latestWkid)&&a.wkid===b.latestWkid||d.isDefined(a.latestWkid)&&a.latestWkid===b.latestWkid)||a&&b&&a.isWebMercator()&&b.isWebMercator()?
!0:!1},_sameTilingScheme:function(a,b){var c=this.map,c=c.width>c.height?c.width:c.height,d=!1,h=!1,l,e;for(l=0;l<a.lods.length;l++){var f=a.lods[l].scale;a.dpi!==b.dpi&&(f=a.lods[l].scale/a.dpi);for(e=0;e<b.lods.length;e++){var g=b.lods[e].scale;a.dpi!==b.dpi&&(g=b.lods[e].scale/b.dpi);if(Math.abs(g-f)/g<1/c)if(d){h=!0;break}else d=!0;if(g<f)break}if(h)break}return h||d&&(1===a.lods.length||1===b.lods.length)?!0:!1}})})},"esri/virtualearth/VETiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/_base/config dojo/has dojo/string dojo/_base/Deferred ../kernel ../urlUtils ../SpatialReference ../layers/TileInfo ../layers/TiledMapServiceLayer ../geometry/Extent ../request".split(" "),
function(g,k,e,q,f,m,s,u,y,p,r,v,n,w,t){g=g(n,{declaredClass:"esri.virtualearth.VETiledLayer",constructor:function(b){try{if(b=k.mixin({bingMapsKey:null,culture:"en-US"},b||{}),this.url=p.getProtocolForWebResource()+"//dev.virtualearth.net/REST/v1",this._url=p.urlToObject(this.url),this.spatialReference=new r({wkid:102100}),this.tileInfo=new v({rows:256,cols:256,dpi:96,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},
{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,
scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:0.597164283559817,scale:2256.994353},{level:19,resolution:0.298582141647617,
scale:1128.497176},{level:20,resolution:0.1492910708238085,scale:564.248588}]}),this.initialExtent=this.fullExtent=new w(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new r({wkid:102100})),k.mixin(this,b),this.hasAttributionData=this.showAttribution,this._initLayer=k.hitch(this,this._initLayer),this._errorHandler=k.hitch(this,this._errorHandler),this._getTileInfo=k.hitch(this,this._getTileInfo),this.bingMapsKey)this._getTileInfo();else throw Error("BingMapsKey must be provided.");
}catch(c){throw this.onError(c),c;}},_unsetMap:function(b,c){this.inherited("_unsetMap",arguments)},_getTileInfo:function(){if(this.mapStyle){var b=this._url.path+"/Imagery/Metadata/"+this.mapStyle;if(this.bingMapsKey){var c=this.resourceInfo;!this.loaded&&c?this._initLayer(c):t({url:b,content:k.mixin({},{key:this.bingMapsKey,ss:!0,c:this.culture,include:this.hasAttributionData?"imageryProviders":null}),callbackParamName:"jsonp",load:this._initLayer,error:this._errorHandler})}}},_initLayer:function(b,
c){if(200!==b.statusCode){var d=Error();d.code=b.statusCode;d.message=b.statusDescription;d.details=b.errorDetails;d.authenticationResultCode=b.authenticationResultCode;this.onError(d)}else try{this.resourceInfo=e.toJson(b);var d=b.resourceSets[0].resources[0],l=d.imageUrl.replace("{","${");this.tileServers=q.map(d.imageUrlSubdomains,function(b){var c=p.getProtocolForWebResource();return s.substitute(l,{subdomain:b}).replace("http:",c)});this._tsLength=this.tileServers.length;if(this.loaded)this.refresh(),
this.onMapStyleChange();else{this.copyright=this.copyright||"\x26copy; 2012 Microsoft Corporation and its data suppliers";this.loaded=!0;this.onLoad(this);var h=this.loadCallback;h&&(delete this.loadCallback,h(this))}}catch(f){this.onError(f)}},getAttributionData:function(){var b=new u,c=e.fromJson(this.resourceInfo),d;this.hasAttributionData&&c&&(d=k.getObject("resourceSets.0.resources.0.imageryProviders",!1,c));d?b.callback({contributors:d}):(c=Error("Layer does not have attribution data"),c.log=
f.isDebug,b.errback(c));return b},getTileUrl:function(b,c,d){return s.substitute(this.tileServers[c%this._tsLength].replace(/\{/g,"${"),{quadkey:this._getQuadKey(b,c,d),culture:this.culture,token:this.bingMapsKey})},_getQuadKey:function(b,c,d){var l="",h,e;for(e=b;0<e;e--)b="0",h=1<<e-1,0!=(d&h)&&b++,0!=(c&h)&&(b++,b++),l+=b;return l},setMapStyle:function(b){this.mapStyle=b;this._getTileInfo()},setCulture:function(b){this.culture=b;this._getTileInfo()},setBingMapsKey:function(b){this.bingMapsKey=
b},onMapStyleChange:function(){}});k.mixin(g,{MAP_STYLE_AERIAL:"aerial",MAP_STYLE_AERIAL_WITH_LABELS:"aerialWithLabels",MAP_STYLE_ROAD:"road"});return g})},"esri/layers/WebTiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/url dojo/sniff dojo/string ../config ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),function(g,k,e,q,f,m,s,u,y,p,r,v,n,w){function t(b,c){var d=[],e,h;if(b&&c&&(c.customLayerParameters||
c.customParameters)){e=k.clone(c.customParameters||{});k.mixin(e,c.customLayerParameters||{});h=p.urlToObject(b);for(var f in h.query)e.hasOwnProperty(f)||d.push(f+"\x3d"+h.query[f]);b=h.path+(d.length?"?"+d.join("\x26"):"")}return b}return g(n,{declaredClass:"esri.layers.WebTiledLayer",constructor:function(b,c){c||(c={});this.urlTemplate=b=t(b,c.wmtsInfo);var d=new v(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new r({wkid:102100})),l=new v(-2.0037508342787E7,-2.003750834278E7,
2.003750834278E7,2.0037508342787E7,new r({wkid:102100}));this.initialExtent=c.initialExtent||d;this.fullExtent=c.fullExtent||l;this.tileInfo=c.tileInfo?c.tileInfo:new w({dpi:96,rows:256,cols:256,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,resolution:156543.033928,scale:5.91657527591555E8},{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,
scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},
{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:0.597164283559817,scale:2256.994353},{level:19,resolution:0.298582141647617,scale:1128.497176},{level:20,resolution:0.14929107082380833,
scale:564.248588},{level:21,resolution:0.07464553541190416,scale:282.124294},{level:22,resolution:0.03732276770595208,scale:141.062147},{level:23,resolution:0.01866138385297604,scale:70.5310735}]});this.spatialReference=new r(this.tileInfo.spatialReference.toJson());this.copyright=c.copyright||"";var h=new q(b),d=h.scheme+"://"+h.authority+"/";this.urlPath=b.substring(d.length);this.tileServers=c.tileServers||[];-1===h.authority.indexOf("{subDomain}")&&this.tileServers.push(d);if(c.subDomains&&0<
c.subDomains.length&&1<h.authority.split(".").length){this.subDomains=c.subDomains;var g;e.forEach(c.subDomains,function(b){-1<h.authority.indexOf("${subDomain}")?g=h.scheme+"://"+m.substitute(h.authority,{subDomain:b})+"/":-1<h.authority.indexOf("{subDomain}")&&(g=h.scheme+"://"+h.authority.replace(/\{subDomain\}/gi,b)+"/");this.tileServers.push(g)},this)}this.tileServers=e.map(this.tileServers,function(b){"/"!==b.charAt(b.length-1)&&(b+="/");return b});this._levelToLevelValue=[];e.forEach(this.tileInfo.lods,
function(b){this._levelToLevelValue[b.level]=b.levelValue||b.level},this);this._wmtsInfo=c.wmtsInfo;var z=k.hitch(this,function(){this.loaded=!0;this.onLoad(this)});if(f("chrome")){var d=this.getTileUrl(0,0,0),l=s.defaults.io,u="with-credentials"===l.useCors?p.canUseXhr(d,!0):-1;(l=-1<u?l.corsEnabledServers[u]:null)&&l.withCredentials?y({url:d,handleAs:"arraybuffer"}).addBoth(function(b){z()}):z()}else z()},getTileUrl:function(b,c,d){b=this._levelToLevelValue[b];var e=this.tileServers[c%this.tileServers.length]+
m.substitute(this.urlPath,{level:b,col:d,row:c}),e=e.replace(/\{level\}/gi,b).replace(/\{row\}/gi,c).replace(/\{col\}/gi,d),e=this._appendCustomLayerParameters(e),e=this.addTimestampToURL(e);return p.addProxy(e)},_appendCustomLayerParameters:function(b){var c,d;if(this._wmtsInfo&&(this._wmtsInfo.customLayerParameters||this._wmtsInfo.customParameters))for(c in d=k.clone(this._wmtsInfo.customParameters||{}),k.mixin(d,this._wmtsInfo.customLayerParameters||{}),d)b+=(-1===b.indexOf("?")?"?":"\x26")+c+
"\x3d"+encodeURIComponent(d[c]);return b}})})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(g,k,e,q,f,m){g=g(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,
lercVersion:null,toJson:function(f){var g=this.bbox||this.extent;f=(g=g&&f&&g._normalize(!0))?g.spatialReference.wkid||e.toJson(g.spatialReference.toJson()):null;var k=this.imageSpatialReference,g={bbox:g?g.xmin+","+g.ymin+","+g.xmax+","+g.ymax:null,bboxSR:f,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:k?k.wkid||e.toJson(k.toJson()):f,format:this.format,interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):
null,mosaicRule:this.mosaicRule?e.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?e.toJson(this.renderingRule.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};f=this.timeExtent;g.time=f?f.toJson().join(","):null;return m.filter(g,function(e){if(null!==e&&void 0!==e)return!0})}});k.mixin(g,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",
INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});return g})},"widgets/BasemapGallery/utils":function(){define("dojo/_base/lang dojo/Deferred dojo/_base/array dojo/promise/all esri/SpatialReference jimu/portalUtils jimu/shared/basePortalUrlUtils esri/request".split(" "),function(g,k,e,q,f,m,s,u){function y(b){if(!b)return null;
var c=b.indexOf("?");return 0===b.search(/http|\/\//)&&-1!==c?b.slice(0,c).replace(/\/*$/g,""):b}function p(b){return b?s.removeProtocol(y(b)):null}function r(b){var c=[];e.forEach(b,function(b){c.push(b.url)});c.sort();b="";for(var d=0,d=0;d<c.length;d++){var f=c[d].indexOf("?"),h="",h=-1!==f?c[d].slice(0,f):c[d];b+=h}return b.replace(/\ /,"")}function v(b){var c=!1;if(b)for(var d=0;d<b.length;d++)if(b[d].type){c=!0;break}return c}function n(b,c){var d=null,e=new k;c.spatialReference||b.spatialReference?
(d=c.spatialReference||b.spatialReference,e.resolve(d)):b.owner&&0===b.owner.indexOf("esri_")?e.resolve({wkid:"102100"}):v(c.baseMap.baseMapLayers)?e.resolve({wkid:"102100"}):c.baseMap.baseMapLayers&&c.baseMap.baseMapLayers[0]?u({url:c.baseMap.baseMapLayers[0].url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(b){d=b.spatialReference?b.spatialReference:null;e.resolve(d)}),g.hitch(this,function(){e.resolve(null)})):e.resolve(null);return e}function w(b){var c=
new k;m.getPortalSelfInfo(b).then(g.hitch(this,function(d){t.getBasemapGalleryGroup(b,d.basemapGalleryGroupQuery).then(g.hitch(this,function(b){b.queryItems({start:1,num:100,f:"json",q:m.webMapQueryStr}).then(g.hitch(this,function(b){c.resolve(b)}),g.hitch(this,function(){c.reject()}))}),g.hitch(this,function(){c.reject()}))}));return c}var t={_loadPortalBaseMaps:function(b,c){var d=new k,l=[];w(b).then(function(b){e.forEach(b.results,function(b){var d=new k;l.push(d);b.getItemData().then(function(h){n(b,
h).then(g.hitch(this,function(g){var l=[];if(c&&g&&c.equals(new f(g.wkid))){var l=e.map(h.baseMap.baseMapLayers,function(b){return b}),k=p(b.thumbnailUrl);d.resolve({layers:l,title:b.title||h.baseMap.title,thumbnailUrl:k,spatialReference:g})}else d.resolve({})}))})});q(l).then(function(b){b=e.filter(b,function(b){return b&&b.title?!0:!1},this);d.resolve(b)})},function(b){d.reject(b)});return d},compareSameBasemap:function(b,c){var d=c.layers,e="",h="",e=r(b.layers),h=r(d);return e===h},compareSameBasemapByOrder:function(b,
c){var d=b.layers,e=c.layers;if(d.length!==e.length)return!1;for(var h=0;h<d.length;h++)if(d[h].type||(d[h].type=null),e[h].type||(e[h].type=null),d[h].type!==e[h].type||!d[h].type&&!d[h].type&&(d[h].url||(d[h].url=null),e[h].url||(e[h].url=null),p(d[h].url)!==p(e[h].url)))return!1;return!0},isBingMap:function(b){if(!b||!b.layers)return!1;for(var c=0;c<b.layers.length;c++)if("BingMapsAerial"===b.layers[c].type||"BingMapsRoad"===b.layers[c].type||"BingMapsHybrid"===b.layers[c].type)return!0;return!1},
isNoUrlLayerMap:function(b){if(!b||!b.layers)return!1;for(var c=0;c<b.layers.length;c++)if("BingMapsAerial"===b.layers[c].type||"BingMapsRoad"===b.layers[c].type||"BingMapsHybrid"===b.layers[c].type||"OpenStreetMap"===b.layers[c].type)return!0;return!1},getToken:function(b){b=m.getPortal(b);b.updateCredential();return b.credential?"?token\x3d"+b.credential.token:""},removeUrlQuery:function(b){return y(b)},getStanderdUrl:function(b){return p(b)},getUniqueTitle:function(b,c){if(!c||0===c.length)return b;
var d=e.filter(c,function(c){return c===b?!0:0===c.indexOf(b)?(c=c.substr(b.length+1),!isNaN(+c)):!1});if(0===d.length)return b;d=e.map(d,function(c){return c===b?0:+c.substr(b.length+1)});d=d.sort();return b+" "+(d[d.length-1]+1)},getBasemapInfo:function(b,c){var d,e;return m.getPortal(b).getItemById(c).then(function(b){d=b;return b.getItemData()}).then(function(b){e=b;return n(d,b)}).then(function(b){return{thumbnailUrl:d.thumbnailUrl,title:d.title||e.baseMap.title,layers:e.baseMap.baseMapLayers,
spatialReference:new f(b)}})},getBasemapGalleryGroup:function(b,c){var d=new k,e=m.getPortal(b),f=c.indexOf("esri_");if(0<=f){var f=c.slice(f,f+7),n="esri_"+dojoConfig.locale.slice(0,2);c=c.replace(f,n)}e.queryGroups({f:"json",q:c}).then(g.hitch(this,function(b){0<b.results.length?d.resolve(b.results[0]):d.reject()}),g.hitch(this,function(){d.reject()}));return d}};return t})},"widgets/BasemapGallery/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:esri/dijit/templates/BasemapGallery.html":'\x3cdiv class\x3d"esriBasemapGallery"\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"flowContainer"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/BasemapGallery/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"basemapGalleryDiv" \x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n\r\n',
"url:widgets/BasemapGallery/css/style.css":".jimu-widget-basemapgallery {height: 100%;}.jimu-widget-basemapgallery .esriBasemapGalleryNode:hover{color: #51B1FE;}.jimu-widget-basemapgallery .esriBasemapGalleryThumbnail {border: 1px solid #fff; margin: 1px; -moz-box-shadow: 0px 0px 0px #000; -webkit-box-shadow: 0px 0px 0px #000; box-shadow: 0px 0px 7px #000;}.jimu-widget-basemapgallery .esriBasemapGallerySelectedNode{color: #51B1FE;}.jimu-widget-basemapgallery .esriBasemapGalleryLabelContainer{padding-top: 2px;}.jimu-widget-basemapgallery .esriBasemapGalleryThumbnail{width: 100px; height: 67px;}.jimu-widget-basemapgallery .esriBasemapGallerySelectedNode .esriBasemapGalleryThumbnail{border-color: #51B1FE !important;}.jimu-widget-basemapgallery .esriBasemapGalleryNode {width: 85px; margin: 5px 10px 0 10px;}.jimu-rtl .jimu-widget-basemapgallery .esriBasemapGalleryNode {float: right;}.jimu-widget-basemapgallery .esriBasemapGalleryThumbnail {display: block; margin: 1px auto;}",
"*now":function(g){g(['dojo/i18n!*preload*widgets/BasemapGallery/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/Deferred jimu/BaseWidget jimu/portalUtils jimu/PanelManager jimu/portalUrlUtils jimu/utils esri/SpatialReference esri/dijit/Basemap esri/dijit/BasemapLayer esri/dijit/BasemapGallery dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on dojo/promise/all ./utils jimu/dijit/LoadingIndicator".split(" "),function(g,k,e,q,f,m,s,u,y,p,r,v,n,w,t,b,c,d,l){return g([q,k],{name:"BasemapGallery",baseClass:"jimu-widget-basemapgallery",
basemapGallery:null,spatialRef:null,startup:function(){this.inherited(arguments);this.initBasemaps()},resize:function(){this._responsive()},_responsive:function(){var c=b("#"+this.id)[0],c=t.getStyle(c,"width"),d=parseInt(c/105,10);if(0<d){var e=parseInt(c%105/d,10);b(".esriBasemapGalleryNode",this.id).forEach(function(b){t.setStyle(b,"width",85+e+"px")})}},initBasemaps:function(){var b,g,k=n.clone(this.config.basemapGallery);this.loadingShelter.show();1===k.mode?b=l._loadPortalBaseMaps(this.appConfig.portalUrl,
this.map.spatialReference):(b=new e,b.resolve(k.basemaps));g=f.getPortal(this.appConfig.portalUrl).loadSelfInfo();d({portalSelf:g,basemaps:b}).then(n.hitch(this,function(b){for(var d=b.basemaps,e=[],f=0,g=this._getWebmapBasemap(),d=w.filter(d,function(c){if(!c||!c.title)return!1;var d,e;d=b.portalSelf.bingKey?!0:l.isBingMap(c)?!1:!0;e=this.map.spatialReference.equals(new y(c.spatialReference))?!0:!1;return c.title&&d&&e},this),f=0;f<d.length&&!l.compareSameBasemapByOrder(d[f],g);f++);f===d.length&&
d.push(g);for(f=0;f<d.length;f++){for(var g=d[f].layers.length,h=[],m=0;m<g;m++)h.push(new r(d[f].layers[m]));d[f].layers=h;d[f].thumbnailUrl?/^(https?:)?\/\//.test(d[f].thumbnailUrl)?d[f].thumbnailUrl+=l.getToken(this.appConfig.portalUrl):d[f].thumbnailUrl=u.processUrlInWidgetConfig(d[f].thumbnailUrl,this.folderUrl):d[f].thumbnailUrl=this.folderUrl+"images/default.jpg";e.push(new p(d[f]))}k.map=this.map;this.appConfig.portalUrl&&(k.portalUrl=this.appConfig.portalUrl);k.basemaps=e;k.showArcGISBasemaps=
!1;k.bingMapsKey=b.portalSelf.bingKey;this.basemapGallery=new v(k,this.basemapGalleryDiv);this.basemapGallery.startup();this.own(c(this.basemapGallery,"selection-change",n.hitch(this,this.selectionChange)));this._responsive();this.loadingShelter.hide()}))},_getWebmapBasemap:function(){var b;b=this.map.itemInfo.item.thumbnail?s.getItemUrl(this.appConfig.portalUrl,this.map.itemInfo.item.id)+"/info/"+this.map.itemInfo.item.thumbnail:null;return{title:this.map.itemInfo.itemData.baseMap.title,thumbnailUrl:b,
layers:this.map.itemInfo.itemData.baseMap.baseMapLayers,spatialReference:this.map.spatialReference}},selectionChange:function(){this.isOnScreen&&m.getInstance().closePanel(this.id+"_panel")}})});