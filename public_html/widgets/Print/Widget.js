// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request esri/lang esri/arcgis/utils dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-style dojo/dom-construct dojo/dom-class dojo/promise/all dojo/Deferred jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect dojo/query jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter jimu/dijit/Message jimu/utils dijit/form/ValidationTextBox dijit/form/Form dijit/form/Select dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton esri/IdentityManager dojo/store/Memory".split(" "),
function(h,n,r,t,v,e,l,g,c,b,d,q,f,a,B,z,x,u,E,y,D,C,F,H,G,L,M,k){y=h([n,r,t],{widgetsInTemplate:!0,templateString:y,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,_currentTemplateInfo:null,postCreate:function(){this.inherited(arguments);this.printTask=
new v(this.printTaskURL,{async:this.async});this.printparams=new e;this.printparams.map=this.map;this.shelter=new G({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.titleNode.set("value",this.defaultTitle);this.authorNode.set("value",this.defaultAuthor);this.copyrightNode.set("value",this.defaultCopyright);var a=E.setHttpProtocol(this.printTaskURL),b=E.getNewPrintUrl(this.appConfig.portalUrl);this._isNewPrintUrl=a===b||/sharing\/tools\/newPrint$/.test(a);
a=F("input",this.printWidgetMapScale.domNode)[0];b=F("input",this.printWidgetMapExtent.domNode)[0];M.combineRadioCheckBoxWithLabel(a,this.printWidgetMapScaleLabel);M.combineRadioCheckBoxWithLabel(b,this.printWidgetMapExtentLabel);"MAP_ONLY"===this.defaultLayout?f.setStyle(this.titleTr,"display","none"):f.setStyle(this.titleTr,"display","");this._hasLabelLayer()?(f.setStyle(this.labelsFormDijit.domNode,"display",""),f.setStyle(this.labelsTitleNode,"display","")):(f.setStyle(this.labelsFormDijit.domNode,
"display","none"),f.setStyle(this.labelsTitleNode,"display","none"));H.getInstance(this.map,this.map.itemInfo).then(d.hitch(this,function(a){this.layerInfosObj=a;return x([this._getPrintTaskInfo(),this._getLayerTemplatesInfo()]).then(d.hitch(this,function(a){var s=a[0];if((a=a[1])&&!a.error){if((a=a&&a.results)&&0<a.length)q.some(a,d.hitch(this,function(s){return s&&"Output_JSON"===s.paramName?this.templateInfos=s.value:!1})),this.templateInfos&&0<this.templateInfos.length&&(this.templateNames=q.map(this.templateInfos,
function(s){return s.layoutTemplate}))}else console.warn("Get Layout Templates Info Error",a&&a.error);!c.isDefined(s)||s&&s.error?this._handleError(s.error):this._handlePrintInfo(s)}))})).always(d.hitch(this,function(){this.shelter.hide()}));this.printTask._getPrintDefinition&&C.after(this.printTask,"_getPrintDefinition",d.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&(C.after(this.printTask,"_createOperationalLayers",d.hitch(this,"_fixInvalidSymbol")),C.after(this.printTask,
"_createOperationalLayers",d.hitch(this,"_excludeInvalidLegend")))},_hasLabelLayer:function(){return q.some(this.map.graphicsLayerIds,function(a){return(a=this.map.getLayer(a))&&"esri.layers.LabelLayer"===a.declaredClass},this)},_getPrintTaskInfo:function(){var a=new u;this._isNewPrintUrl?a.resolve({isGPPrint:!1}):g({url:this.printTaskURL,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(d.hitch(this,function(b){a.resolve({isGPPrint:!0,data:b})}),d.hitch(this,function(b){a.resolve({error:b})}));
return a},_getLayerTemplatesInfo:function(){var a=new u,b=this.printTaskURL.split("/"),k=b.indexOf("GPServer");if(-1<k){var c=null,c=/Utilities\/PrintingTools\/GPServer/.test(this.printTaskURL)?b.slice(0,k+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info Task")+"/execute":b.slice(0,k+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info")+"/execute";g({url:c,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(d.hitch(this,function(s){a.resolve(s)}),
d.hitch(this,function(s){a.resolve({error:s})}))}else a.resolve(null);return a},_fixInvalidSymbol:function(a){q.forEach(a,function(a){"map_graphics"===a.id&&(a=d.getObject("featureCollection.layers",!1,a))&&0<a.length&&q.forEach(a,function(a){a&&(a.featureSet&&"esriGeometryPoint"===a.featureSet.geometryType)&&q.forEach(a.featureSet.features,function(a){a&&(a.symbol&&!a.symbol.style)&&(a.symbol.style="esriSMSSquare")})})},this);return a},_excludeInvalidLegend:function(a){function k(s){return q.filter(s.subLayerIds,
d.hitch(this,function(m){return(m=this.layerInfosObj.getLayerInfoById(s.id+"_"+m))&&m.getShowLegendOfWebmap()}))}if(this.printTask.allLayerslegend){for(var c=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),c=q.map(c,function(s){return{id:s.layer.id}}),G=this.printTask.allLayerslegend,s=[],w=0;w<G.length;w++){var m=G[w],A=this.map.getLayer(m.id),g=this.layerInfosObj.getLayerInfoById(m.id),f=A&&A.declaredClass&&"esri.layers.GraphicsLayer"!==A.declaredClass,A=!A.renderer||A.renderer&&!A.renderer.hasVisualVariables(),
g=g&&g.getShowLegendOfWebmap();f&&(A&&g)&&(m.subLayerIds&&(m.subLayerIds=d.hitch(this,k,m)()),s.push(m))}q.forEach(c,d.hitch(this,function(m){var w=q.some(s,d.hitch(this,function(s){return s.id===m.id})),a=this.layerInfosObj.getLayerInfoById(m.id),a=a&&a.getShowLegendOfWebmap()&&a.isShowInMap();!w&&a&&s.push(m)}));this.printTask.allLayerslegend=s}return a},printDefInspector:function(a){"force"===this.preserve.preserveScale&&(a.mapOptions.scale=this.preserve.forcedScale);return a},_handleError:function(a){console.log("print widget load error: ",
a);new L({message:a.message||a})},onLayoutChange:function(a){var b=this.templateNames&&this.templateNames.indexOf(a);-1<b?(f.empty(this.customTextElementsTable),a=this._currentTemplateInfo=this.templateInfos[b],(b=d.getObject("layoutOptions.customTextElements",!1,a))&&0<b.length&&q.forEach(b,d.hitch(this,function(a){for(var b in a){var s=this.customTextElementsTable.insertRow(-1);s.insertCell(-1).appendChild(f.toDom(b+": "));s.insertCell(-1).appendChild((new k({name:b,trim:!0,required:!1,value:a[b],
style:"width:100%"})).domNode)}})),d.getObject("layoutOptions.hasAuthorText",!1,a)?f.setStyle(this.authorTr,"display",""):f.setStyle(this.authorTr,"display","none"),d.getObject("layoutOptions.hasCopyrightText",!1,a)?f.setStyle(this.copyrightTr,"display",""):f.setStyle(this.copyrightTr,"display","none"),d.getObject("layoutOptions.hasTitleText",!1,a)?f.setStyle(this.titleTr,"display",""):f.setStyle(this.titleTr,"display","none"),d.getObject("layoutOptions.hasLegend",!1,a)?f.setStyle(this.legendTr,"display",
""):f.setStyle(this.legendTr,"display","none")):"MAP_ONLY"===a?(f.setStyle(this.authorTr,"display","none"),f.setStyle(this.copyrightTr,"display","none"),f.setStyle(this.titleTr,"display","none"),f.setStyle(this.legendTr,"display","none"),this._currentTemplateInfo={layoutOptions:{hasTitleText:!1,hasCopyrightText:!1,hasAuthorText:!1,hasLegend:!1}}):(f.setStyle(this.authorTr,"display",""),f.setStyle(this.copyrightTr,"display",""),f.setStyle(this.titleTr,"display",""),f.setStyle(this.legendTr,"display",
""),this._currentTemplateInfo={layoutOptions:{hasTitleText:!0,hasCopyrightText:!0,hasAuthorText:!0,hasLegend:!0}})},_getMapAttribution:function(){var a=this.map.attribution;return a&&a.domNode?f.getProp(a.domNode,"textContent"):""},_handlePrintInfo:function(b){if(b.isGPPrint){b=b.data;a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");a.set(this.formatDijit.domNode.parentNode.parentNode,"display","");a.set(this.advancedButtonDijit.domNode,"display","");var c=q.filter(b.parameters,
function(a){return"Layout_Template"===a.name});if(0===c.length)console.log('print service parameters name for templates must be "Layout_Template"');else{var k=q.map(c[0].choiceList,function(a){return{label:a,value:a}});k.sort(function(a,s){return a.label>s.label?1:s.label>a.label?-1:0});this.layoutDijit.addOption(k);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",c[0].defaultValue);b=q.filter(b.parameters,function(a){return"Format"===a.name});0===b.length?
console.log('print service parameters name for format must be "Format"'):(c=q.map(b[0].choiceList,function(a){return{label:a,value:a}}),c.sort(function(a,s){return a.label>s.label?1:s.label>a.label?-1:0}),this.formatDijit.addOption(c),this.defaultFormat?this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",b[0].defaultValue))}}else a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.formatDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.advancedButtonDijit.domNode,
"display","none")},print:function(){if(this.printSettingsFormDijit.isValid()){var b=this.printSettingsFormDijit.get("value");d.mixin(b,this.layoutMetadataDijit.get("value"));d.mixin(b,this.labelsFormDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");d.mixin(b,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var c=this.mapQualityFormDijit.get("value"),k=this.mapOnlyFormDijit.get("value");d.mixin(k,c);var G=this.customTextElementsDijit.get("value"),c=[],s;for(s in G){var w=
{};w[s]=G[s];c.push(w)}w=this._currentTemplateInfo;s=d.getObject("layoutOptions.hasAuthorText",!1,w);var G=d.getObject("layoutOptions.hasCopyrightText",!1,w),w=d.getObject("layoutOptions.hasTitleText",!1,w),m=new l;m.format=b.format;m.layout=b.layout;m.preserveScale="true"===b.preserveScale||"force"===b.preserveScale;m.label=b.title;m.exportOptions=k;m.showLabels=b.showLabels&&b.showLabels[0];m.layoutOptions={authorText:s?b.author:"",copyrightText:G?b.copyright||this._getMapAttribution():"",legendLayers:this._getLegendLayers(),
titleText:w?b.title:"",customTextElements:c};this.printparams.template=m;this.printparams.extraParameters={printFlag:!0};k=this.printTask.execute(this.printparams);(new I({count:this.count.toString(),icon:"PDF"===b.format?this.pdfIcon:this.imageIcon,docName:b.title,title:b.format+", "+b.layout,fileHandle:k,nls:this.nls})).placeAt(this.printResultsNode,"last").startup();a.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},_getLegendLayers:function(){var a=
d.getObject("layoutOptions.hasLegend",!1,this._currentTemplateInfo),c=0<this.layoutForm.legend.length&&this.layoutForm.legend[0];if(this.printTask&&!this.printTask._createOperationalLayers){var k=[];a&&c&&(a=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),k=q.map(a,function(a){return{layerId:a.layer.id}}));return k}return a&&c?null:[]},clearResults:function(){B.empty(this.printResultsNode);a.set(this.clearActionBarNode,"display","none");this.count=1},updateAuthor:function(a){(a=a||"")&&
this.authorTB&&this.authorTB.set("value",a)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",this.map.getScale())}});var I=h([n,r,t],{widgetsInTemplate:!0,templateString:D,url:null,postCreate:function(){this.inherited(arguments);this.progressBar.set("label",this.nls.creatingPrint);this.fileHandle.then(d.hitch(this,"_onPrintComplete"),d.hitch(this,"_onPrintError"))},_onPrintComplete:function(a){a.url?(this.url=a.url,f.setStyle(this.progressBar.domNode,"display","none"),f.setStyle(this.successNode,
"display","inline-block"),z.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(a){console.log(a);f.setStyle(this.progressBar.domNode,"display","none");f.setStyle(this.errNode,"display","block");z.add(this.resultNode,"printResultError");f.setAttr(this.domNode,"title",a.details||a.message||"")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return y})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../urlUtils ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../geometry/scaleUtils ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query require require".split(" "),
function(h,n,r,t,v,e,l,g,c,b,d,q,f,a,B,z,x,u,E,y,D,C,F,H){return h(f,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,b){this.url=a;this.printGp=new u(this.url);this._handler=n.hitch(this,this._handler);b&&b.async&&(this.async=b.async);this._colorEvaluator=H("$..color")},_handler:function(a,b,c,k,g){try{var f;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",n.hitch(this,function(a){f=a.value;this._successHandler([f],"onComplete",c,g)})):(f=
a[0].value,this._successHandler([f],"onComplete",c,g))}catch(l){this._errorHandler(l,k,g)}},execute:function(a,c,f){var k=this._handler,l=this._errorHandler,d=a.template||new E;d.hasOwnProperty("showLabels")||(d.showLabels=!0);var q=d.exportOptions,e;q&&(e={outputSize:[q.width,q.height],dpi:q.dpi});var q=d.layoutOptions,h,s=[];if(q){this.legendAll=!1;q.legendLayers?r.forEach(q.legendLayers,function(a){var m={};m.id=a.layerId;a.subLayerIds&&(m.subLayerIds=a.subLayerIds);s.push(m)}):this.legendAll=
!0;var w,m;if("Miles"===q.scalebarUnit||"Kilometers"===q.scalebarUnit)w="esriKilometers",m="esriMiles";else if("Meters"===q.scalebarUnit||"Feet"===q.scalebarUnit)w="esriMeters",m="esriFeet";h={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};h={titleText:q.titleText,authorText:q.authorText,copyrightText:q.copyrightText,customTextElements:q.customTextElements,scaleBarOptions:{metricUnit:w,metricLabel:h[w],nonMetricUnit:m,nonMetricLabel:h[m]},legendOptions:{operationalLayers:s}}}w=this._getPrintDefinition(a.map,
d);a.outSpatialReference&&(w.mapOptions.spatialReference=a.outSpatialReference.toJson());a.template&&g.isDefined(a.template.showAttribution)&&(w.mapOptions.showAttribution=a.template.showAttribution);n.mixin(w,{exportOptions:e,layoutOptions:h});this.allLayerslegend&&n.mixin(w.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});if(w.operationalLayers){e=w.operationalLayers;var A,B=function(a){return g.fixJson(n.mixin(a,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))};
for(h=0;h<e.length;h++)if(e[h].featureCollection&&e[h].featureCollection.layers)for(m=0;m<e[h].featureCollection.layers.length;m++){var z=e[h].featureCollection.layers[m];z.layerDefinition&&(z.layerDefinition.drawingInfo&&z.layerDefinition.drawingInfo.renderer&&z.layerDefinition.drawingInfo.renderer.symbol)&&(A=z.layerDefinition.drawingInfo.renderer,"esriCLS"===A.symbol.type?A.symbol=B(A.symbol):A.symbol.outline&&"esriCLS"===A.symbol.outline.type&&(A.symbol.outline=B(A.symbol.outline)));if(z.featureSet&&
z.featureSet.features)for(q=0;q<z.featureSet.features.length;q++)A=z.featureSet.features[q],A.symbol&&("esriCLS"===A.symbol.type?A.symbol=B(A.symbol):A.symbol.outline&&"esriCLS"===A.symbol.outline.type&&(A.symbol.outline=B(A.symbol.outline)))}}d={Web_Map_as_JSON:t.toJson(g.fixJson(w)),Format:d.format,Layout_Template:d.layout};a.extraParameters&&(d=n.mixin(d,a.extraParameters));var u=new v(b._dfdCanceller);a=function(a,s){k(a,s,c,f,u)};w=function(a){l(a,f,u)};u._pendingDfd=this.async?this.printGp.submitJob(d,
a,null,w):this.printGp.execute(d,a,w);return u},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",
geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=e("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var b,c=F.createSurface(D.create("div"),1024,1024);b="image/svg+xml"===a.contentType?
c.createObject(F.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:C.pt2px(a.width),height:C.pt2px(a.height),x:0,y:0}):c.createObject(F.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in c&&c._render(!0);var k=c.rawNode.getContext("2d"),g=Math.ceil(b.getBoundingBox().width),f=Math.ceil(b.getBoundingBox().height);b=k.getImageData(b.getBoundingBox().x,b.getBoundingBox().y,g,f);k.canvas.width=g;k.canvas.height=f;k.putImageData(b,0,0);k=k.canvas.toDataURL("image/png");a={type:"esriPMS",
imageData:k.substr(22,k.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:C.px2pt(f),width:a.size?a.size*(g/f):C.px2pt(g),xoffset:a.xoffset,yoffset:a.yoffset};c.destroy();return a}},_convertSvgRenderer:function(a){if("simple"===a.type&&a.symbol&&(a.symbol.path||"image/svg+xml"===a.symbol.contentType))a.symbol=this._convertSvgSymbol(a.symbol);else if("uniqueValue"===a.type){if(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType))a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol);
a.uniqueValueInfos&&r.forEach(a.uniqueValueInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this)}else if("classBreaks"===a.type){if(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType))a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol);a.classBreakInfos&&r.forEach(a.classBreakInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},
this)}},_createFeatureCollection:function(b,c,g){var k=this._createPolygonLayer(),f=this._createPolylineLayer(),d=this._createPointLayer(),l=this._createMultipointLayer(),q=this._createPointLayer();q.layerDefinition.name="textLayer";delete q.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass)k.layerDefinition.name=f.layerDefinition.name=d.layerDefinition.name=l.layerDefinition.name=n.getObject("arcgisProps.title",!1,b)||b.name||
b.id;if(b.renderer&&!n.isFunction(b.renderer.attributeField)){var e=b.renderer.toJson();if("temporal"===e.type){var e={latestObservationRenderer:e.latestObservationRenderer,trackLinesRenderer:e.trackRenderer,observationAger:e.observationAger,renderer:e.observationRenderer},s={};b._trackIdField&&(s.trackIdField=b._trackIdField);b._startTimeField&&(s.startTimeField=b._startTimeField);b._endTimeField&&(s.endTimeField=b._endTimeField);k.layerDefinition.drawingInfo=e;k.layerDefinition.timeInfo=s;f.layerDefinition.drawingInfo=
e;f.layerDefinition.timeInfo=s;d.layerDefinition.drawingInfo=e;d.layerDefinition.timeInfo=s;l.layerDefinition.drawingInfo=e;l.layerDefinition.timeInfo=s}else k.layerDefinition.drawingInfo.renderer=e,f.layerDefinition.drawingInfo.renderer=e,d.layerDefinition.drawingInfo.renderer=e,l.layerDefinition.drawingInfo.renderer=e}else delete k.layerDefinition.drawingInfo,delete f.layerDefinition.drawingInfo,delete d.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo;e=b.fields;!e&&(b.renderer&&
!n.isFunction(b.renderer.attributeField))&&("esri.renderer.ClassBreaksRenderer"===b.renderer.declaredClass?(e=[{name:b.renderer.attributeField,type:"esriFieldTypeDouble"}],b.renderer.normalizationField&&e.push({name:b.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===b.renderer.declaredClass&&(e=[{name:b.renderer.attributeField,type:"esriFieldTypeString"}],b.renderer.attributeField2&&e.push({name:b.renderer.attributeField2,type:"esriFieldTypeString"}),
b.renderer.attributeField3&&e.push({name:b.renderer.attributeField3,type:"esriFieldTypeString"})));e&&(k.layerDefinition.fields=e,f.layerDefinition.fields=e,d.layerDefinition.fields=e,l.layerDefinition.fields=e);var e=b.graphics.length,w;for(w=0;w<e;w++){var m=b.graphics[w];if(!1!==m.visible&&m.geometry){s=m.toJson();s.symbol&&(s.symbol.outline&&s.symbol.outline.color&&s.symbol.outline.color[3])&&(s.symbol.outline.color[3]=255);if(b.renderer&&!s.symbol&&(n.isFunction(b.renderer.attributeField)||this._isFeatureCollectionRequired(b.renderer)||
"esri.renderer.DotDensityRenderer"===b.renderer.declaredClass||g)){g=g||b.renderer;var A=g.getSymbol(m);if(!A)continue;s.symbol=A.toJson();this._isFeatureCollectionRequired(g)&&this._applyVisualVariables(s.symbol,{renderer:g,graphic:m,symbol:A,mapResolution:c&&c.getResolutionInMeters(),mapScale:c&&c.getScale()})}s.symbol&&(s.symbol.path||"image/svg+xml"===s.symbol.contentType?s.symbol=this._convertSvgSymbol(s.symbol):s.symbol.text&&delete s.attributes);switch(m.geometry.type){case "polygon":k.featureSet.features.push(s);
break;case "polyline":f.featureSet.features.push(s);break;case "point":s.symbol&&s.symbol.text?q.featureSet.features.push(s):d.featureSet.features.push(s);break;case "multipoint":l.featureSet.features.push(s);break;case "extent":s.geometry=a.fromExtent(m.geometry).toJson(),k.featureSet.features.push(s)}}}c=[];0<k.featureSet.features.length&&c.push(k);0<f.featureSet.features.length&&c.push(f);0<l.featureSet.features.length&&c.push(l);0<d.featureSet.features.length&&c.push(d);0<q.featureSet.features.length&&
c.push(q);r.forEach(c,function(a){a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&r.every(a.featureSet.features,function(a){return a.symbol})&&delete a.layerDefinition.drawingInfo});r.forEach(c,function(a){a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(a.layerDefinition.drawingInfo.renderer)},this);return{id:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0,featureCollection:{layers:c}}},_getPrintDefinition:function(a,
b){var c={operationalLayers:this._createOperationalLayers(a,b)},k=a.extent,g=a.spatialReference;a.spatialReference._isWrappable()&&(k=k._normalize(!0),g=k.spatialReference);k={mapOptions:{showAttribution:a.showAttribution,extent:k.toJson(),spatialReference:g.toJson()}};b.preserveScale&&n.mixin(k.mapOptions,{scale:b.outScale||z.getScale(a)});a.timeExtent&&n.mixin(k.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});g={};n.mixin(g,k,c);return g},_createOperationalLayers:function(a,
b){var g,k,f,d,l=[];this.allLayerslegend=this.legendAll?[]:null;var e=r.map(a.layerIds,a.getLayer,a);a._mapImageLyr&&e.push(a._mapImageLyr);for(g=0;g<e.length;g++)if(k=e[g],k.loaded&&k.visible)switch(f=k.declaredClass,d={id:k.id,title:n.getObject("arcgisProps.title",!1,k)||k.id,opacity:k.opacity,minScale:k.minScale||0,maxScale:k.maxScale||0},d=n.mixin(d,this._getUrlAndToken(k)),k.getNode()&&y.get(k.getNode(),"data-reference")&&(d._isRefLayer=!0),f){case "esri.layers.ArcGISDynamicMapServiceLayer":var h=
[];f=!!k._params.layers;if(k._params.dynamicLayers)f=t.fromJson(k._params.dynamicLayers),r.forEach(f,function(a){h.push({id:a.id,name:a.name,layerDefinition:a});delete a.id;delete a.name;delete a.maxScale;delete a.minScale}),0===h.length&&(d.visibleLayers=[-1]);else if(k.supportsDynamicLayers){if(f||k.layerDefinitions||k.layerTimeOptions){var s=k.createDynamicLayerInfosFromLayerInfos(),w=null;f&&(w=k.visibleLayers);var w=c._getVisibleLayers(s,w),m=c._getLayersForScale(b.outScale||a.getScale(),s);
r.forEach(s,function(a){if(!a.subLayerIds){var s=a.id;-1<r.indexOf(w,s)&&-1<r.indexOf(m,s)&&(a={source:a.source.toJson()},k.layerDefinitions&&k.layerDefinitions[s]&&(a.definitionExpression=k.layerDefinitions[s]),k.layerTimeOptions&&k.layerTimeOptions[s]&&(a.layerTimeOptions=k.layerTimeOptions[s].toJson()),h.push({id:s,layerDefinition:a}))}});0===h.length&&(d.visibleLayers=[-1])}}else r.forEach(k.layerInfos,function(a){var s={id:a.id,layerDefinition:{}};k.layerDefinitions&&k.layerDefinitions[a.id]&&
(s.layerDefinition.definitionExpression=k.layerDefinitions[a.id]);k.layerTimeOptions&&k.layerTimeOptions[a.id]&&(s.layerDefinition.layerTimeOptions=k.layerTimeOptions[a.id].toJson());(s.layerDefinition.definitionExpression||s.layerDefinition.layerTimeOptions)&&h.push(s)}),f&&(d.visibleLayers=k.visibleLayers);h.length&&(d.layers=h);l.push(d);this.allLayerslegend&&this.allLayerslegend.push({id:k.id,subLayerIds:k.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":d=n.mixin(d,{url:k.url,
bandIds:k.bandIds,compressionQuality:k.compressionQuality,format:k.format,interpolation:k.interpolation});k.mosaicRule&&n.mixin(d,{mosaicRule:k.mosaicRule.toJson()});k.renderingRule&&n.mixin(d,{renderingRule:k.renderingRule.toJson()});l.push(d);this.allLayerslegend&&this.allLayerslegend.push({id:k.id});break;case "esri.layers.WMSLayer":d=n.mixin(d,{url:k.url,title:k.title,type:"wms",version:k.version,transparentBackground:k.imageTransparency,visibleLayers:k.visibleLayers});l.push(d);this.allLayerslegend&&
this.allLayerslegend.push({id:k.id,subLayerIds:k.visibleLayers});break;case "esri.virtualearth.VETiledLayer":f=k.mapStyle;"aerialWithLabels"===f&&(f="Hybrid");d=n.mixin(d,{visibility:k.visible,type:"BingMaps"+f,culture:k.culture,key:k.bingMapsKey});l.push(d);break;case "esri.layers.OpenStreetMapLayer":d=n.mixin(d,{credits:k.copyright,type:"OpenStreetMap",url:q.getAbsoluteUrl(k.tileServers[0])});l.push(d);break;case "esri.layers.WMTSLayer":d=n.mixin(d,{url:k.url,type:"wmts",layer:k._identifier,style:k._style,
format:k.format,tileMatrixSet:k._tileMatrixSetId});l.push(d);break;case "esri.layers.MapImageLayer":f=k.getImages();r.forEach(f,function(a,s){a.href&&(d={id:k.id+"_image"+s,type:"image",title:k.id,minScale:k.minScale||0,maxScale:k.maxScale||0,opacity:k.opacity*a.opacity,extent:a.extent.toJson()},"data:image/png;base64,"===a.href.substr(0,22)?d.imageData=a.href.substr(22):d.url=a.href,l.push(d))});break;case "esri.layers.VectorTileLayer":f=/^https?:\/\/basemaps(dev)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;
!d._isRefLayer&&(k.currentStyleInfo&&f.test(k.currentStyleInfo.serviceUrl))&&(d.url="http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer",l.push(d));break;case "esri.layers.WebTiledLayer":f=k.url.replace(/\$\{/g,"{");d=n.mixin(d,{type:"WebTiledLayer",urlTemplate:f,credits:k.copyright});k.subDomains&&0<k.subDomains.length&&(d.subDomains=k.subDomains);k._wmtsInfo&&(d.wmtsInfo=k._wmtsInfo);delete d.url;l.push(d);break;default:if(k.getTileUrl||k.getImageUrl)d=n.mixin(d,{url:k.url}),
l.push(d)}for(g=0;g<a.graphicsLayerIds.length;g++)if(k=a.getLayer(a.graphicsLayerIds[g]),k.loaded&&k.visible)switch(f=k.declaredClass,f){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===f&&!b.showLabels||k.renderer&&"esri.renderer.HeatmapRenderer"===k.renderer.declaredClass)continue;e=null;k.url&&k.renderer&&("esri.renderer.ScaleDependentRenderer"===k.renderer.declaredClass?"scale"===k.renderer.rangeType?
e=k.renderer.getRendererInfoByScale(a.getScale())&&k.renderer.getRendererInfoByScale(a.getScale()).renderer:"zoom"===k.renderer.rangeType&&(e=k.renderer.getRendererInfoByZoom(a.getZoom())&&k.renderer.getRendererInfoByZoom(a.getZoom()).renderer):e=k.renderer);if(e&&("esri.renderer.SimpleRenderer"===e.declaredClass||"esri.renderer.TemporalRenderer"===e.declaredClass||n.isString(e.attributeField)&&k._getField(e.attributeField,!0))&&!this._isFeatureCollectionRequired(e)&&"esri.renderer.DotDensityRenderer"!==
e.declaredClass&&"esri.layers.CSVLayer"!==k.declaredClass&&"esri.layers.StreamLayer"!==k.declaredClass)if(d={id:k.id,title:n.getObject("arcgisProps.title",!1,k)||k.id,opacity:k.opacity,minScale:k.minScale||0,maxScale:k.maxScale||0,layerDefinition:{drawingInfo:{renderer:e.toJson()}}},d=n.mixin(d,this._getUrlAndToken(k)),"esri.renderer.TemporalRenderer"===e.declaredClass&&(f=d.layerDefinition.drawingInfo,f.latestObservationRenderer=f.renderer.latestObservationRenderer,f.trackLinesRenderer=f.renderer.trackRenderer,
f.observationAger=f.renderer.observationAger,f.renderer=f.renderer.observationRenderer,k._trackIdField&&(d.layerDefinition.timeInfo={trackIdField:k._trackIdField})),this._convertSvgRenderer(d.layerDefinition.drawingInfo.renderer),1>k.opacity||"esri.renderer.TemporalRenderer"===e.declaredClass||this._updateLayerOpacity(d))if(k._params.source&&(e=k._params.source.toJson(),n.mixin(d.layerDefinition,{source:e})),k.getDefinitionExpression()&&n.mixin(d.layerDefinition,{definitionExpression:k.getDefinitionExpression()}),
2!==k.mode)0<k.getSelectedFeatures().length&&(e=r.map(k.getSelectedFeatures(),function(a){return a.attributes[k.objectIdField]}),0<e.length&&k.getSelectionSymbol()&&n.mixin(d,{selectionObjectIds:e,selectionSymbol:k.getSelectionSymbol().toJson()}));else{e=r.map(k.getSelectedFeatures(),function(a){return a.attributes[k.objectIdField]});if(0===e.length||!k._params.drawMode)break;n.mixin(d.layerDefinition,{objectIds:e});e=null;k.getSelectionSymbol()&&(e=new B(k.getSelectionSymbol()));n.mixin(d.layerDefinition.drawingInfo,
{renderer:e&&e.toJson()})}else d=this._createFeatureCollection(k,a);else d=e&&(this._isFeatureCollectionRequired(e)||"esri.renderer.DotDensityRenderer"===e.declaredClass)?this._createFeatureCollection(k,a,e):this._createFeatureCollection(k,a);l.push(d);this.allLayerslegend&&this.allLayerslegend.push({id:k.id});break;case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":d=this._createFeatureCollection(k,a),l.push(d),this.allLayerslegend&&this.allLayerslegend.push({id:k.id})}a.graphics&&0<a.graphics.graphics.length&&
(d=this._createFeatureCollection(a.graphics,a),l.push(d));a._labels&&b.showLabels&&(d=this._createFeatureCollection(a._labels,a),l.push(d));r.forEach(l,function(a,s,m){a._isRefLayer&&(delete a._isRefLayer,m.splice(s,1),m.push(a))});return l},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var b=this._colorEvaluator(a),b=r.filter(b,function(a){return n.isArray(a)&&4===a.length}),c=!0;if(b.length){var d=b[0][3],f;for(f=1;f<b.length;f++)if(d!==
b[f][3]){c=!1;break}if(c){a.opacity=d/255;for(f=0;f<b.length;f++)b[f][3]=255}}return c},_isFeatureCollectionRequired:function(a){return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||a.hasVisualVariables("opacityInfo")},_getVariable:function(a,b,c){var d;a&&(d=(a=a.getVisualVariablesForType(b,c))&&a[0]);return d},_applyVisualVariables:function(a,b){var c=b.renderer,k=b.graphic,f=b.symbol,g=b.mapResolution,e=b.mapScale,l=f.type;if(!("textsymbol"===l||"shieldlabelsymbol"===l)){var q=
this._getVariable(c,"sizeInfo",!1),s=this._getVariable(c,"colorInfo",!1),w=this._getVariable(c,"opacityInfo",!1);f instanceof x&&(q=this._getVariable(c,"sizeInfo","outline")||q);q&&(f=c.getSize(k,{sizeInfo:q,shape:"simplemarkersymbol"===l?f.style:null,resolution:g,scale:e}),null!=f&&("simplemarkersymbol"===l?a.size=C.px2pt(f):"picturemarkersymbol"===l?(a.width=C.px2pt(f),a.height=C.px2pt(f)):"simplelinesymbol"===l?a.width=C.px2pt(f):a.outline&&(a.outline.width=C.px2pt(f))));if(s&&(s=c.getColor(k,
{colorInfo:s}))&&("simplemarkersymbol"===l||"simplelinesymbol"===l||"simplefillsymbol"===l))a.color=d.toJsonColor(s);w&&(c=c.getOpacity(k,{opacityInfo:w}),null!=c&&a.color&&(a.color[3]=Math.round(255*c)))}}})})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(h,n,r,t,v,e,l,g,c,b,d,q,f,a,B,z,x,u,E,y,D,C,F){h=h(q,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=n.hitch(this,this._jobUpdateHandler);this._getJobStatus=n.hitch(this,this._getJobStatus);this._getResultDataHandler=
n.hitch(this,this._getResultDataHandler);this._getResultImageHandler=n.hitch(this,this._getResultImageHandler);this._executeHandler=n.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,b,c){for(var d in a){var f=a[d];n.isArray(f)?a[d]=v.toJson(r.map(f,function(a){return this._gpEncode({item:a},!0).item},this)):f instanceof Date&&(a[d]=f.getTime())}return this._encode(a,b,c)},_decode:function(a){var b=a.dataType,
c=new y(a);if(-1!==r.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],b))return c;if("GPLinearUnit"===b)c.value=new z(c.value);else if("GPFeatureRecordSetLayer"===b||"GPRecordSet"===b)c.value=new f(c.value);else if("GPDataFile"===b)c.value=new x(c.value);else if("GPDate"===b)a=c.value,n.isString(a)?c.value=new E({date:a}):c.value=new Date(a);else if("GPRasterData"===b||"GPRasterDataLayer"===b)a=a.value.mapImage,c.value=a?new F(a):new u(c.value);else if(-1!==b.indexOf("GPMultiValue:")){var d=b.split(":")[1];
a=c.value;c.value=r.map(a,function(a){return this._decode({paramName:"_name",dataType:d,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+c.dataType),c=null;return c},submitJob:function(a,b,d,f,k){var g=this._getOutSR(),e=k.assembly;a=this._gpEncode(n.mixin({},this._url.query,{f:"json","env:outSR":g?g.wkid||v.toJson(g.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||v.toJson(this.processSpatialReference.toJson()):
null},a),null,e&&e[0]);var l=this._jobUpdateHandler,q=this._errorHandler;return c({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,s){l(a,s,!1,b,d,k.dfd)},error:function(a){q(a,f,k.dfd)}})},_jobUpdateHandler:function(b,c,d,f,k,g){var e=b.jobId;c=new a(b);this._successHandler([c],"onStatusUpdate",k,d&&g);if(!d)switch(clearTimeout(this._updateTimers[e]),this._updateTimers[e]=null,g&&g.progress(c),b.jobStatus){case a.STATUS_SUBMITTED:case a.STATUS_EXECUTING:case a.STATUS_WAITING:case a.STATUS_NEW:var l=
this._getJobStatus;this._updateTimers[e]=setTimeout(function(){l(e,d,f,k,g)},this.updateDelay);break;default:this._successHandler([c],"onJobComplete",f,g)}},_getJobStatus:function(a,b,d,f,g){var e=this._jobUpdateHandler;c({url:this._url.path+"/jobs/"+a,content:n.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,c){e(a,c,b,d,f,g)},error:this._errorHandler})},_getResultDataHandler:function(a,b,c,d,f){try{var g=this._decode(a);this._successHandler([g],"onGetResultDataComplete",
c,f)}catch(e){this._errorHandler(e,d,f)}},getResultData:function(a,d,f,g){var e=this._getResultDataHandler,l=this._errorHandler,q=new t(b._dfdCanceller);q._pendingDfd=c({url:this._url.path+"/jobs/"+a+"/results/"+d,content:n.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){e(a,b,f,g,q)},error:function(a){l(a,g,q)}});return q},checkJobStatus:function(a,d,f){var g=this._jobUpdateHandler,e=this._errorHandler,l=new t(b._dfdCanceller);l._pendingDfd=
c({url:this._url.path+"/jobs/"+a,content:n.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,b){g(a,b,!0,null,d,l)},error:function(a){e(a,f,l)}});return l},cancelJob:function(a,d,f){var g=this._errorHandler,e=new t(b._dfdCanceller);e._pendingDfd=c({url:this._url.path+"/jobs/"+a+"/cancel",content:n.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:n.hitch(this,function(a,b){this._successHandler([a],"onJobCancel",d,e)}),error:function(a){g(a,f,e)}});
return e},execute:function(a,b,d,f){var g=this._getOutSR(),e=f.assembly;a=this._gpEncode(n.mixin({},this._url.query,{f:"json","env:outSR":g?g.wkid||v.toJson(g.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||v.toJson(this.processSpatialReference.toJson()):null},a),null,e&&e[0]);var l=this._executeHandler,q=this._errorHandler;return c({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,c){l(a,c,b,d,f.dfd)},error:function(a){q(a,
d,f.dfd)}})},_executeHandler:function(a,b,c,d,f){try{var g=a.results,e,l,q=a.messages;e=0;for(l=g.length;e<l;e++)g[e]=this._decode(g[e]);e=0;for(l=q.length;e<l;e++)q[e]=new B(q[e]);this._successHandler([g,q],"onExecuteComplete",c,f)}catch(h){this._errorHandler(h,d,f)}},_getResultImageHandler:function(a,b,c,d,f){try{var g=this._decode(a);this._successHandler([g],"onGetResultImageComplete",c,f)}catch(e){this._errorHandler(e,d,f)}},getResultImage:function(a,d,f,g,e){var l=this._getResultImageHandler,
q=this._errorHandler;f=this._gpEncode(n.mixin({},this._url.query,{f:"json"},f.toJson()));var h=new t(b._dfdCanceller);h._pendingDfd=c({url:this._url.path+"/jobs/"+a+"/results/"+d,content:f,callbackParamName:"callback",load:function(a,b){l(a,b,g,e,h)},error:function(a){q(a,e,h)}});return h},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,c,d){if(null==b){var f=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
f)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+b;this._url.query&&(a+="?"+l.objectToQuery(this._url.query));b=null==b?new C(a,{imageParameters:c}):new D(a,{imageParameters:c},!0);this.onGetResultImageLayerComplete(b);d&&d(b);return b},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});d._createWrappers(h);
return h})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(h,n,r,t,v){h=h(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(e){this.messages=[];n.mixin(this,e);e=this.messages;var l,g=e.length;for(l=0;l<g;l++)e[l]=new v(e[l])},jobId:"",jobStatus:""});n.mixin(h,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",
STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});return h})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){h=h(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(h){n.mixin(this,h)}});n.mixin(h,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",
TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});return h})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){return h(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(h){h&&n.mixin(this,h)},distance:0,units:null,
toJson:function(){var h={};this.distance&&(h.distance=this.distance);this.units&&(h.units=this.units);return h}})})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){return h(null,{declaredClass:"esri.tasks.DataFile",constructor:function(h){h&&n.mixin(this,h)},url:null,itemID:null,toJson:function(){var h={};this.url&&(h.url=this.url);this.itemID&&(h.itemID=this.itemID);return h}})})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){return h(null,{declaredClass:"esri.tasks.RasterData",constructor:function(h){h&&n.mixin(this,h)},url:null,format:null,itemID:null,toJson:function(){var h={};this.url&&(h.url=this.url);this.format&&(h.format=this.format);this.itemID&&(h.itemID=this.itemID);return h}})})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(h,n,r,t,v){return h(null,{declaredClass:"esri.tasks.Date",
constructor:function(e){e&&(e.format&&(this.format=e.format),this.date=r.parse(e.date,{selector:"date",datePattern:this.format}))},date:new Date,format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:r.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}})})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){return h(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(h){n.mixin(this,
h)}})})},"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(h,n,r,t,v,e,l){return h(l,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(e,c){c&&(c.imageParameters&&c.imageParameters.extent)&&(this.initialExtent=this.fullExtent=c.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=n.hitch(this,
this.getImageUrl);this.loaded=!0;this.onLoad(this)},getImageUrl:function(e,c,b,d){var l=e.spatialReference.wkid;d(this._url.path+"?"+v.objectToQuery(n.mixin(this._params,{f:"image",bbox:r.toJson(e.toJson()),bboxSR:l,imageSR:l,size:c+","+b})))}})})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){return h(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,
format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null,showLabels:!0})})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(h,n,r,t,v,e,l,g,c,b,d,q,f){function a(a,b,m,c,d,f,e,g,l,k){var q,h,B=b.length,z=0;k?(h=k.l/d,z=k.i):h=b[0]/d;for(;f<e;)f+h>e&&(q={l:(f+h-e)*d,i:z},h=e-f),z%2||(a.beginPath(),a.arc(m,
c,d,f,f+h,g),l&&a.stroke()),f+=h,++z,h=b[z%B]/d;return q}function B(a,b,m,c){var d=0,e=0,g,l=0;c?(g=c.l,l=c.i):g=b[0];for(;1>e;)e=f.tAtLength(a,g),1==e&&(d=f.computeLength(a),d={l:g-d,i:l}),a=f.splitBezierAtT(a,e),l%2||m.push(a[0]),a=a[1],++l,g=b[l%b.length];return d}function z(a,b,m,c){var d=[b.last.x,b.last.y].concat(m),f=!(a instanceof Array);m=4===m.length?"quadraticCurveTo":"bezierCurveTo";var e=[];b=B(d,b.canvasDash,e,c);for(c=0;c<e.length;++c)d=e[c],f?(a.moveTo(d[0],d[1]),a[m].apply(a,d.slice(2))):
(a.push("moveTo",[d[0],d[1]]),a.push(m,d.slice(2)));return b}function x(a,b,m,c,d,e,g){var l=0,k=0,q=0,h=f.distance(m,c,d,e),B=0;b=b.canvasDash;var z=m,r=c,n,u=!(a instanceof Array);g?(q=g.l,B=g.i):q+=b[0];for(;0.01<Math.abs(1-k);)q>h&&(l={l:q-h,i:B},q=h),k=q/h,g=m+(d-m)*k,n=c+(e-c)*k,B++%2||(u?(a.moveTo(z,r),a.lineTo(g,n)):(a.push("moveTo",[z,r]),a.push("lineTo",[g,n]))),z=g,r=n,q+=b[B%b.length];return l}var u=h.canvas={},E=null,y=d.multiplyPoint,D=Math.PI,C=2*D,F=D/2;q=n.extend;if(v.global.CanvasRenderingContext2D){v=
v.doc.createElement("canvas").getContext("2d");var H="function"==typeof v.setLineDash,G="function"==typeof v.fillText}var L={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};u.Shape=t("dojox.gfx.canvas.Shape",g.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,
!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var b=this.canvasTransform;a.translate(b.dx,b.dy);a.rotate(b.angle2);a.scale(b.sx,b.sy);a.rotate(b.angle1)}},_renderShape:function(a){},_renderFill:function(a,b){if("canvasFill"in this){var m=this.fillStyle;if("canvasFillImage"in this){var c=m.width,d=m.height,f=this.canvasFillImage.width,e=this.canvasFillImage.height,g=Math.min(c==f?1:c/f,d==e?
1:d/e),l=(c-g*f)/2,k=(d-g*e)/2;E.width=c;E.height=d;var q=E.getContext("2d");q.clearRect(0,0,c,d);q.drawImage(this.canvasFillImage,0,0,f,e,l,k,g*f,g*e);this.canvasFill=a.createPattern(E,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;b&&("pattern"===m.type&&(0!==m.x||0!==m.y)&&a.translate(m.x,m.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,b){var m=this.strokeStyle;m?(a.strokeStyle=m.color.toString(),a.lineWidth=m.width,a.lineCap=m.cap,"number"==typeof m.join?
(a.lineJoin="miter",a.miterLimit=m.join):a.lineJoin=m.join,this.canvasDash?H?(a.setLineDash(this.canvasDash),b&&a.stroke()):this._renderDashedStroke(a,b):b&&a.stroke()):b||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,b){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&
!b)return this;this.canvasClip=a?M(b,a):null;this.parent&&this.parent._makeDirty();return this}});var M=function(a,b){switch(a){case "ellipse":return{canvasEllipse:N({shape:b}),render:function(a){return u.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:n.delegate(b,{r:0}),render:function(a){return u.Rect.prototype._renderShape.call(this,a)}};case "path":return{canvasPath:k(b),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:b.points,
render:function(a){return u.Polyline.prototype._renderShape.call(this,a)}}}return null},k=function(a){var b=new dojox.gfx.canvas.Path;b.canvasPath=[];b._setPath(a.d);return b},I=function(a,b,m){var c=a.prototype[b];a.prototype[b]=m?function(){this.parent&&this.parent._makeDirty();c.apply(this,arguments);m.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return c.apply(this,arguments)}};I(u.Shape,"setTransform",function(){this.matrix?this.canvasTransform=h.decompose(this.matrix):
delete this.canvasTransform});I(u.Shape,"setFill",function(){var a=this.fillStyle,b;if(a){if("object"==typeof a&&"type"in a){var m=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":b="linear"==a.type?m.createLinearGradient(a.x1,a.y1,a.x2,a.y2):m.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);r.forEach(a.colors,function(a){b.addColorStop(a.offset,h.normalizeColor(a.color).toString())});break;case "pattern":E||(E=document.createElement("canvas")),m=new Image,this.surface.downloadImage(m,
a.src),this.canvasFillImage=m}}else b=a.toString();this.canvasFill=b}else delete this.canvasFill});I(u.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var b=this.strokeStyle.style.toLowerCase();b in L&&(b=L[b]);if(b instanceof Array){this.canvasDash=b=b.slice();var m;for(m=0;m<b.length;++m)b[m]*=a.width;if("butt"!=a.cap){for(m=0;m<b.length;m+=2)b[m]-=a.width,1>b[m]&&(b[m]=1);for(m=1;m<b.length;m+=2)b[m]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!H&&
!!this.canvasDash});I(u.Shape,"setShape");u.Group=t("dojox.gfx.canvas.Group",u.Shape,{constructor:function(){g.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},destroy:function(){g.Container.clear.call(this,!0);u.Shape.prototype.destroy.apply(this,arguments)}});u.Rect=t("dojox.gfx.canvas.Rect",[u.Shape,g.Rect],{_renderShape:function(a){var b=this.shape,m=Math.min(b.r,
b.height/2,b.width/2),c=b.x,d=c+b.width,f=b.y,b=f+b.height,e=c+m,g=d-m,l=f+m,k=b-m;a.beginPath();a.moveTo(e,f);m?(a.arc(g,l,m,-F,0,!1),a.arc(g,k,m,0,F,!1),a.arc(e,k,m,F,D,!1),a.arc(e,l,m,D,D+F,!1)):(a.lineTo(g,f),a.lineTo(d,k),a.lineTo(e,b),a.lineTo(c,l));a.closePath()},_renderDashedStroke:function(b,c){var m=this.shape,d=Math.min(m.r,m.height/2,m.width/2),f=m.x,e=f+m.width,g=m.y,l=g+m.height,k=f+d,q=e-d,h=g+d,B=l-d;d?(b.beginPath(),m=x(b,this,k,g,q,g),c&&b.stroke(),m=a(b,this.canvasDash,q,h,d,-F,
0,!1,c,m),b.beginPath(),m=x(b,this,e,h,e,B,m),c&&b.stroke(),m=a(b,this.canvasDash,q,B,d,0,F,!1,c,m),b.beginPath(),m=x(b,this,q,l,k,l,m),c&&b.stroke(),m=a(b,this.canvasDash,k,B,d,F,D,!1,c,m),b.beginPath(),m=x(b,this,f,B,f,h,m),c&&b.stroke(),a(b,this.canvasDash,k,h,d,D,D+F,!1,c,m)):(b.beginPath(),m=x(b,this,k,g,q,g),m=x(b,this,q,g,e,B,m),m=x(b,this,e,B,k,l,m),x(b,this,k,l,f,h,m),c&&b.stroke())}});var J=[];(function(){var a=b.curvePI4;J.push(a.s,a.c1,a.c2,a.e);for(var c=45;360>c;c+=45){var m=d.rotateg(c);
J.push(y(m,a.c1),y(m,a.c2),y(m,a.e))}})();var N=function(a){var b,m,c,f=[],e=a.shape,g=d.normalize([d.translate(e.cx,e.cy),d.scale(e.rx,e.ry)]);b=y(g,J[0]);f.push([b.x,b.y]);for(e=1;e<J.length;e+=3)m=y(g,J[e]),c=y(g,J[e+1]),b=y(g,J[e+2]),f.push([m.x,m.y,c.x,c.y,b.x,b.y]);if(a._needsDash){b=[];m=f[0];for(e=1;e<f.length;++e)c=[],B(m.concat(f[e]),a.canvasDash,c),m=[f[e][4],f[e][5]],b.push(c);a._dashedPoints=b}return f};u.Ellipse=t("dojox.gfx.canvas.Ellipse",[u.Shape,g.Ellipse],{setShape:function(){this.inherited(arguments);
this.canvasEllipse=N(this);return this},setStroke:function(){this.inherited(arguments);H||(this.canvasEllipse=N(this));return this},_renderShape:function(a){var b=this.canvasEllipse,m;a.beginPath();a.moveTo.apply(a,b[0]);for(m=1;m<b.length;++m)a.bezierCurveTo.apply(a,b[m]);a.closePath()},_renderDashedStroke:function(a,b){var m=this._dashedPoints;a.beginPath();for(var c=0;c<m.length;++c)for(var d=m[c],f=0;f<d.length;++f){var e=d[f];a.moveTo(e[0],e[1]);a.bezierCurveTo(e[2],e[3],e[4],e[5],e[6],e[7])}b&&
a.stroke()}});u.Circle=t("dojox.gfx.canvas.Circle",[u.Shape,g.Circle],{_renderShape:function(a){var b=this.shape;a.beginPath();a.arc(b.cx,b.cy,b.r,0,C,1)},_renderDashedStroke:function(a,b){var m=this.shape,c=0,d,f=this.canvasDash.length;for(i=0;c<C;)d=this.canvasDash[i%f]/m.r,i%2||(a.beginPath(),a.arc(m.cx,m.cy,m.r,c,c+d,0),b&&a.stroke()),c+=d,++i}});u.Line=t("dojox.gfx.canvas.Line",[u.Shape,g.Line],{_renderShape:function(a){var b=this.shape;a.beginPath();a.moveTo(b.x1,b.y1);a.lineTo(b.x2,b.y2)},
_renderDashedStroke:function(a,b){var c=this.shape;a.beginPath();x(a,this,c.x1,c.y1,c.x2,c.y2);b&&a.stroke()}});u.Polyline=t("dojox.gfx.canvas.Polyline",[u.Shape,g.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,b=a[0],c,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof b)b=a;else{b=[];for(d=0;d<a.length;++d)c=a[d],b.push(c.x,c.y)}else b=[];this.canvasPolyline=b;return this},_renderShape:function(a){var b=this.canvasPolyline;if(b.length){a.beginPath();
a.moveTo(b[0],b[1]);for(var c=2;c<b.length;c+=2)a.lineTo(b[c],b[c+1])}},_renderDashedStroke:function(a,b){var c=this.canvasPolyline,d=0;a.beginPath();for(var f=0;f<c.length;f+=2)d=x(a,this,c[f],c[f+1],c[f+2],c[f+3],d);b&&a.stroke()}});u.Image=t("dojox.gfx.canvas.Image",[u.Shape,g.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var b=this.shape;a.drawImage(this.canvasImage,b.x,
b.y,b.width,b.height)}});u.Text=t("dojox.gfx.canvas.Text",[u.Shape,g.Text],{_setFont:function(){this.fontStyle?this.canvasFont=h.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,b=0,c;a.text&&(c=this.surface.rawNode.getContext("2d"),c.save(),this._renderTransform(c),this._renderFill(c,!1),this._renderStroke(c,!1),this.canvasFont&&(c.font=this.canvasFont),b=c.measureText(a.text).width,c.restore());return b},_render:function(a){a.save();this._renderTransform(a);
this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var b,c=this.shape;c.text&&(b="middle"===c.align?"center":c.align,a.textAlign=b,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(c.text,c.x,c.y),this.strokeStyle&&(a.beginPath(),a.strokeText(c.text,c.x,c.y),a.closePath()))}});I(u.Text,"setFont");G||u.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var O={M:"_moveToA",
m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};u.Path=t("dojox.gfx.canvas.Path",[u.Shape,c.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);
H||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var b=n.clone(this.last);this[O[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=b;this.inherited(arguments)},_renderShape:function(a){var b=this.canvasPath;a.beginPath();for(var c=0;c<b.length;c+=2)a[b[c]].apply(a,b[c+1])},_renderDashedStroke:H?function(){}:function(a,b){var c=this._dashedPath;
a.beginPath();for(var d=0;d<c.length;d+=2)a[c[d]].apply(a,c[d+1]);b&&a.stroke()},_moveToA:function(a,b,c,d){a.push("moveTo",[c[0],c[1]]);d&&d.push("moveTo",[c[0],c[1]]);for(b=2;b<c.length;b+=2)a.push("lineTo",[c[b],c[b+1]]),d&&(this._dashResidue=x(d,this,c[b-2],c[b-1],c[b],c[b+1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_moveToR:function(a,b,c,d){b="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];a.push("moveTo",
b);d&&d.push("moveTo",b);for(b=2;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=x(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,c,d){for(b=0;b<c.length;b+=2)d&&(this._dashResidue=x(d,this,this.last.x,this.last.y,c[b],c[b+1],this._dashResidue)),a.push("lineTo",[c[b],c[b+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(a,b,c,
d){for(b=0;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=x(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[c[b],this.last.y]),d&&(this._dashResidue=x(d,this,d[d.length-1][0],d[d.length-1][1],c[b],this.last.y,this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",
[this.last.x+=c[b],this.last.y]),d&&(this._dashResidue=x(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,c[b]]),d&&(this._dashResidue=x(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[b],this._dashResidue));this.last.y=c[c.length-1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&
(this._dashResidue=x(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",
[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var f="C"==this.lastControl.type;a.push("bezierCurveTo",[f?2*this.last.x-this.lastControl.x:this.last.x,f?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+
1],c[b+2],c[b+3]]);d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var f="C"==this.lastControl.type;a.push("bezierCurveTo",[f?2*this.last.x-this.lastControl.x:this.last.x,f?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&
(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type=
"Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]),d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var f="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:
this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var f="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],
this.last.y+c[b+1]]);d&&(this._dashResidue=z(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(a,c,d,f){c="a"==c;for(var e=0;e<d.length;e+=7){var g=d[e+5],l=d[e+6];c&&(g+=this.last.x,l+=this.last.y);var k=b.arcAsBezier(this.last,d[e],d[e+1],d[e+2],d[e+3]?1:0,d[e+4]?1:0,g,l);r.forEach(k,function(b){a.push("bezierCurveTo",b)});f&&(this._dashResidue=z(f,this,p,this._dashResidue));this.last.x=g;this.last.y=l}this.lastControl={}},
_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=x(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});r.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){I(u.Path,a)});u.TextPath=t("dojox.gfx.canvas.TextPath",[u.Shape,c.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});u.Surface=t("dojox.gfx.canvas.Surface",g.Surface,{constructor:function(){g.Container._init.call(this);
this.pendingImageCount=0;this.makeDirty()},destroy:function(){g.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=h.normalizedLength(a);this.height=h.normalizedLength(b);if(!this.rawNode)return this;var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:
null},_render:function(a){if(this.rawNode&&(a||!this.pendingImageCount))a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender)},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){!this.pendingImagesCount&&(!("pendingRender"in this)&&!this._batch)&&(this.pendingRender=setTimeout(n.hitch(this,
this._render),0))},downloadImage:function(a,b){var c=n.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});u.createSurface=function(a,b,c){if(!b&&!c){var d=
e.position(a);b=b||d.w;c=c||d.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");d=new u.Surface;a=l.byId(a);var f=a.ownerDocument.createElement("canvas");f.width=h.normalizedLength(b);f.height=h.normalizedLength(c);a.appendChild(f);d.rawNode=f;d._parent=a;return d.surface=d};var K=g.Container;t={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},
add:function(a){this._makeDirty();return K.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return K.remove.apply(this,arguments)},clear:function(){this._makeDirty();return K.clear.apply(this,arguments)},getBoundingBox:K.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return K._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return K._moveChildToBack.apply(this,arguments)}};c={createObject:function(a,b){var c=new a;c.surface=this.surface;
c.setShape(b);this.add(c);return c}};q(u.Group,t);q(u.Group,g.Creator);q(u.Group,c);q(u.Surface,t);q(u.Surface,g.Creator);q(u.Surface,c);u.fixTarget=function(a,b){return!0};return u})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(h,n,r,t,v,e,l,g,c,b){function d(a,b){if(!q)return a.splice(b,1);var c=a.length;if(c){for(;b<c;)a[b]=a[b+1],b++;
a.length--}}var q=!!v("chrome"),f=h.shape={};f.Shape=r("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(v("gfxRegistry")){var a=f.register(this);this.getUID=function(){return a}}},destroy:function(){v("gfxRegistry")&&f.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},
getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var c=this._getRealMatrix();return[b.multiplyPoint(c,a.x,a.y),b.multiplyPoint(c,a.x+a.width,a.y),b.multiplyPoint(c,a.x+a.width,a.y+a.height),b.multiplyPoint(c,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},
setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=h.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=h.makeParameters(h.defaultLinearGradient,a);break;case "radial":b=h.makeParameters(h.defaultRadialGradient,a);break;case "pattern":b=h.makeParameters(h.defaultPattern,a)}else b=h.normalizeColor(a);this.fillStyle=
b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||n.isArray(a)||a instanceof c)a={color:a};a=this.strokeStyle=h.makeParameters(h.defaultStroke,a);a.color=h.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=
this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},
_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,c=this.parent;c;)c.matrix&&(a=b.multiply(c.matrix,a)),c=c.parent;return a}});f._eventsProcessing={on:function(a,b){return e(this.getEventSource(),a,f.fixCallback(this,h.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?n.hitch(b,c):b)},disconnect:function(a){return a.remove()}};f.fixCallback=function(a,
b,c,d){d||(d=c,c=null);if(n.isString(d)){c=c||t.global;if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',c,'")'].join("");return function(f){return b(f,a)?c[d].apply(c,arguments||[]):void 0}}return!c?function(f){return b(f,a)?d.apply(c,arguments):void 0}:function(f){return b(f,a)?d.apply(c,arguments||[]):void 0}};n.extend(f.Shape,f._eventsProcessing);f.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},
add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);d(this.children,c);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;l.forEach(this.children,
function(c){var d=c.getBoundingBox();d&&((c=c.getTransform())&&(d=b.multiplyRectangle(c,d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){d(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=
0;b<this.children.length;++b)if(this.children[b]==a){d(this.children,b);this.children.unshift(a);break}return this}};f.Surface=r("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){l.forEach(this._nodes,g.destroy);this._nodes=[];l.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(v("ie"))for(;this._parent.lastChild;)g.destroy(this._parent.lastChild);else this._parent.innerHTML=
"";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var c=n.hitch(a,b);if(this.isLoaded)c(this);else e.once(this,"load",function(a){c(a)})}});n.extend(f.Surface,f._eventsProcessing);f.Rect=r("dojox.gfx.shape.Rect",f.Shape,{constructor:function(a){this.shape=h.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});f.Ellipse=r("dojox.gfx.shape.Ellipse",f.Shape,
{constructor:function(a){this.shape=h.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});f.Circle=r("dojox.gfx.shape.Circle",f.Shape,{constructor:function(a){this.shape=h.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});f.Line=r("dojox.gfx.shape.Line",
f.Shape,{constructor:function(a){this.shape=h.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});f.Polyline=r("dojox.gfx.shape.Polyline",f.Shape,{constructor:function(a){this.shape=h.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&
this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,f=c.y,e=c.x,g=c.y,l=1;l<b;++l)c=a[l],d>c.x&&(d=c.x),e<c.x&&(e=c.x),f>c.y&&(f=c.y),g<c.y&&(g=c.y);this.bbox={x:d,y:f,width:e-
d,height:g-f}}return this.bbox}});f.Image=r("dojox.gfx.shape.Image",f.Shape,{constructor:function(a){this.shape=h.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});f.Text=r(f.Shape,{constructor:function(a){this.fontStyle=null;this.shape=h.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,
a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=h._base._computeTextBoundingBox(this));return a}});f.Creator={createShape:function(a){switch(a.type){case h.defaultPath.type:return this.createPath(a);case h.defaultRect.type:return this.createRect(a);case h.defaultCircle.type:return this.createCircle(a);case h.defaultEllipse.type:return this.createEllipse(a);case h.defaultLine.type:return this.createLine(a);case h.defaultPolyline.type:return this.createPolyline(a);
case h.defaultImage.type:return this.createImage(a);case h.defaultText.type:return this.createText(a);case h.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(h.Group)},createRect:function(a){return this.createObject(h.Rect,a)},createEllipse:function(a){return this.createObject(h.Ellipse,a)},createCircle:function(a){return this.createObject(h.Circle,a)},createLine:function(a){return this.createObject(h.Line,a)},createPolyline:function(a){return this.createObject(h.Polyline,
a)},createImage:function(a){return this.createObject(h.Image,a)},createText:function(a){return this.createObject(h.Text,a)},createPath:function(a){return this.createObject(h.Path,a)},createTextPath:function(a){return this.createObject(h.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return f})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(h,n,r,t,v){v=r("dojox.gfx.path.Path",v.Shape,{constructor:function(e){this.shape=
n.clone(h.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=e;this.segmented=!1},setAbsoluteMode:function(e){this._confirmSegmented();this.absolute="string"==typeof e?"absolute"==e:e;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();
if(this.tbbox)return this.tbbox;var e=this.bbox,l=this._getRealMatrix();this.bbox=null;for(var g=0,c=this.segments.length;g<c;++g)this._updateWithSegment(this.segments[g],l);l=this.bbox;this.bbox=e;return this.tbbox=l?[{x:l.l,y:l.t},{x:l.r,y:l.t},{x:l.r,y:l.b},{x:l.l,y:l.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(e,l,g){g&&(l=t.multiplyPoint(g,
e,l),e=l.x,l=l.y);this.bbox&&"l"in this.bbox?(this.bbox.l>e&&(this.bbox.l=e),this.bbox.r<e&&(this.bbox.r=e),this.bbox.t>l&&(this.bbox.t=l),this.bbox.b<l&&(this.bbox.b=l)):this.bbox={l:e,b:l,r:e,t:l}},_updateWithSegment:function(e,l){var g=e.args,c=g.length,b;switch(e.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<c;b+=2)this._updateBBox(g[b],g[b+1],l);this.last.x=g[c-2];this.last.y=g[c-1];this.absolute=!0;break;case "H":for(b=0;b<c;++b)this._updateBBox(g[b],this.last.y,l);
this.last.x=g[c-1];this.absolute=!0;break;case "V":for(b=0;b<c;++b)this._updateBBox(this.last.x,g[b],l);this.last.y=g[c-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=g[0],this.last.y=g[1],l),b=2);for(;b<c;b+=2)this._updateBBox(this.last.x+=g[b],this.last.y+=g[b+1],l);this.absolute=!1;break;case "l":case "t":for(b=0;b<c;b+=2)this._updateBBox(this.last.x+=g[b],this.last.y+=g[b+1],l);this.absolute=!1;break;case "h":for(b=0;b<c;++b)this._updateBBox(this.last.x+=
g[b],this.last.y,l);this.absolute=!1;break;case "v":for(b=0;b<c;++b)this._updateBBox(this.last.x,this.last.y+=g[b],l);this.absolute=!1;break;case "c":for(b=0;b<c;b+=6)this._updateBBox(this.last.x+g[b],this.last.y+g[b+1],l),this._updateBBox(this.last.x+g[b+2],this.last.y+g[b+3],l),this._updateBBox(this.last.x+=g[b+4],this.last.y+=g[b+5],l);this.absolute=!1;break;case "s":case "q":for(b=0;b<c;b+=4)this._updateBBox(this.last.x+g[b],this.last.y+g[b+1],l),this._updateBBox(this.last.x+=g[b+2],this.last.y+=
g[b+3],l);this.absolute=!1;break;case "A":for(b=0;b<c;b+=7)this._updateBBox(g[b+5],g[b+6],l);this.last.x=g[c-2];this.last.y=g[c-1];this.absolute=!0;break;case "a":for(b=0;b<c;b+=7)this._updateBBox(this.last.x+=g[b+5],this.last.y+=g[b+6],l);this.absolute=!1}var d=[e.action];for(b=0;b<c;++b)d.push(h.formatNumber(g[b],!0));if("string"==typeof this.shape.path)this.shape.path+=d.join("");else{b=0;for(c=d.length;b<c;++b)this.shape.path.push(d[b])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},
_pushSegment:function(e,l){this.tbbox=null;var g=this._validSegments[e.toLowerCase()];"number"==typeof g&&(g?l.length>=g&&(g={action:e,args:l.slice(0,l.length-l.length%g)},this.segments.push(g),this._updateWithSegment(g)):(g={action:e,args:[]},this.segments.push(g),this._updateWithSegment(g)))},_collectArgs:function(e,l){for(var g=0;g<l.length;++g){var c=l[g];"boolean"==typeof c?e.push(c?1:0):"number"==typeof c?e.push(c):c instanceof Array?this._collectArgs(e,c):"x"in c&&"y"in c&&e.push(c.x,c.y)}},
moveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"M":"m",e);return this},lineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"L":"l",e);return this},hLineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"H":"h",e);return this},vLineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);
this._pushSegment(this.absolute?"V":"v",e);return this},curveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"C":"c",e);return this},smoothCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"S":"s",e);return this},qCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"Q":"q",e);return this},qSmoothCurveTo:function(){this._confirmSegmented();
var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"T":"t",e);return this},arcTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"A":"a",e);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var e=this.shape.path;this.shape.path=[];this._setPath(e);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(e){e=
n.isArray(e)?e:e.match(h.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(e){for(var l="",g=[],c=e.length,b=0;b<c;++b){var d=e[b],q=parseFloat(d);isNaN(q)?(l&&this._pushSegment(l,g),g=[],l=d):g.push(q)}this._pushSegment(l,g)}},setShape:function(e){this.inherited(arguments,["string"==typeof e?{path:e}:e]);this.segmented=!1;this.segments=[];h.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});r=r("dojox.gfx.path.TextPath",v,{constructor:function(e){"text"in
this||(this.text=n.clone(h.defaultTextPath));"fontStyle"in this||(this.fontStyle=n.clone(h.defaultFont))},getText:function(){return this.text},setText:function(e){this.text=h.makeParameters(this.text,"string"==typeof e?{text:e}:e);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(e){this.fontStyle="string"==typeof e?h.splitFontString(e):h.makeParameters(h.defaultFont,e);this._setFont();return this}});return h.path={Path:v,TextPath:r}})},"dojox/gfx/arc":function(){define(["./_base",
"dojo/_base/lang","./matrix"],function(h,n,r){function t(b){var c=Math.cos(b);b=Math.sin(b);var e={x:c+4/3*(1-c),y:b-4/3*c*(1-c)/b};return{s:{x:c,y:-b},c1:{x:e.x,y:-e.y},c2:e,e:{x:c,y:b}}}var v=2*Math.PI,e=Math.PI/4,l=Math.PI/8,g=e+l,c=t(l);return h.arc={unitArcAsBezier:t,curvePI4:c,arcAsBezier:function(b,d,q,f,a,h,n,x){a=Boolean(a);h=Boolean(h);var u=r._degToRad(f);f=d*d;var E=q*q,y=r.multiplyPoint(r.rotate(-u),{x:(b.x-n)/2,y:(b.y-x)/2}),D=y.x*y.x,C=y.y*y.y;f=Math.sqrt((f*E-f*C-E*D)/(f*C+E*D));isNaN(f)&&
(f=0);f={x:f*d*y.y/q,y:-f*q*y.x/d};a==h&&(f={x:-f.x,y:-f.y});f=r.multiplyPoint([r.translate((b.x+n)/2,(b.y+x)/2),r.rotate(u)],f);d=r.normalize([r.translate(f.x,f.y),r.rotate(u),r.scale(d,q)]);f=r.invert(d);b=r.multiplyPoint(f,b);x=r.multiplyPoint(f,n,x);n=Math.atan2(b.y,b.x);x=Math.atan2(x.y,x.x);f=n-x;h&&(f=-f);0>f?f+=v:f>v&&(f-=v);q=l;x=c;q=h?q:-q;b=[];for(a=f;0<a;a-=e)a<g&&(q=a/2,x=t(q),q=h?q:-q,a=0),y=r.normalize([d,r.rotate(n+q)]),h?(f=r.multiplyPoint(y,x.c1),u=r.multiplyPoint(y,x.c2),y=r.multiplyPoint(y,
x.e)):(f=r.multiplyPoint(y,x.c2),u=r.multiplyPoint(y,x.c1),y=r.multiplyPoint(y,x.s)),b.push([f.x,f.y,u.x,u.y,y.x,y.y]),n+=2*q;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(h,n,r){function t(c,b){return Math.abs(c-b)<=1E-6*(Math.abs(c)+Math.abs(b))}function v(c,b,d,e){if(isFinite(c)){if(!isFinite(d))return c}else return d;b=Math.abs(b);e=Math.abs(e);return(b*c+e*d)/(b+e)}function e(c){c=r.normalize(c);var b=-c.xx-c.yy,d=c.xx*c.yy-c.xy*c.yx,
e=Math.sqrt(b*b-4*d),b=-(b+(0>b?-e:e))/2,d=d/b,e=c.xy/(b-c.xx),f=1,a=c.xy/(d-c.xx),g=1;t(b,d)&&(e=1,a=f=0,g=1);isFinite(e)||(e=1,f=(b-c.xx)/c.xy,isFinite(f)||(e=(b-c.yy)/c.yx,f=1,isFinite(e)||(e=1,f=c.yx/(b-c.yy))));isFinite(a)||(a=1,g=(d-c.xx)/c.xy,isFinite(g)||(a=(d-c.yy)/c.yx,g=1,isFinite(a)||(a=1,g=c.yx/(d-c.yy))));c=Math.sqrt(e*e+f*f);var l=Math.sqrt(a*a+g*g);if(!isFinite(e/=c))e=0;if(!isFinite(f/=c))f=0;if(!isFinite(a/=l))a=0;if(!isFinite(g/=l))g=0;return{value1:b,value2:d,vector1:{x:e,y:f},
vector2:{x:a,y:g}}}function l(c,b){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,e=b.angle1=(Math.atan2(c.yx,c.yy)+Math.atan2(-d*c.xy,d*c.xx))/2,d=Math.cos(e),e=Math.sin(e);b.sx=v(c.xx/d,d,-c.xy/e,e);b.sy=v(c.yy/d,d,c.yx/e,e);return b}function g(c,b){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,e=b.angle2=(Math.atan2(d*c.yx,d*c.xx)+Math.atan2(-c.xy,c.yy))/2,d=Math.cos(e),e=Math.sin(e);b.sx=v(c.xx/d,d,c.yx/e,e);b.sy=v(c.yy/d,d,-c.xy/e,e);return b}return h.decompose=function(c){var b=r.normalize(c);c={dx:b.dx,dy:b.dy,
sx:1,sy:1,angle1:0,angle2:0};if(t(b.xy,0)&&t(b.yx,0))return n.mixin(c,{sx:b.xx,sy:b.yy});if(t(b.xx*b.yx,-b.xy*b.yy))return l(b,c);if(t(b.xx*b.xy,-b.yx*b.yy))return g(b,c);var d,h=new r.Matrix2D(b);d=n.mixin(h,{dx:0,dy:0,xy:h.yx,yx:h.xy});h=e([b,d]);d=e([d,b]);h=new r.Matrix2D({xx:h.vector1.x,xy:h.vector2.x,yx:h.vector1.y,yy:h.vector2.y});d=new r.Matrix2D({xx:d.vector1.x,xy:d.vector1.y,yx:d.vector2.x,yy:d.vector2.y});b=new r.Matrix2D([r.invert(h),b,r.invert(d)]);l(d,c);b.xx*=c.sx;b.yy*=c.sy;g(h,c);
b.xx*=c.sx;b.yy*=c.sy;return n.mixin(c,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(h){h=h.bezierutils={};h.tAtLength=function(l,g){var c=0,b=6==l.length,d=0,h=0,f=b?t:e,a=function(e,n){for(var t=0,u=0;u<e.length-2;u+=2)t+=r(e[u],e[u+1],e[u+2],e[u+3]);u=b?r(l[0],l[1],l[4],l[5]):r(l[0],l[1],l[6],l[7]);t-u>n||d+t>g+n?(++h,t=f(e,0.5),a(t[0],n),Math.abs(d-g)<=n||a(t[1],n)):(d+=t,c+=1/(1<<h))};g&&a(l,0.5);return c};var n=h.computeLength=function(e){for(var g=6==
e.length,c=0,b=0;b<e.length-2;b+=2)c+=r(e[b],e[b+1],e[b+2],e[b+3]);b=g?r(e[0],e[1],e[4],e[5]):r(e[0],e[1],e[6],e[7]);0.1<c-b&&(e=g?t(e,0.5):v(e,0.5),c=n(e[0],g),c+=n(e[1],g));return c},r=h.distance=function(e,g,c,b){return Math.sqrt((c-e)*(c-e)+(b-g)*(b-g))},t=function(e,g){var c=1-g,b=c*c,d=g*g,h=e[0],f=e[1],a=e[2],n=e[3],r=e[4],t=e[5],u=b*h+2*c*g*a+d*r,b=b*f+2*c*g*n+d*t;return[[h,f,c*h+g*a,c*f+g*n,u,b],[u,b,c*a+g*r,c*n+g*t,r,t]]},v=function(e,g){var c=1-g,b=c*c,d=b*c,h=g*g,f=h*g,a=e[0],n=e[1],r=
e[2],t=e[3],u=e[4],v=e[5],y=e[6],D=e[7],C=d*a+3*b*g*r+3*c*h*u+f*y,d=d*n+3*b*g*t+3*c*h*v+f*D;return[[a,n,c*a+g*r,c*n+g*t,b*a+2*c*g*r+h*u,b*n+2*c*g*t+h*v,C,d],[C,d,b*r+2*c*g*u+h*y,b*t+2*c*g*v+h*D,c*u+g*y,c*v+g*D,y,D]]},e=h.splitBezierAtT=function(e,g){return 6==e.length?t(e,g):v(e,g)};return h})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(h,n,r){n.getObject("json",!0,r);r.json._slice=function(h,n,e,l){var g=h.length,c=[];e=e||g;n=
0>n?Math.max(0,n+g):Math.min(g,n);for(e=0>e?Math.max(0,e+g):Math.min(g,e);n<e;n+=l)c.push(h[n]);return c};r.json._find=function(h,n){function e(c){n&&(!0===n&&!(c instanceof Array)?l.push(c):c[n]&&l.push(c[n]));for(var b in c){var d=c[b];n?d&&"object"==typeof d&&e(d):l.push(d)}}var l=[];if(n instanceof Array){if(1==n.length)return h[n[0]];for(var g=0;g<n.length;g++)l.push(h[n[g]])}else e(h);return l};r.json._distinctFilter=function(h,n){for(var e=[],l={},g=0,c=h.length;g<c;++g){var b=h[g];n(b,g,h)&&
("object"==typeof b&&b?b.__included||(b.__included=!0,e.push(b)):l[b+typeof b]||(l[b+typeof b]=!0,e.push(b)))}g=0;for(c=e.length;g<c;++g)e[g]&&delete e[g].__included;return e};return r.json.query=function(h,n){function e(c){b=c+"("+b}function l(b,a,d,e,g,h,l,n){return c[n].match(/[\*\?]/)||"~"==l?"/^"+c[n].substring(1,c[n].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==l?"$/i":"$/")+".test("+a+")":b}var g=0,c=[];h=h.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,
function(b){g+="["==b?1:"]"==b?-1:0;return"]"==b&&0<g?"`]":'"'==b.charAt(0)||"'"==b.charAt(0)?"`"+(c.push(b)-1):b});var b="";h.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});h=h.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(b){return"."==b.charAt(0)?b:"@"==b?"$obj":(b.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+b}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(b,a,c){return(a=
b.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(c="",b.match(/^\./)&&(e("dojox.json._find"),c=",true)"),e(a[1].match(/\=/)?"dojo.map":a[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter"),c+",function($obj){return "+a[2]+"})"):(a=b.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+a[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+
";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:1)+";}\n"})+"return 0;})":(a=b.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(e("dojox.json._slice"),","+(a[1]||0)+","+(a[2]||0)+","+(a[3]||1)+")"):b.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(e("dojox.json._find"),("."==b.charAt(1)?",'"+c+"'":b.match(/,/)?","+b:"")+")"):b}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,l).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(b,
a,c,d,e,g,h,n){return l(b,d,e,g,h,n,c,a)});h=b+("$"==h.charAt(0)?"":"$")+h.replace(/`([0-9]+|\])/g,function(b,a){return"]"==a?"]":c[a]});for(var d=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+h+"}"),q=0;q<arguments.length-1;q++)arguments[q]=arguments[q+1];return n?d.apply(this,arguments):d}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,n,r,t){return h(null,{declaredClass:"esri.tasks.PrintParameters",
map:null,template:null,outSpatialReference:null,extraParameters:null})})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(h,n,r,t,v,e,l,g){return n("dijit.ProgressBar",[e,l],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:g,_indeterminateHighContrastImagePath:h.toUrl("./themes/a11y/indeterminate_progress.gif"),
postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(c){var b="rtl"==c.toLowerCase();r.toggle(this.domNode,"dijitProgressBarRtl",b);r.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&
b);this.inherited(arguments)},update:function(c){t.mixin(this,c||{});c=this.internalProgress;var b=this.domNode,d=1;this.indeterminate?b.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(d=Math.min(parseFloat(this.progress)/100,1),this.progress=d*this.maximum):(this.progress=Math.min(this.progress,this.maximum),d=this.maximum?this.progress/this.maximum:0),b.setAttribute("aria-valuenow",this.progress));b.setAttribute("aria-labelledby",this.labelNode.id);b.setAttribute("aria-valuemin",
0);b.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(d);r.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);r.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());c.style.width=100*d+"%";this.onChange()},_setValueAttr:function(c){this._set("value",c);Infinity==c?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:c})},_setLabelAttr:function(c){this._set("label",c);this.update()},_setIndeterminateAttr:function(c){this._set("indeterminate",
c);this.update()},report:function(c){return this.label?this.label:this.indeterminate?"\x26#160;":v.format(c,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(h,n,r){return h("dijit.form.RadioButton",[n,r],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),
function(h,n,r,t,v,e){return n("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var h=[];v("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(t.hitch(this,function(g){g.name==this.name&&g.form==this.focusNode.form&&(g=e.getEnclosingWidget(g))&&h.push(g)}));return h},_setCheckedAttr:function(e){this.inherited(arguments);this._created&&e&&h.forEach(this._getRelatedWidgets(),t.hitch(this,function(e){e!=this&&e.checked&&e.set("checked",!1)}))},_getSubmitValue:function(e){return null==
e?"on":e},_onClick:function(e){if(this.checked||this.disabled)return e.stopPropagation(),e.preventDefault(),!1;if(this.readOnly)return e.stopPropagation(),e.preventDefault(),h.forEach(this._getRelatedWidgets(),t.hitch(this,function(b){r.set(this.focusNode||this.domNode,"checked",b.checked)})),!1;var g=!1,c;h.some(this._getRelatedWidgets(),function(b){return b.checked?(c=b,!0):!1});this.checked=!0;c&&(c.checked=!1);if(!1===this.onClick(e)||e.defaultPrevented)g=!0;this.checked=!1;c&&(c.checked=!0);
g?e.preventDefault():this.set("checked",!0);return!g}})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\r\n    \x3cdiv class\x3d"formContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\r\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                \x3ctr data-dojo-attach-point\x3d"titleTr"\x3e\r\n                    \x3ctd style\x3d"width:65px;"\x3e\r\n                        ${nls.title}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-attach-point\x3d"titleNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\'" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.layout}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"layoutDijit" data-dojo-attach-event\x3d"Change:onLayoutChange"/\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.format}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonActionBar jimu-align-trailing"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-attach-point\x3d"advancedButtonDijit" data-dojo-props\x3d"iconClass:\'settingsIcon\',showLabel:true" style\x3d"display: none"\x3e\r\n            \x3cspan\x3e\r\n                ${nls.settings}\r\n            \x3c/span\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" class\x3d"gis_PrintDijit"\x3e\r\n                \x3cdiv style\x3d"width:250px;"\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.mapScaleExtent}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                    ${nls.preserve}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapScale" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\r\n                                    /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapScaleLabel"\x3e${nls.mapScale}\x3c/label\x3e\r\n                                    \x3cbr /\x3e\r\n                                    \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapExtent" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\r\n                                    /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapExtentLabel"\x3e${nls.mapExtent}\x3c/label\x3e\r\n                                \x3c/td\x3e\r\n                                \x3ctr\x3e\r\n                                    \x3ctd\x3e\r\n                                        ${nls.forceScale}:\r\n                                    \x3c/td\x3e\r\n                                    \x3ctd\x3e\r\n                                        \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\r\n                                    \x3c/td\x3e\r\n                                \x3c/tr\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;" data-dojo-attach-point\x3d"labelsTitleNode"\x3e\r\n                        ${nls.labels}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"labelsFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                    ${nls.showLabels}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'showLabels\',value:true,checked:true" /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.mapMetadata}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                            \x3ctr data-dojo-attach-point\x3d"authorTr"\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.author}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-attach-point\x3d"authorNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\'" data-dojo-attach-point\x3d"authorTB"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                            \x3ctr data-dojo-attach-point\x3d"copyrightTr"\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.copyright}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-attach-point\x3d"copyrightNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'copyright\',trim:true,required:false,style:\'width:100%;\'" /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"customTextElementsDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5" style\x3d"width:100%;" data-dojo-attach-point\x3d"customTextElementsTable"\x3e\r\n\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr data-dojo-attach-point\x3d"legendTr"\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.lncludeLegend}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.mapOnlyOptions}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.width}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:670,style:\'width:100px;\'"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.height}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:500,style:\'width:100px;\'"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.printQualityOptions}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.dpi}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:96,style:\'width:100px;\'"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'printing\',iconClass:\'printIcon\'"\r\n        data-dojo-attach-event\x3d"onClick:print" data-dojo-attach-point\x3d"printButtonDijit"\x3e\r\n            ${nls.print}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\r\n    style\x3d"display:none;padding:0;"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'clearIcon\'"\r\n        data-dojo-attach-event\x3d"onClick:clearResults"\x3e\r\n            ${nls.clearList}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\r\n  \x3ctable class\x3d"printResultTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd width\x3d"25px"\x3e\r\n        \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd width\x3d"30px"\x3e\r\n        \x3cimg src\x3d"${icon}"\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"progressBar" data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d\'value:Infinity\'\x3e\x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"successNode" class\x3d"bold" style\x3d"display:none;"\x3e${docName}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"errNode" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"bold"\x3e${nls.printError}\x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-icon jimu-icon-error jimu-float-trailing"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{width: 100%; height: 100%; position: relative;}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red; cursor: help;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png); width: 16px; height: 16px;}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png); width: 16px; height: 16px;}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}",
"*now":function(h){h(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingShelter ./Print esri/request jimu/portalUrlUtils".split(" "),function(h,n,r,t,v,e,l,g,c,b){return h([n],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new l({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(t.hitch(this,function(b){this.shelter.show();this.isAsync(b).then(t.hitch(this,function(c){this.print=new g({map:this.map,appConfig:this.appConfig,printTaskURL:b,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:c});
this.print.placeAt(this.printNode);this.print.startup()}),t.hitch(this,function(b){new e({message:b.message})})).always(t.hitch(this,function(){this.shelter.hide()}))}),t.hitch(this,function(b){new e({message:b});console.error(b);this.shelter.hide()}))},_getPrintTaskURL:function(b){var c=new v;if(this.config&&this.config.serviceURL)return c.resolve(this.config.serviceURL),c;r.getPortalSelfInfo(b).then(t.hitch(this,function(b){(b=b&&b.helperServices&&b.helperServices.printTask&&b.helperServices.printTask.url)?
c.resolve(b):c.reject("error")}),t.hitch(this,function(b){new e({message:this.nls.portalConnectionError});c.reject("error");console.error(b)}));return c},isAsync:function(d){var e=new v,f=b.setHttpProtocol(d),a=b.getNewPrintUrl(this.appConfig.portalUrl);f===a||/sharing\/tools\/newPrint$/.test(f)?e.resolve(!1):c({url:d,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4,load:t.hitch(this,function(a){"esriExecutionTypeAsynchronous"===a.executionType?e.resolve(!0):e.resolve(!1)}),
error:t.hitch(this,function(a){e.reject(a)})});return e},onSignIn:function(b){b=b||{};b.userId&&this.print&&this.print.updateAuthor(b.userId)}})});