// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/GroupFilter/LayersHandler":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/request".split(" "),function(k,p,h,n,m,e,b){return p([k],{declaredClass:"LayersHandler",layers:null,layerStore:[],fieldName:null,childList:null,validFieldTypes:"esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeDouble esriFieldTypeSingle esriFieldTypeString esriFieldTypeDate esriFieldTypeGeometry esriFieldTypeOID esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeXML".split(" "),
layersOnly:!1,constructor:function(b){p.safeMixin(this,b)},getAllMapLayers:function(){var b=[],a=new m,f;this.layerStore=[];n.forEach(this.layers,h.hitch(this,function(a){a.featureCollection||("undefined"!==typeof a.originOperLayer&&a.originOperLayer.layerType&&("ArcGISFeatureLayer"===a.originOperLayer.layerType||"ArcGISImageServiceLayer"===a.originOperLayer.layerType)?"undefined"===typeof a.originOperLayer.featureCollection&&(f={label:a.title,id:a.id,url:a.url,fieldName:this.fieldName,type:"Feature Layer",
checked:!1,children:[],layer:a.layerObject},b.push(this._getLayerInfo(f)),this.layerStore.push(f)):0<a.newSubLayers.length?(this.childList=[],"undefined"!==typeof a.originOperLayer.layerType&&"ArcGISTiledMapServiceLayer"===a.originOperLayer.layerType||(n.forEach(a.layerObject.layerInfos,h.hitch(this,function(g){g={label:g.name,id:a.id+"."+g.id,url:a.originOperLayer.url+"/"+g.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:a.layerObject};this.childList.push(g);b.push(this._getLayerInfo(g))})),
f={label:a.title,id:a.id,url:a.originOperLayer.url,type:"Service",checked:!1,children:this.childList,layer:a.layerObject},this.layerStore.push(f))):"ArcGISMapServiceLayer"===a.originOperLayer.layerType&&(this.childList=[],n.forEach(a.layerObject.layerInfos,h.hitch(this,function(g){g={label:g.name,id:a.id+"."+g.id,url:a.originOperLayer.url+"/"+g.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:a.layerObject};this.childList.push(g);b.push(this._getLayerInfo(g))})),f={label:a.title,
id:a.id,url:a.originOperLayer.url,type:"MapService",checked:!1,children:this.childList,layer:a.layerObject},this.layerStore.push(f)))}));e(b).then(h.hitch(this,function(){var c=this._controlComplete();this.emit("complete",c);a.resolve(c)}),h.hitch(this,function(){a.resolve(null)}));return a.promise},_getLayerInfo:function(e){var a=new m;e.url?0===e.url.length?a.resolve():b({url:e.url,content:{f:"json"},callbackParamName:"callback"}).then(h.hitch(this,function(f){if(f.hasOwnProperty("fields")&&!1===
this.layersOnly){var c=n.map(f.fields,h.hitch(this,function(a){return{label:a.alias,id:e.id+"."+a.name,name:a.name,type:"Field",fieldType:a.type,checked:!1}})),c=n.filter(c,h.hitch(this,function(a){return 0<=n.indexOf(this.validFieldTypes,a.fieldType)}));e.children=c}e.geometryType=f.geometryType;e.visible=!0;this.geometryTypes&&!n.some(this.geometryTypes,function(a){if(a===e.geometryType)return!0})&&(e.visible=!1);a.resolve(f)}),function(){a.resolve(null)}):a.resolve();return a.promise},_controlComplete:function(){n.forEach(this.layerStore,
function(b){if(b.children&&0<b.children.length){var a=n.filter(b.children,function(a){return a.hasOwnProperty("visible")?a.visible:!0});b.children=a;0===b.children.length&&(b.visible=!1)}});return this.store={data:{identifier:"id",label:"label",items:n.filter(this.layerStore,function(b){return b.hasOwnProperty("visible")?b.visible:!0})}}}})})},"widgets/GroupFilter/setting/presetValuePicker":function(){define("dojo/_base/declare jimu/BaseWidgetSetting jimu/dijit/FilterParameters dijit/_WidgetsInTemplateMixin dojo/on dojo/dom-construct dojo/dom-attr dojo/query dojo/_base/lang dojo/_base/array dijit/form/Select esri/layers/FeatureLayer dojo/text!./presetValuePicker.html".split(" "),
function(k,p,h,n,m,e,b,s,a,f,c,g,q){return k([p,n],{baseClass:"jimu-widget-map-filter-preset",templateString:q,layerList:null,map:null,nls:null,valueParam:null,postCreate:function(){this.inherited(arguments);this.startup()},startup:function(){this.inherited(arguments);this.createLayerSelection()},createLayerSelection:function(){var g=[];f.forEach(this.layerList,a.hitch(this,function(c){if(0<c.children.length)f.forEach(c.children,a.hitch(this,function(a){var d={};d.value=a.id;d.label=a.label;d.selected=
!1;g.push(d)}));else{var d={};d.value=c.id;d.label=c.label;d.selected=!1;g.push(d)}}));var b=(new c({options:g})).placeAt(this.layerLevel);b.startup();this.own(m(b,"change",a.hitch(this,function(a){this.createFieldSelection(a)})));this.createFieldSelection(b.value)},createFieldSelection:function(g){var b=[];f.forEach(this.layerList,a.hitch(this,function(d){0<d.children.length?f.forEach(d.children,a.hitch(this,function(d){d.id===g&&f.forEach(d.children,a.hitch(this,function(a){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(a.fieldType)){var d=
{};d.value=a.name;d.label=a.label;d.selected=!1;b.push(d)}}))})):d.id===g&&f.forEach(d.layer.fields,a.hitch(this,function(a){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(a.type)){var d={};d.value=a.name;d.label=""===a.alias?a.name:a.alias;d.selected=!1;b.push(d)}}))}));e.empty(this.fieldLevel);var q=(new c({options:b})).placeAt(this.fieldLevel);q.startup();this.own(m(q,"change",a.hitch(this,function(a){this.createValueList(a,g)})));this.createValueList(q.value,g)},createValueList:function(c,
q){e.empty(this.valueLevel);this.valueParam=new h;this.valueParam.placeAt(this.valueLevel);this.valueParam.startup();setTimeout(function(){var a=s(".jimu-single-filter-parameter"),a=s("colgroup",a[0]);0<a.length&&b.set(a[0].childNodes[1],"width","0px")},200);f.forEach(this.layerList,a.hitch(this,function(e){0<e.children.length?f.forEach(e.children,a.hitch(this,function(d){d.id===q&&f.forEach(d.children,a.hitch(this,function(u){if("Shape"!==u.name&&u.name===c){var v=new g(d.url);this.own(m(v,"load",
a.hitch(this,function(){var a=this._makefilterObject({name:u.name,label:u.label,type:u.fieldType});this.valueParam.build(d.url,v,a);a=s(".jimu-single-filter-parameter");a=s("colgroup",a[0]);b.set(a[0].childNodes[1],"width","0px")})))}}))})):e.id===q&&f.forEach(e.layer.fields,a.hitch(this,function(a){a.name===c&&(a=this._makefilterObject({name:a.name,label:a.alias,type:a.type}),this.valueParam.build(e.layer.url,e.layer,a),a=s(".jimu-single-filter-parameter"),a=s("colgroup",a[0]),0<a.length&&b.set(a[0].childNodes[1],
"width","0px"))}))}))},_makefilterObject:function(a){var g={},c=[],d={fieldObj:{}};d.fieldObj.name=a.name;d.fieldObj.label="undefined"===typeof a.alias?a.name:a.alias;d.fieldObj.shortType=a.type.replace("esriFieldType","").toLowerCase();if("guid"!==d.fieldObj.shortType||"globalid"!==d.fieldObj.shortType)d.fieldObj.shortType="string";"date"!==d.fieldObj.shortType&&"string"!==d.fieldObj.shortType&&(d.fieldObj.shortType="number");d.fieldObj.type=a.type;d.operator=d.fieldObj.shortType+"OperatorIs";d.valueObj=
{};d.valueObj.isValid=!0;d.valueObj.type="unique";d.valueObj.value="";d.interactiveObj={};d.interactiveObj.prompt="";d.interactiveObj.hint="";d.caseSensitive=!1;c.push(d);g.logicalOperator="OR";g.expr="";g.parts=c;return g}})})},"jimu/dijit/FilterParameters":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/promise/all dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter ./_filter/ValueProviderFactory".split(" "),
function(k,p,h,n,m,e,b,s,a,f,c,g,q,A,r,t,d){return m([e,b,s,p],{baseClass:"jimu-filter-parameters",templateString:'\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e',_filterUtils:null,_spObj:null,nls:null,partsObj:null,layerInfo:null,OPERATORS:null,url:null,featureLayerId:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this._filterUtils=new A;this.OPERATORS=a.clone(this._filterUtils.OPERATORS);
this._spObj={}},destroy:function(){this.clear();this._filterUtils=null;this.inherited(arguments)},getFilterExpr:function(){var a=this._getNewValidPartsObj(this.partsObj,!0);return a?this._getFilterExprByPartsObj(a):null},getValueProviders:function(){for(var a=[],d=this._getAllInteractiveSinglePartArray(this.partsObj),g=0;g<d.length;g++){var c=d[g].spId;c&&(c=this._getSingleFilterParameterBySpId(c),a.push(c))}return a},_getNewValidPartsObj:function(d,g){d=a.clone(d);for(var f={logicalOperator:d.logicalOperator,
parts:[]},b=a.hitch(this,function(a){if(a.spId){var d=this._getSingleFilterParameterBySpId(a.spId);a.valueObj=d.getValueObject();return d.getStatus()}return a.valueObj?1:-1}),l=a.hitch(this,function(a){var d=b(a);0<d&&f.parts.push(a);return d}),e=a.hitch(this,function(d){var l=[];d.parts=c.filter(d.parts,a.hitch(this,function(a){a=b(a);l.push(a);return 0<a}));1===d.parts.length?f.parts.push(d.parts[0]):2<=d.parts.length&&f.parts.push(d);return Math.min.apply(l,l)}),q=0;q<d.parts.length;q++){var r=
d.parts[q];if(r.parts){if(0>e(r)&&g)return null}else if(0>l(r)&&g)return null}return f},_getFilterExprByPartsObj:function(a){this._filterUtils.isHosted=r.isHostedService(this.url);return this._filterUtils.getExprByFilterObj(a)},_getSingleFilterParameterBySpId:function(a){return this._spObj[a]},_getCascadeFilterExpr:function(d){var g="1\x3d1",f={logicalOperator:this.partsObj.logicalOperator,parts:[]},b=a.clone(this.partsObj),l,e,q;l="none";d.interactiveObj&&d.interactiveObj.cascade&&(l=d.interactiveObj.cascade);
if("previous"===l)for(l=0;l<b.parts.length;l++)e=b.parts[l],e.majorCascadeIndex<d.majorCascadeIndex?f.parts.push(e):e.parts&&e.majorCascadeIndex===d.majorCascadeIndex&&(q=a.clone(e),q.parts=c.filter(q.parts,a.hitch(this,function(a){return a.minorCascadeIndex<d.minorCascadeIndex})),f.parts.push(q));else if("all"===l)for(l=0;l<b.parts.length;l++)e=b.parts[l],e.majorCascadeIndex!==d.majorCascadeIndex?f.parts.push(e):e.majorCascadeIndex===d.majorCascadeIndex&&e.parts&&(q=a.clone(e),c.some(e.parts,a.hitch(this,
function(a){return a.spId===d.spId}))&&(q.parts=c.filter(q.parts,a.hitch(this,function(a){return a.minorCascadeIndex!==d.minorCascadeIndex})),f.parts.push(q)));(f=this._getNewValidPartsObj(f,!1))&&(g=this._getFilterExprByPartsObj(f));g||(g="1\x3d1");return g},clear:function(){this.featureLayerId=this.url=null;var d=g(".jimu-widget-query-single-parameter",this.tbody);c.forEach(d,a.hitch(this,function(a){q.byNode(a).destroy()}));f.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(b,
v,e,q){var l=new h;this.clear();this.url=b;this.layerInfo=v;this.partsObj=a.clone(e);this.partsObj=this._updatePartsObj(this.partsObj);this.featureLayerId=q;this._setCascadeIndexForPartsObj(this.partsObj);b=this._getAllInteractiveSinglePartArray(this.partsObj);if(0<b.length){var y=new d({url:this.url,layerDefinition:v,featureLayerId:this.featureLayerId});b=c.map(b,a.hitch(this,function(d){var l=f.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),l=g("td",l)[0],c=this._getFieldInfo(d.fieldObj.name,
this.layerInfo),c=new t({nls:this.nls,url:this.url,layerDefinition:v,fieldInfo:c,part:d,valueProviderFactory:y});this.own(k(c,"change",a.hitch(this,this._onSingleFilterParameterChanged)));c.placeAt(l);c.startup();d.spId=c.id;return this._spObj[c.id]=c}));c.forEach(b,a.hitch(this,function(d){d.valueProvider.getCascadeFilterExpr=a.hitch(this,this._getCascadeFilterExpr,d.part)}));b=c.map(b,a.hitch(this,function(a){return a.init()}));n(b).then(a.hitch(this,function(){l.resolve()}),a.hitch(this,function(){l.reject()}))}else l.resolve();
return l},_updatePartsObj:function(d){c.forEach(d,a.hitch(this,function(d){d.parts?c.forEach(d.parts,a.hitch(this,function(a){a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")})):d.interactiveObj&&!0===d.interactiveObj.cascade?d.interactiveObj.cascade="previous":!1===d.interactiveObj.cascade&&(d.interactiveObj.cascade="none")}));return d},_setCascadeIndexForPartsObj:function(a){for(var d=0;d<a.parts.length;d++){var g=
a.parts[d];g.majorCascadeIndex="AND"===a.logicalOperator?d:0;g.minorCascadeIndex=0;g.cascadeIndex=g.majorCascadeIndex;if(g.parts)for(var c=0;c<g.parts.length;c++){var l=g.parts[c];l.majorCascadeIndex=g.majorCascadeIndex;l.minorCascadeIndex="AND"===g.logicalOperator?c:0;l.cascadeIndex=parseFloat(l.majorCascadeIndex+"."+l.minorCascadeIndex)}}},_getFieldInfo:function(a,d){for(var g=d.fields,c=0;c<g.length;c++){var l=g[c];if(a===l.name)return l}return null},_getAllInteractiveSinglePartArray:function(a){for(var d=
[],g=0;g<a.parts.length;g++){var c=a.parts[g];if(c.parts)for(var l=0;l<c.parts.length;l++){var b=c.parts[l];b.interactiveObj&&d.push(b)}else c.interactiveObj&&d.push(c)}return d},_onSingleFilterParameterChanged:function(){this.emit("change",this.getFilterExpr(!1))}})})},"jimu/dijit/_SingleFilterParameter":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang".split(" "),
function(k,p,h,n,m,e,b,s,a){return n([m,e,b,p],{baseClass:"jimu-single-filter-parameter",templateString:s,valueProvider:null,nls:null,url:null,layerDefinition:null,fieldInfo:null,part:null,valueProviderFactory:null,postCreate:function(){this.inherited(arguments);this.valueProvider=this.valueProviderFactory.getValueProvider(this.part,!0);this.valueProvider.placeAt(this.valueProviderTd);this.own(k(this.valueProvider,"change",a.hitch(this,this._onValueProviderChanged)));this.valueProvider.bindChangeEvents()},
getValueObject:function(){return this.valueProvider.getValueObject()},init:function(){return this.build(this.fieldInfo,this.part)},build:function(a,c){var g=null;this.fieldInfo=a;this.part=c;if(g=c.interactiveObj)this.promptNode.innerHTML=g.prompt||"",this.hintNode.innerHTML=g.hint||"";g=this.valueProvider.setValueObject(this.part.valueObj);g&&"function"===typeof g.then||(g=new h,g.resolve());return g},disable:function(){this.valueProvider.disable()},enable:function(){this.valueProvider.enable()},
isEnabled:function(){return this.valueProvider.isEnabled()},getStatus:function(){return this.valueProvider.getStatus()},_showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())},_onValueProviderChanged:function(){this.emit("change")}})})},"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider jimu/LayerInfos/LayerInfos".split(" "),
function(k,p,h,n,m,e,b,s,a){var f={stringOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",
supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorStartsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorEndsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorContains:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorDoesNotContain:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},stringOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtLeast:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsLessThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtMost:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsGreaterThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsNotBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},
dateOperatorIsOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}}},c=h([],{nls:null,url:null,layerDefinition:null,layerInfo:null,featureLayerId:null,
constructor:function(g){k.mixin(this,g);this.nls=window.jimuNls.filterBuilder;g=a.getInstanceSync();this.featureLayerId&&(this.layerInfo=g.getLayerOrTableInfoById(this.featureLayerId))},getSupportedValueTypes:function(a,c){var b=[],e=f[c];e&&(e.value&&b.push("value"),e.field&&0<this._getSameShortTypeFieldNames(a).length&&b.push("field"),e.unique&&this.url&&(this._isStreamServer(this.url)||10.1<=parseFloat(this.layerDefinition.currentVersion)&&b.push("unique")));return b},_isStreamServer:function(a){a=
(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_getSameShortTypeFieldNames:function(a){var b=[],f=this._getFieldInfo(this.layerDefinition,a),e=c.getShortTypeByEsriType(f.type);p.forEach(this.layerDefinition.fields,k.hitch(this,function(f){f.name!==a&&c.getShortTypeByEsriType(f.type)===e&&b.push(f.name)}));return b},getValueProvider:function(a,c){var h=null,r=k.clone(f[a.operator]);if(r){var t=a.valueObj.type,d=a.fieldObj.name,u=this._getFieldInfo(this.layerDefinition,d),v=r[t],x=v.normalProviderType,
B=null,l=this._getCodedValues(u);!l&&this.layerDefinition.typeIdField===d&&(l=this._getSubTypes(this.layerDefinition));"field"===t?(t=this._getSameShortTypeFieldNames(d),0<t.length&&(B=p.map(t,k.hitch(this,function(a){return{value:a,label:a}})))):l&&(0<l.length&&v.codedValueProviderType)&&(x=v.codedValueProviderType);r={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:a,fieldInfo:u,codedValues:l,staticValues:B,layerInfo:this.layerInfo,operatorInfo:r,filterCodedValueIfPossible:!!v.filterCodedValueIfPossible,
runtime:c};"BLANK_VALUE_PROVIDER"===x?h=new n(r):"SIMPLE_VALUE_PROVIDER"===x?h=new m(r):"TWO_NUMBERS_VALUE_PROVIDER"===x?h=new e(r):"TWO_DATES_VALUE_PROVIDER"===x?h=new b(r):"LIST_VALUE_PROVIDER"===x&&(r.showNullValues=!1,h=new s(r))}return h},_getFieldInfo:function(a,c){for(var b=a.fields,f=0;f<b.length;f++){var e=b[f];if(c===e.name)return e}return null},_getCodedValues:function(a){var c=null;if((a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length)c=a.codedValues,c=p.map(c,
k.hitch(this,function(a){return{value:a.code,label:a.name}}));return c},_getSubTypes:function(a){var c=null;a.typeIdField&&(a.types&&0<a.types.length)&&(c=p.map(a.types,k.hitch(this,function(a){return{value:a.id,label:a.name}})));return c}});c.getOperatorInfo=function(a){return k.clone(f[a])};c.getOperatorsByShortType=function(a){var c=[];"string"===a?c="stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsBlank stringOperatorIsNotBlank".split(" "):
"number"===a?c="numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsLessThan numberOperatorIsAtMost numberOperatorIsGreaterThan numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" "):"date"===a&&(c="dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "));return c};c.getShortTypeByEsriType=function(a){var c=
null;"esriFieldTypeString"===a?c="string":"esriFieldTypeDate"===a?c="date":0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a)&&(c="number");return c};return c})},"jimu/dijit/_filter/BlankValueProvider":function(){define(["dojo/_base/html","dojo/_base/declare","./ValueProvider"],function(k,p,h){return p([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,
"jimu-filter-blank-value-provider")},getDijits:function(){return[]},getStatus:function(){return 1},setValueObject:function(){},getValueObject:function(){return{isValid:!0,type:this.partObj.valueObj.type,value:null}},isBlankValueProvider:function(){return!0}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils esri/lang".split(" "),function(k,p,h,n,m,e,b,
s,a,f){return e([b,s,p],{baseClass:"jimu-filter-value-provider",fieldName:null,shortType:null,_enabled:!1,cascade:"none",filterCodedValue:!1,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,runtime:!0,staticValues:null,codedValues:null,layerInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;this.cascade=this.partObj.interactiveObj&&
this.partObj.interactiveObj.cascade;this.runtime&&this.codedValues&&this.filterCodedValueIfPossible&&a.isCodedValuesSupportFilter(this.layerDefinition,this.codedValues.length)?this.filterCodedValue=!0:this.filterCodedValue=!1},getDijits:function(){return[]},bindChangeEvents:function(){var a=this.getDijits();m.forEach(a,h.hitch(this,function(a){a.declaredClass&&0===a.declaredClass.indexOf("dijit.")&&n.addClass(a.domNode,a.declaredClass.replace(/\./g,"-"));this.own(k(a,"change",h.hitch(this,this._onChanged)))}))},
_onChanged:function(){this.emit("change")},tryLocaleNumber:function(c){var b=a.localizeNumber(c);if(null===b||void 0===b)b=c;return b},getPartObject:function(){var a=this.getValueObject();if(!a)return null;var b=h.clone(this.partObj);b.valueObj=a;return b},setValueObject:function(){},getValueObject:function(){},tryGetValueObject:function(){return this.getValueObject()},setRequired:function(){},getStatus:function(){var a=1,b=this.getDijits();0<b.length&&(a=m.map(b,h.hitch(this,function(a){return this.getStatusForDijit(a)})),
a=Math.min.apply(a,a));return a},getStatusForDijit:function(a){return a.validate()?a.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},isBlankValueProvider:function(){return!1},getFilterExpr:function(){var a="1\x3d1",a=this.getLayerFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var b=this.getCascadeFilterExpr(),a="("+a+") AND ("+b+")";return a},
getLayerFilterExpr:function(){var a="1\x3d1";this.layerInfo&&(a=this.layerInfo.getFilter());a||(a="1\x3d1");return a},getCascadeFilterExpr:function(){return"1\x3d1"},isDefined:function(a){return f.isDefined(a)},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(k,p,h,n,m,e){return p([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-filter-simple-value-provider");this._dijit="string"===this.shortType?new n({required:!1,trim:!0}):"number"===this.shortType?new e({required:!1,intermediateChanges:!0,constraints:{pattern:"#####0.##########"}}):new m({required:!1,trim:!0,value:new Date});k.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},
getDijits:function(){return[this._dijit]},setValueObject:function(b){this.isDefined(b.value)&&("date"===this.shortType?this._dijit.set("value",new Date(b.value)):this._dijit.set("value",b.value))},getValueObject:function(){if(this.isValidValue()){var b=this._dijit.get("value");"date"===this.shortType?b=b.toDateString():"number"===this.shortType&&(b=parseFloat(b));return{isValid:!0,type:this.partObj.valueObj.type,value:b}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():
this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(b){this._dijit.set("required",b)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(k,p,h){return k("dijit.form.DateTextBox",h,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:p,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(k,p,h,n,m,e,b,s,a,f,c,g,q,A,r,t,d){var u=n("dijit.Calendar",[q,A,r],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){s.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new u._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:f.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(c(this.domNode,"keydown",f.hitch(this,"_onKeyDown")),c(this.dateRowsNode,"mouseover",f.hitch(this,"_onDayMouseOver")),c(this.dateRowsNode,"mouseout",f.hitch(this,"_onDayMouseOut")),c(this.dateRowsNode,"mousedown",f.hitch(this,"_onDayMouseDown")),c(this.dateRowsNode,"mouseup",f.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var d=
new this.dateClassObj(this.currentFocus);d.setDate(1);d.setMonth(a);a=this.dateModule.getDaysInMonth(d);var b=this.currentFocus.getDate();d.setDate(Math.min(b,a));this._setCurrentFocusAttr(d)},_onDayMouseOver:function(a){if((a=e.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!e.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))e.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",e.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),e.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!e.contains(a,"dijitCalendarDisabledDate"))e.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&e.remove(a,"dijitCalendarActiveDate")},
handleKey:function(d){var b=-1,c,l=this.currentFocus;switch(d.keyCode){case a.RIGHT_ARROW:b=1;case a.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case a.DOWN_ARROW:b=1;case a.UP_ARROW:c="week";break;case a.PAGE_DOWN:b=1;case a.PAGE_UP:c=d.ctrlKey||d.altKey?"year":"month";break;case a.END:l=this.dateModule.add(l,"month",1),c="day";case a.HOME:l=new this.dateClassObj(l);l.setDate(1);break;default:return!0}c&&(l=this.dateModule.add(l,c,b));this._setCurrentFocusAttr(l);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});u._MonthDropDownButton=n("dijit.Calendar._MonthDropDownButton",d,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new u._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var d=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
d);this.containerNode.innerHTML=(6==g("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+d[a.getMonth()]+"\x3c/div\x3e"}});u._MonthDropDown=n("dijit.Calendar._MonthDropDown",[A,t,r],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";k.forEach(a,function(a,d){b.create("div",{className:"dijitCalendarMonthLabel",month:d,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(m.get(a.target,"month"))},onChange:function(){}});return u})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(k,p,h,n,m,e,b,s,a,f,c,g,q,A,r){var t=p("dijit.CalendarLite",[q,A],{templateString:r,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=e.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&
(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),f=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),e=new this.dateClassObj,l=0<=this.dayOffset?this.dayOffset:h.getFirstDayOfWeek(this.lang);l>b&&
(l-=7);if(!this.summary){var g=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",g[a.getMonth()])}this._date2cell={};k.forEach(this.dateCells,function(g,q){var h=q+l,y=new this.dateClassObj(a),w="dijitCalendar",k=0;h<b?(h=f-b+h+1,k=-1,w+="Previous"):h>=b+c?(h=h-b-c+1,k=1,w+="Next"):(h=h-b+1,w+="Current");k&&(y=this.dateModule.add(y,"month",k));y.setDate(h);this.dateModule.compare(y,e,"date")||(w="dijitCalendarCurrentDate "+w);this.isDisabledDate(y,
this.lang)?(w="dijitCalendarDisabledDate "+w,g.setAttribute("aria-disabled","true")):(w="dijitCalendarEnabledDate "+w,g.removeAttribute("aria-disabled"),g.setAttribute("aria-selected","false"));(k=this.getClassForDate(y,this.lang))&&(w=k+" "+w);g.className=w+"Month dijitCalendarDateTemplate";w=y.valueOf();this._date2cell[w]=g;g.dijitDateValue=w;this._setText(this.dateLabels[q],y.getDateLocalized?y.getDateLocalized(this.lang):y.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);
a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;k.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(d){this.dateModule=d.datePackage?a.getObject(d.datePackage,!1):n;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=d.datePackage?
a.getObject(d.datePackage+".locale",!1):m},_createMonthWidget:function(){return t._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),f=0<=this.dayOffset?this.dayOffset:h.getFirstDayOfWeek(this.lang);this.dayCellsHtml=g.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return c[f++%7]});a=g.substitute(this.weekTemplateString,
{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);b.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var d=a.hitch(this,function(d,b,c){this[d].dojoClick=!0;return f(this[d],"click",a.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,
b,c))}))});this.own(d("incrementMonth","month",1),d("decrementMonth","month",-1),d("nextYearLabelNode","year",1),d("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var f=this.currentFocus,e=this._getNodeByDate(f);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(f,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);f=this._getNodeByDate(a);f.setAttribute("tabIndex",this.tabIndex);(this.focused||
b)&&f.focus();e&&e!=f&&(c("webkit")?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!s.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(b){function c(a,
b){s.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}k.forEach(this._selectedCells||[],a.partial(c,!1));this._selectedCells=k.filter(k.map(b,this._getNodeByDate,this),function(a){return a});k.forEach(this._selectedCells,a.partial(c,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});t._MonthWidget=p("dijit.CalendarLite._MonthWidget",q,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",
this.lang,a),f=6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+k.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=f+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return t})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(k,p,h,n,m,e,b,s){new Date("X");return n("dijit.form._DateTimeTextBox",[e,b],{templateString:s,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:p.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(a,b){var c=this._isInvalidDate(a),e=this._isInvalidDate(b);if(c||e)return c&&e?0:!c?1:-1;var c=this.format(a,this._unboundedConstraints),e=this.format(b,this._unboundedConstraints),
h=this.parse(c,this._unboundedConstraints),m=this.parse(e,this._unboundedConstraints);return c==e?0:k.compare(h,m,this._selector)},autoWidth:!0,format:function(a,b){return!a?"":this.dateLocaleModule.format(a,b)},parse:function(a,b){return this.dateLocaleModule.parse(a,b)||(this._isEmpty(a)?null:void 0)},serialize:function(a,b){a.toGregorian&&(a=a.toGregorian());return h.toISOString(a,b)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=
a||{};this.dateModule=a.datePackage?m.getObject(a.datePackage,!1):k;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?m.getObject(a.datePackage+".locale",!1):p;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(a){a.selector=this._selector;a.fullYear=!0;var b=h.fromISOString;"string"==typeof a.min&&(a.min=b(a.min),this.dateClassObj instanceof Date||(a.min=new this.dateClassObj(a.min)));"string"==typeof a.max&&(a.max=b(a.max),this.dateClassObj instanceof Date||(a.max=new this.dateClassObj(a.max)));this.inherited(arguments);this._unboundedConstraints=m.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||
isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(a,b,c){void 0!==a&&("string"==typeof a&&(a=h.fromISOString(a)),this._isInvalidDate(a)&&(a=null),a instanceof Date&&!(this.dateClassObj instanceof Date)&&(a=new this.dateClassObj(a)));this.inherited(arguments,[a,b,c]);this.value instanceof Date&&(this.filterString="");!1!==b&&this.dropDown&&this.dropDown.set("value",a,!1)},_set:function(a,b){if("value"==a){b instanceof Date&&!(this.dateClassObj instanceof Date)&&
(b=new this.dateClassObj(b));var c=this._get("value");if(c instanceof this.dateClassObj&&0==this.compare(b,c))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},openDropDown:function(a){this.dropDown&&this.dropDown.destroy();var b=m.isString(this.popupClass)?m.getObject(this.popupClass,!1):this.popupClass,c=this,e=this.get("value");this.dropDown=new b({onChange:function(a){c.set("value",
a,!0)},id:this.id+"_popup",dir:c.dir,lang:c.lang,value:e,textDir:c.textDir,currentFocus:!this._isInvalidDate(e)?e:this.dropDownDefaultValue,constraints:c.constraints,filterString:c.filterString,datePackage:c.datePackage,isDisabledDate:function(a){return!c.rangeCheck(a,c.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,b){this._setValueAttr(this.parse(a,this.constraints),b,a)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox".split(" "),
function(k,p,h,n,m,e){return p([h,n,m],{templateString:e,postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-two-numbers-filter-value-provider")},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var b=parseFloat(this._dijit1.get("value")),e=parseFloat(this._dijit2.get("value"));b>e&&(this._dijit1.set("value",e),this._dijit2.set("value",b))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(b){this.isDefined(b.value1)&&
this._dijit1.set("value",b.value1);this.isDefined(b.value2)&&this._dijit2.set("value",b.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var b={isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))};
isNaN(b.value1)&&(b.value1=null);isNaN(b.value2)&&(b.value2=null);return b}return null},setRequired:function(b){this._dijit1.set("required",b);this._dijit2.set("required",b)}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoDatesValueProvider.html dijit/form/DateTextBox".split(" "),function(k,p,h,n,m,e){return p([h,n,m],{templateString:e,postCreate:function(){this.inherited(arguments);
k.addClass(this.domNode,"jimu-two-dates-filter-value-provider")},_onRangeDateBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var b=this._dijit1.get("value"),e=b.getTime(),a=this._dijit2.get("value"),f=a.getTime();e>f&&(this._dijit1.set("value",a),this._dijit2.set("value",b))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(b){this.isDefined(b.value1)&&this._dijit1.set("value",new Date(b.value1));this.isDefined(b.value2)&&this._dijit2.set("value",
new Date(b.value2))},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:this._dijit1.get("value").toDateString(),value2:this._dijit2.get("value").toDateString()}:null},setRequired:function(b){this._dijit1.set("required",b);this._dijit2.set("required",b)}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListValueProvider.html dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),
function(k,p,h,n,m,e,b,s,a,f,c,g){return e([b,s,a],{templateString:f,codedValues:null,staticValues:null,showNullValues:!1,postCreate:function(){this.inherited(arguments);n.addClass(this.domNode,"jimu-filter-list-value-provider");this._uniqueValueCache={};var a=new c({idProperty:"id",data:[]});this.valuesSelect.set("store",a);!this.staticValues&&"function"===typeof this.valuesSelect._onDropDownMouseDown&&(!this.codedValues||this.codedValues&&this.filterCodedValue)&&this.own(k.before(this.valuesSelect,
"_onDropDownMouseDown",h.hitch(this,this._onBeforeDropDownMouseDown)))},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,!0);return arguments},getDijits:function(){return[this.valuesSelect]},setValueObject:function(a){return this.staticValues?this._setValueForStaticValues(a.value,this.staticValues):this.codedValues?this.filterCodedValue?this._tryUpdatingUniqueValues(a.value,!1):this._setValueForStaticValues(a.value,this.codedValues):this._tryUpdatingUniqueValues(a.value,
!1)},getValueObject:function(){if(this.isValidValue()){var a=this.valuesSelect.get("item").value;return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(a){this.valuesSelect.set("required",a)},_setValueForStaticValues:function(a,b){var c=null,e=-1,c=null;b&&(c=m.map(b,h.hitch(this,
function(b,c){var f={id:c,value:b.value,label:b.label};f.value===a&&(e=c);return f})),this.valuesSelect.store.setData(c),0<=e&&(c=this.valuesSelect.store.get(e))&&this.valuesSelect.set("item",c))},_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(a,b){var c=new p;if(this.valuesSelect._opened)c.resolve();else{var e=this.getFilterExpr();e!==this._uniqueValueLoadingExpr?(this.valuesSelect.readOnly=!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),
this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=e,this._uniqueValueLoadingDef=this._getUniqueValues(e),this._uniqueValueLoadingDef.then(h.hitch(this,function(d){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(a,d),this._hideLoadingIcon(),b&&this.valuesSelect.toggleDropDown(),c.resolve())}),h.hitch(this,function(a){console.error(a);this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),
c.reject(a))}))):c.resolve()}return c},_setValueForUniqueValues:function(a,b){b.sort(function(a,b){return a.value<b.value?-1:a.value===b.value?0:1});this.showNullValues||(b=m.filter(b,h.hitch(this,function(a){return"\x3cNull\x3e"!==a.value&&null!==a.value})));if(void 0===a){var c=this.getValueObject();c&&(a=c.value)}var e=-1,c=null,d=m.map(b,h.hitch(this,function(b,c){var d={id:c,value:b.value,label:b.label};b.value===a&&(e=c);return d}));this.valuesSelect.store.setData(d);0<=e&&(c=this.valuesSelect.store.get(e));
this.valuesSelect.set("item",c)},_showLoadingIcon:function(){n.addClass(this.valuesSelect.domNode,"loading")},_hideLoadingIcon:function(){n.removeClass(this.valuesSelect.domNode,"loading")},_getUniqueValues:function(a){var b=new p;this._uniqueValueCache[a]?b.resolve(this._uniqueValueCache[a]):(this._showLoadingIcon(),g.getUniqueValues(this.url,this.fieldName,a,this.layerDefinition).then(h.hitch(this,function(c){this.domNode&&(this._uniqueValueCache[a]=c,b.resolve(c),this._hideLoadingIcon())}),h.hitch(this,
function(a){this.domNode&&(b.reject(a),this._hideLoadingIcon())})));return b}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(k,p,h,n,m){return k("dijit.form.FilteringSelect",[n,m],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},
_callbackSetLabel:function(e,b,h,a){b&&b[this.searchAttr]!==this._lastQuery||!b&&e.length&&this.store.getIdentity(e[0])!=this._lastQuery||(e.length?this.set("item",e[0],a):this.set("value","",a||void 0===a&&!this.focused,this.textbox.value,null))},_openResultList:function(e,b,h){b[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(e,
b,k,a){this._onChangeActive||(b=null);if(void 0===a){if(null===e||""===e)if(e="",!p.isString(k)){this._setDisplayedValueAttr(k||"",b);return}var f=this;this._lastQuery=e;h(this.store.get(e),function(a){f._callbackSetLabel(a?[a]:[],void 0,void 0,b)})}else this.valueNode.value=e,this.inherited(arguments,[e,b,k,a])},_setItemAttr:function(e,b,h){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(e){return e.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(e,
b){null==e&&(e="");if(!this._created){if(!("displayedValue"in this.params))return;b=!1}if(this.store){this.closeDropDown();var k=p.clone(this.query),a=this._getDisplayQueryString(e),f;this.store._oldAPI?f=a:(f=this._patternToRegExp(a),f.toString=function(){return a});this._lastQuery=k[this.searchAttr]=f;this._lastDisplayedValue=this.textbox.value=e;this._set("displayedValue",e);var c=this,g={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};p.mixin(g,this.fetchProperties);this._fetchHandle=this.store.query(k,
g);h(this._fetchHandle,function(a){c._fetchHandle=null;c._callbackSetLabel(a||[],k,g,b)},function(a){c._fetchHandle=null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"widgets/GroupFilter/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_SingleFilterParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr class\x3d"first-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"second-tr"\x3e\r\n        \x3ctd data-dojo-attach-point\x3d"valueProviderTd"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"third-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/ListValueProvider.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"valuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/GroupFilter/setting/presetValuePicker.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e\x3ch3\x3e${nls.picker.description}\x3c/h3\x3e\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n\t\x3ctable width\x3d"100%" cellpadding\x3d"2" cellspacing\x3d"2"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d"picker-cell"\x3e\r\n\t\t\t\t${nls.picker.layer}\x3cbr\x3e\r\n\t\t\t\t\x3cdiv class\x3d"" data-dojo-attach-point\x3d"layerLevel"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d"picker-cell"\x3e\r\n\t\t\t\t${nls.picker.field}\x3cbr\x3e\r\n\t\t\t\t\x3cdiv class\x3d"" data-dojo-attach-point\x3d"fieldLevel"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d"picker-cell"\x3e\r\n\t\t\t\t${nls.picker.value}\x3cbr\x3e\r\n\t\t\t\t\x3cdiv class\x3d"value-level" data-dojo-attach-point\x3d"valueLevel"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/setting/Setting.html":'\x3cdiv\x3e\r\n\t\x3clabel\x3e${nls.configText}\x3c/label\x3e\r\n\t\x3cdiv class\x3d"widget-intro" data-dojo-attach-point\x3d"widgetIntro"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"layer-Mapping-Block" data-dojo-attach-point\x3d"layerMappingBlock" id\x3d"layerMappingBlock"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"jimu-btn layer-Mapping-Block-add" data-dojo-attach-point\x3d"layerMappingBlockAdd" data-dojo-attach-event\x3d"click:createGroupBlock" title\x3d"${nls.buttons.addNewGroupTip}"\x3e${nls.buttons.addNewGroup}\x3c/div\x3e\r\n\t\x3chr\x3e\r\n\t\x3cdiv\x3e\r\n\t\t\x3ctable width\x3d"90%"\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkSimpleMode" data-dojo-props\x3d"value:true,checked:false"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.simpleModeTip}"\x3e${nls.inputs.simpleMode}\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkOptionsMode" data-dojo-props\x3d"value:true,checked:false"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.optionsModeTip}"\x3e${nls.inputs.optionsMode}\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkWebmapAppendMode" data-dojo-props\x3d"value:true,checked:true"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.webmapAppendModeTip}"\x3e${nls.inputs.webmapAppendMode}\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"slAppendChoice" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\t\t    \x3coption value\x3d"OR"\x3e${nls.inputs.optionOR}\x3c/option\x3e\r\n\t\t\t\t\t    \x3coption value\x3d"AND"\x3e${nls.inputs.optionAND}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkZoomMode" data-dojo-props\x3d"value:true,checked:true"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.zoomTo} ${nls.allFeaturesTip}"\x3e${nls.zoomTo}\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/setting/css/style.css":'.jimu-widget-map-filter input{margin-left: 10px;}.jimu-widget-map-filter .group-block {background-color: #FFFFFF; border-color: #e1e1e1; border-style: solid; border-width: 2px; border-radius: 5px; width: 100%; text-align: left; position: relative; margin-top: 10px;}.jimu-widget-map-filter .layer-Mapping-Block-add {margin-top: 10px; margin-bottom: 5px;}.jimu-widget-map-filter .group-setting-table {width: 100%; margin-left: 10px;}.jimu-widget-map-filter .group-block-item {position: relative; width: 90%;}.jimu-widget-map-filter .group-block-delete{padding-left: 10px; padding-right: 10px; cursor: pointer; cursor: hand; content: url("../../images/delete.png");}.jimu-widget-map-filter .group-block-delete:after{padding-left: 10px; padding-right: 10px; cursor: pointer; cursor: hand; content: url("../../images/delete.png");}.jimu-widget-map-filter .group-block-delete:hover{padding-left: 10px; padding-right: 10px; cursor: pointer; cursor: hand; content: url("../../images/delete_hover.png");}.jimu-widget-map-filter .group-block-layer-select {}.jimu-widget-map-filter .group-block-field-select {position: absolute; right: 0px; top: 0px;}.jimu-widget-map-filter .group-block-add-layer {margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px;}.jimu-widget-map-filter .groupName-textbox {margin-top: 5px; margin-bottom: 5px; margin-left: 0px; margin-right: 0px; width: 175px;}.jimu-widget-map-filter .groupName-Desctextbox {margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px; width: 400px;}.jimu-widget-map-filter .groupName-Defaulttextbox {margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px; width: 400px;}.jimu-widget-map-filter .groupName-defaultPicker {padding-left: 10px; padding-right: 10px; content: url("../../images/find.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .groupName-defaultPicker:after {padding-left: 10px; padding-right: 10px; content: url("../../images/find.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .layer-tables {margin-top: 5px; margin-bottom: 5px; width: 98%; margin-left: 10px;}.jimu-widget-map-filter .operator-select {font-size: 8pt;}.jimu-widget-map-filter .operator-append-select {font-size: 8pt; margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px;}.jimu-widget-map-filter-preset .picker-cell {padding-bottom: 15px;}.jimu-widget-map-filter-preset .value-level{margin-left: -3px; margin-right: -3px;}',
"*now":function(k){k(['dojo/i18n!*preload*widgets/GroupFilter/setting/nls/Setting*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin jimu/dijit/SimpleTable dojo/dom dojo/dom-construct dojo/on dojo/query dojo/dom-attr dojo/_base/lang dojo/_base/array dijit/form/Select dijit/form/TextBox dijit/form/ValidationTextBox jimu/utils jimu/LayerInfos/LayerInfos jimu/dijit/Message jimu/dijit/Popup dojox/html/entities ../LayersHandler ./presetValuePicker".split(" "),function(k,p,h,n,m,e,b,s,a,f,c,g,q,A,r,t,d,u,v,x,B){return k([p,h],{baseClass:"jimu-widget-map-filter",
groupCounter:0,groupLayerContainer:[],groupLayerName:[],groupLayerDesc:[],groupLayerOperator:[],groupLayerDefault:[],groupAppendSameConjunc:[],layerCounter:0,layerList:null,postMixInProperties:function(){this.nls=f.mixin(this.nls,window.jimuNls.common);this.nls=f.mixin(this.nls,window.jimuNls.spatialFilterByFeatures)},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this.setConfig(this.config)},setConfig:function(a){this.config=a;this.groupLayerContainer=
[];this.groupLayerName=[];this.groupLayerDesc=[];this.groupLayerOperator=[];this.groupLayerDefault=[];this.groupAppendSameConjunc=[];this.chkSimpleMode.set("checked",this.config.simpleMode);this.chkOptionsMode.set("checked",this.config.optionsMode);this.chkWebmapAppendMode.set("checked",this.config.webmapAppendMode);this.slAppendChoice.set("value",this.config.slAppendChoice);this.chkZoomMode.set("checked",this.config.zoomMode);this.createMapLayerList()},getConfig:function(){if(null===this.layerList)return new d({message:this.nls.errors.noLayers}),
!1;if(0<this.layerList.length){var a=this.validateNoGroups(),b=this.validateNoGroupsName(),e=this.validateDuplicateGroupsName(),g=this.validateTableRows();return a&&b&&e&&g?(this.config.simpleMode=this.chkSimpleMode.checked,this.config.optionsMode=this.chkOptionsMode.checked,this.config.webmapAppendMode=this.chkWebmapAppendMode.checked,this.config.slAppendChoice=this.slAppendChoice.get("value"),this.config.zoomMode=this.chkZoomMode.checked,this.config.groups=[],c.forEach(this.groupLayerName,f.hitch(this,
function(a,b){if(null!==a&&null!==this.groupLayerContainer[b]){var d={};d.name=r.sanitizeHTML(a.value);d.desc=r.sanitizeHTML(this.groupLayerDesc[b].value);d.operator=r.sanitizeHTML(this.groupLayerOperator[b].value);d.defaultVal=r.sanitizeHTML(this.groupLayerDefault[b].value);d.appendSameLayer=!0;d.appendSameLayerConjunc=this.groupAppendSameConjunc[b].value;d.layers=[];c.forEach(this.groupLayerContainer[b].getRows(),f.hitch(this,function(a){var b={},c=a.cells[2].childNodes[0];b.layer=a.layerCol.value;
b.field=a.fieldCol.value;b.dataType=a.dataTypeCol.attr("displayedValue");b.useDomain=c.checked?c.checked:"";d.layers.push(b)}));this.config.groups.push(d)}})),this.config):!1}new d({message:this.nls.errors.noLayers});return!1},createMapLayerList:function(){t.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(a){a._layerInfos&&0<a._layerInfos.length&&(console.log(a._layerInfos),a=new x({layers:a._layerInfos}),this.own(b(a,"complete",f.hitch(this,function(a){this.layerList=a.data.items;
0<this.config.groups.length?c.forEach(this.config.groups,f.hitch(this,function(a){this.createGroupBlock({group:a})})):this.createGroupBlock({group:null})}))),this.own(b(a,"error",f.hitch(this,function(){console.log("error")}))),a.getAllMapLayers())}))},createGroupBlock:function(c){this.groupCounter++;var d=e.create("div",{id:"grpDiv_"+this.groupCounter,"class":"group-block"});e.place(d,this.layerMappingBlock);var g=e.create("table",{"class":"group-setting-table"});e.place(g,d);var h=g.insertRow(-1),
k=h.insertCell(0);a.set(k,"title",this.nls.labels.groupNameTip);var n=h.insertCell(1),p=h.insertCell(2);a.set(p,"title",this.nls.labels.groupDescTip);var d=h.insertCell(3),h=h.insertCell(4),s=g.insertRow(-1),r=s.insertCell(0);a.set(r,"title",this.nls.labels.groupOperatorTip);var u=s.insertCell(1),C=s.insertCell(2);a.set(C,"title",this.nls.labels.groupDefaultTip);var E=s.insertCell(3),s=s.insertCell(4),z=g.insertRow(-1),t=z.insertCell(0);a.set(t,"colspan","3");g=z.insertCell(1);z.insertCell(2);a.set(z,
"id","appendLayers_"+this.groupCounter);k.innerHTML=this.nls.labels.groupName;p.innerHTML=this.nls.labels.groupDesc;r.innerHTML=this.nls.labels.groupOperator;C.innerHTML=this.nls.labels.groupDefault;t.innerHTML=this.nls.labels.sameLayerAppend;p=r=k=C=z="";"undefined"!==typeof c.group&&null!==c.group&&(z=c.group.name,C=c.group.desc,k=c.group.operator,r=c.group.defaultVal,"undefined"!==typeof c.group.appendSameLayerConjunc&&(p=c.group.appendSameLayerConjunc));z=new A({name:"txtGroupName",value:z,"class":"groupName-textbox",
placeHolder:this.nls.inputs.groupName,required:"true"});e.place(z.domNode,n);this.groupLayerName.push(z);n=new q({name:"txtGroupDesc",value:C,"class":"groupName-Desctextbox",placeHolder:this.nls.inputs.groupDesc});e.place(n.domNode,d);this.groupLayerDesc.push(n);var v=new q({name:"txtGroupDefault",value:r,"class":"groupName-Defaulttextbox",placeHolder:this.nls.inputs.groupDefault});e.place(v.domNode,E);this.groupLayerDefault.push(v);d=e.create("div",{"class":"groupName-defaultPicker"});e.place(d,
s);this.own(b(d,"click",f.hitch(this,function(){this.presetPickerPopup(v)})));var x=e.create("div",{id:"addGroupDelete_"+this.groupCounter,"class":"group-block-delete"}),B=b(x,"click",f.hitch(this,function(){B.remove();this.removeGroup(x.id)}));e.place(x,h);this.createOperatorSelection({cell:u,value:k});this.createAppendConjunc({cell:g,value:p});this.createTableObject(c);var D=e.create("div",{id:"addLyrDiv_"+this.groupCounter,"class":"jimu-btn group-block-add-layer",title:this.nls.buttons.addLayerTip});
this.own(b(D,"click",f.hitch(this,function(){this.addLayerRow(D.id)})));e.place(D,m.byId("grpDiv_"+this.groupCounter));m.byId("addLyrDiv_"+this.groupCounter).innerHTML=this.nls.buttons.addLayer},createOperatorSelection:function(a){var b=(new g({options:[{value:"",label:this.nls.inputs.optionNONE},{value:"\x3d",label:this.nls.inputs.optionEQUAL},{value:"\x3c\x3e",label:this.nls.inputs.optionNOTEQUAL},{value:"\x3e",label:this.nls.inputs.optionGREATERTHAN},{value:"\x3e\x3d",label:this.nls.inputs.optionGREATERTHANEQUAL},
{value:"\x3c",label:this.nls.inputs.optionLESSTHAN},{value:"\x3c\x3d",label:this.nls.inputs.optionLESSTHANEQUAL},{value:"START",label:this.nls.inputs.optionSTART},{value:"END",label:this.nls.inputs.optionEND},{value:"LIKE",label:this.nls.inputs.optionLIKE},{value:"NOT LIKE",label:this.nls.inputs.optionNOTLIKE}],"class":"operator-select"})).placeAt(a.cell);b.startup();b.set("value",v.decode(a.value));this.groupLayerOperator.push(b)},createAppendConjunc:function(a){var b=(new g({options:[{value:"OR",
label:this.nls.inputs.optionOR},{value:"AND",label:this.nls.inputs.optionAND}],"class":"operator-append-select"})).placeAt(a.cell);b.startup();b.set("value",v.decode(a.value));this.groupAppendSameConjunc.push(b)},createTableObject:function(a){var b=null,b=[{name:"layerCol",title:this.nls.tables.layer,"class":"label",type:"empty",width:"375px"},{name:"fieldCol",title:this.nls.tables.field,"class":"label",type:"empty",width:"350px"},{name:"domainCol",title:this.nls.tables.value,"class":"label",type:"radio",
width:"100px"},{name:"actions",title:this.nls.tables.action,type:"actions",actions:["delete"],width:"100px"},{name:"dataTypeCol",type:"empty",hidden:!0,width:0}],b=new n({fields:b,"class":"layer-tables"});b.placeAt(m.byId("grpDiv_"+this.groupCounter));this.groupLayerContainer.push(b);"undefined"!==typeof a.group&&null!==a.group?c.forEach(a.group.layers,f.hitch(this,function(a){this.addLayerRow(m.byId("grpDiv_"+this.groupCounter).id,a)})):this.addLayerRow(m.byId("grpDiv_"+this.groupCounter).id,a)},
addLayerRow:function(a,c){var d=a.substring(a.indexOf("_")+1),e=this.groupLayerContainer[d-1].addRow({});if(e.success&&e.tr){e=e.tr;this.createLayerSelection(e,c,d);var g=e.cells[2].childNodes[0],h=g.checked;this.own(b(g,"click",f.hitch(this,function(){h=h?g.checked=!1:g.checked=!0})))}},createLayerSelection:function(a,d,e){var h=[];c.forEach(this.layerList,f.hitch(this,function(a){if(0<a.children.length)c.forEach(a.children,f.hitch(this,function(a){var b={};b.value=a.id;b.label=a.label;b.selected=
!1;h.push(b)}));else{var b={};b.value=a.id;b.label=a.label;b.selected=!1;h.push(b)}}));var k=s(".simple-table-cell",a)[0],m;k&&(m=(new g({options:h})).placeAt(k),m.startup(),a.layerCol=m,this.own(b(m,"change",f.hitch(this,function(b){this.createFieldSelection(b,a,d,e)}))),"undefined"!==typeof d&&m.set("value",d.layer));this.createFieldSelection(m.value,a,d,e)},createFieldSelection:function(a,d,h,k){var m=[],p=[];c.forEach(this.layerList,f.hitch(this,function(b){0<b.children.length?c.forEach(b.children,
f.hitch(this,function(b){b.id===a&&c.forEach(b.children,f.hitch(this,function(a){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(a.fieldType)){var b={};b.value=a.name;b.label=a.label;b.selected=!1;m.push(b);b={};b.value=a.name;b.label=a.fieldType;b.selected=!1;p.push(b)}}))})):b.id===a&&c.forEach(b.layer.fields,f.hitch(this,function(a){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(a.type)){var b={};b.value=a.name;b.label=""===a.alias?a.name:a.alias;b.selected=!1;m.push(b);b={};b.value=
a.name;b.label=a.type;b.selected=!1;p.push(b)}}))}));var n=s(".simple-table-cell",d)[1],q=s(".simple-table-cell",d)[4];if(n){e.empty(n);n=(new g({options:m})).placeAt(n);n.startup();d.fieldCol=n;e.empty(q);var r=(new g({options:p})).placeAt(q);r.startup();d.dataTypeCol=r;this.own(b(n,"change",f.hitch(this,function(b){this.resetRadio({layer:a,field:b,row:d,param:h,counter:k});this.dataTypeSync({layer:a,field:b,row:d,param:h,select:r})})));"undefined"!==typeof h&&(this.resetRadio({layer:a,row:d,param:h,
counter:k}),n.set("value",h.field),r.set("value",h.field))}},dataTypeSync:function(a){a.select.set("value",a.field)},resetRadio:function(a){var b=a.row.cells[2].childNodes[0];"undefined"!==typeof a.param&&(a.param.hasOwnProperty("useDomain")?b.checked=""!==a.param.useDomain?!0:!1:b.checked=!1)},validateNoGroups:function(){var a=!1,b=this.nls.errors.noGroups;c.forEach(this.groupLayerName,f.hitch(this,function(b){null!==b&&(a=!0)}));if(a)return!0;new d({message:b});return!1},validateNoGroupsName:function(){var a=
!0,b=this.nls.errors.noGroupName;c.forEach(this.groupLayerName,f.hitch(this,function(b){null!==b&&(b.get("value")||(a=!1))}));!1===a&&new d({message:b});return a},validateDuplicateGroupsName:function(){var a=!0,b=this.nls.errors.noDuplicates,e=[];c.forEach(this.groupLayerName,f.hitch(this,function(a){null!==a&&a.get("value")&&e.push(a.get("value"))}));1<e.length&&e.sort().filter(function(a,b,c){return a!==c[b-1]}).length!==e.length&&(a=!1);!1===a&&new d({message:b});return a},validateTableRows:function(){var a=
!0;c.forEach(this.groupLayerContainer,f.hitch(this,function(b){null!==b&&0>=b.getRows().length&&(a=!1)}));!1===a&&new d({message:this.nls.errors.noRows});return a},presetPickerPopup:function(a){var b=new B({map:this.map,nls:this.nls,layerList:this.layerList}),c=new u({titleLabel:this.nls.popup.label,width:500,height:420,content:b,buttons:[{label:window.jimuNls.common.ok,onClick:f.hitch(this,function(){var d="";if("undefined"!==typeof b.valueParam&&null!==b.valueParam.getFilterExpr()){var e=b.valueParam.getValueProviders()[0].getValueObject();
e&&(d=e.value);a.set("value",d)}c.close();c=null})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"]}]})},removeGroup:function(a){a=a.substring(a.indexOf("_")+1);this.groupLayerContainer[a-1]=null;this.groupLayerName[a-1]=null;this.groupLayerDesc[a-1]=null;this.groupLayerOperator[a-1]=null;this.groupLayerDefault[a-1]=null;this.groupAppendSameConjunc[a-1]=null;e.destroy(m.byId("addGroupDelete_"+a));e.destroy(m.byId("addLyrDiv_"+a));e.destroy(m.byId("grpDiv_"+a))}})});