// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/FilterParameters":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/promise/all dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter ./_filter/ValueProviderFactory".split(" "),function(h,q,e,p,r,k,c,g,b,m,d,a,s,f,l,u,n){return r([k,c,g,q],{baseClass:"jimu-filter-parameters",templateString:'\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e',
_filterUtils:null,_spObj:null,nls:null,partsObj:null,layerInfo:null,OPERATORS:null,url:null,featureLayerId:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this._filterUtils=new f;this.OPERATORS=b.clone(this._filterUtils.OPERATORS);this._spObj={}},destroy:function(){this.clear();this._filterUtils=null;this.inherited(arguments)},getFilterExpr:function(){var a=this._getNewValidPartsObj(this.partsObj,!0);return a?this._getFilterExprByPartsObj(a):null},getValueProviders:function(){for(var a=
[],b=this._getAllInteractiveSinglePartArray(this.partsObj),d=0;d<b.length;d++){var n=b[d].spId;n&&(n=this._getSingleFilterParameterBySpId(n),a.push(n))}return a},_getNewValidPartsObj:function(a,n){a=b.clone(a);for(var c={logicalOperator:a.logicalOperator,parts:[]},f=b.hitch(this,function(a){if(a.spId){var b=this._getSingleFilterParameterBySpId(a.spId);a.valueObj=b.getValueObject();return b.getStatus()}return a.valueObj?1:-1}),l=b.hitch(this,function(a){var b=f(a);0<b&&c.parts.push(a);return b}),m=
b.hitch(this,function(a){var n=[];a.parts=d.filter(a.parts,b.hitch(this,function(a){a=f(a);n.push(a);return 0<a}));1===a.parts.length?c.parts.push(a.parts[0]):2<=a.parts.length&&c.parts.push(a);return Math.min.apply(n,n)}),g=0;g<a.parts.length;g++){var s=a.parts[g];if(s.parts){if(0>m(s)&&n)return null}else if(0>l(s)&&n)return null}return c},_getFilterExprByPartsObj:function(a){this._filterUtils.isHosted=l.isHostedService(this.url);return this._filterUtils.getExprByFilterObj(a)},_getSingleFilterParameterBySpId:function(a){return this._spObj[a]},
_getCascadeFilterExpr:function(a){var n="1\x3d1",c={logicalOperator:this.partsObj.logicalOperator,parts:[]},f=b.clone(this.partsObj),l,m,g;l="none";a.interactiveObj&&a.interactiveObj.cascade&&(l=a.interactiveObj.cascade);if("previous"===l)for(l=0;l<f.parts.length;l++)m=f.parts[l],m.majorCascadeIndex<a.majorCascadeIndex?c.parts.push(m):m.parts&&m.majorCascadeIndex===a.majorCascadeIndex&&(g=b.clone(m),g.parts=d.filter(g.parts,b.hitch(this,function(b){return b.minorCascadeIndex<a.minorCascadeIndex})),
c.parts.push(g));else if("all"===l)for(l=0;l<f.parts.length;l++)m=f.parts[l],m.majorCascadeIndex!==a.majorCascadeIndex?c.parts.push(m):m.majorCascadeIndex===a.majorCascadeIndex&&m.parts&&(g=b.clone(m),d.some(m.parts,b.hitch(this,function(b){return b.spId===a.spId}))&&(g.parts=d.filter(g.parts,b.hitch(this,function(b){return b.minorCascadeIndex!==a.minorCascadeIndex})),c.parts.push(g)));(c=this._getNewValidPartsObj(c,!1))&&(n=this._getFilterExprByPartsObj(c));n||(n="1\x3d1");return n},clear:function(){this.featureLayerId=
this.url=null;var n=a(".jimu-widget-query-single-parameter",this.tbody);d.forEach(n,b.hitch(this,function(a){s.byNode(a).destroy()}));m.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(c,f,l,g){var s=new e;this.clear();this.url=c;this.layerInfo=f;this.partsObj=b.clone(l);this.partsObj=this._updatePartsObj(this.partsObj);this.featureLayerId=g;this._setCascadeIndexForPartsObj(this.partsObj);c=this._getAllInteractiveSinglePartArray(this.partsObj);if(0<c.length){var k=new n({url:this.url,
layerDefinition:f,featureLayerId:this.featureLayerId});c=d.map(c,b.hitch(this,function(d){var n=m.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),n=a("td",n)[0],c=this._getFieldInfo(d.fieldObj.name,this.layerInfo),c=new u({nls:this.nls,url:this.url,layerDefinition:f,fieldInfo:c,part:d,valueProviderFactory:k});this.own(h(c,"change",b.hitch(this,this._onSingleFilterParameterChanged)));c.placeAt(n);c.startup();d.spId=c.id;return this._spObj[c.id]=c}));d.forEach(c,b.hitch(this,function(a){a.valueProvider.getCascadeFilterExpr=
b.hitch(this,this._getCascadeFilterExpr,a.part)}));c=d.map(c,b.hitch(this,function(a){return a.init()}));p(c).then(b.hitch(this,function(){s.resolve()}),b.hitch(this,function(){s.reject()}))}else s.resolve();return s},_updatePartsObj:function(a){d.forEach(a,b.hitch(this,function(a){a.parts?d.forEach(a.parts,b.hitch(this,function(a){a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")})):a.interactiveObj&&
!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")}));return a},_setCascadeIndexForPartsObj:function(a){for(var b=0;b<a.parts.length;b++){var d=a.parts[b];d.majorCascadeIndex="AND"===a.logicalOperator?b:0;d.minorCascadeIndex=0;d.cascadeIndex=d.majorCascadeIndex;if(d.parts)for(var n=0;n<d.parts.length;n++){var c=d.parts[n];c.majorCascadeIndex=d.majorCascadeIndex;c.minorCascadeIndex="AND"===d.logicalOperator?n:0;c.cascadeIndex=
parseFloat(c.majorCascadeIndex+"."+c.minorCascadeIndex)}}},_getFieldInfo:function(a,b){for(var d=b.fields,n=0;n<d.length;n++){var c=d[n];if(a===c.name)return c}return null},_getAllInteractiveSinglePartArray:function(a){for(var b=[],d=0;d<a.parts.length;d++){var n=a.parts[d];if(n.parts)for(var c=0;c<n.parts.length;c++){var f=n.parts[c];f.interactiveObj&&b.push(f)}else n.interactiveObj&&b.push(n)}return b},_onSingleFilterParameterChanged:function(){this.emit("change",this.getFilterExpr(!1))}})})},"jimu/dijit/_SingleFilterParameter":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang".split(" "),
function(h,q,e,p,r,k,c,g,b){return p([r,k,c,q],{baseClass:"jimu-single-filter-parameter",templateString:g,valueProvider:null,nls:null,url:null,layerDefinition:null,fieldInfo:null,part:null,valueProviderFactory:null,postCreate:function(){this.inherited(arguments);this.valueProvider=this.valueProviderFactory.getValueProvider(this.part,!0);this.valueProvider.placeAt(this.valueProviderTd);this.own(h(this.valueProvider,"change",b.hitch(this,this._onValueProviderChanged)));this.valueProvider.bindChangeEvents()},
getValueObject:function(){return this.valueProvider.getValueObject()},init:function(){return this.build(this.fieldInfo,this.part)},build:function(b,d){var a=null;this.fieldInfo=b;this.part=d;if(a=d.interactiveObj)this.promptNode.innerHTML=a.prompt||"",this.hintNode.innerHTML=a.hint||"";a=this.valueProvider.setValueObject(this.part.valueObj);a&&"function"===typeof a.then||(a=new e,a.resolve());return a},disable:function(){this.valueProvider.disable()},enable:function(){this.valueProvider.enable()},
isEnabled:function(){return this.valueProvider.isEnabled()},getStatus:function(){return this.valueProvider.getStatus()},_showValidationErrorTip:function(b){!b.validate()&&b.domNode&&b.focusNode&&(b.focusNode.focus(),b.focusNode.blur())},_onValueProviderChanged:function(){this.emit("change")}})})},"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider jimu/LayerInfos/LayerInfos".split(" "),
function(h,q,e,p,r,k,c,g,b){var m={stringOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",
supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorStartsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorEndsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorContains:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorDoesNotContain:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},stringOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtLeast:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsLessThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtMost:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsGreaterThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsNotBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},
dateOperatorIsOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}}},d=e([],{nls:null,url:null,layerDefinition:null,layerInfo:null,featureLayerId:null,
constructor:function(a){h.mixin(this,a);this.nls=window.jimuNls.filterBuilder;a=b.getInstanceSync();this.featureLayerId&&(this.layerInfo=a.getLayerOrTableInfoById(this.featureLayerId))},getSupportedValueTypes:function(a,b){var d=[],c=m[b];c&&(c.value&&d.push("value"),c.field&&0<this._getSameShortTypeFieldNames(a).length&&d.push("field"),c.unique&&this.url&&(this._isStreamServer(this.url)||10.1<=parseFloat(this.layerDefinition.currentVersion)&&d.push("unique")));return d},_isStreamServer:function(a){a=
(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_getSameShortTypeFieldNames:function(a){var b=[],c=this._getFieldInfo(this.layerDefinition,a),l=d.getShortTypeByEsriType(c.type);q.forEach(this.layerDefinition.fields,h.hitch(this,function(c){c.name!==a&&d.getShortTypeByEsriType(c.type)===l&&b.push(c.name)}));return b},getValueProvider:function(a,b){var d=null,l=h.clone(m[a.operator]);if(l){var e=a.valueObj.type,n=a.fieldObj.name,w=this._getFieldInfo(this.layerDefinition,n),A=l[e],x=A.normalProviderType,
y=null,z=this._getCodedValues(w);!z&&this.layerDefinition.typeIdField===n&&(z=this._getSubTypes(this.layerDefinition));"field"===e?(e=this._getSameShortTypeFieldNames(n),0<e.length&&(y=q.map(e,h.hitch(this,function(a){return{value:a,label:a}})))):z&&(0<z.length&&A.codedValueProviderType)&&(x=A.codedValueProviderType);l={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:a,fieldInfo:w,codedValues:z,staticValues:y,layerInfo:this.layerInfo,operatorInfo:l,filterCodedValueIfPossible:!!A.filterCodedValueIfPossible,
runtime:b};"BLANK_VALUE_PROVIDER"===x?d=new p(l):"SIMPLE_VALUE_PROVIDER"===x?d=new r(l):"TWO_NUMBERS_VALUE_PROVIDER"===x?d=new k(l):"TWO_DATES_VALUE_PROVIDER"===x?d=new c(l):"LIST_VALUE_PROVIDER"===x&&(l.showNullValues=!1,d=new g(l))}return d},_getFieldInfo:function(a,b){for(var d=a.fields,c=0;c<d.length;c++){var g=d[c];if(b===g.name)return g}return null},_getCodedValues:function(a){var b=null;if((a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length)b=a.codedValues,b=q.map(b,
h.hitch(this,function(a){return{value:a.code,label:a.name}}));return b},_getSubTypes:function(a){var b=null;a.typeIdField&&(a.types&&0<a.types.length)&&(b=q.map(a.types,h.hitch(this,function(a){return{value:a.id,label:a.name}})));return b}});d.getOperatorInfo=function(a){return h.clone(m[a])};d.getOperatorsByShortType=function(a){var b=[];"string"===a?b="stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsBlank stringOperatorIsNotBlank".split(" "):
"number"===a?b="numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsLessThan numberOperatorIsAtMost numberOperatorIsGreaterThan numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" "):"date"===a&&(b="dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "));return b};d.getShortTypeByEsriType=function(a){var b=
null;"esriFieldTypeString"===a?b="string":"esriFieldTypeDate"===a?b="date":0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a)&&(b="number");return b};return d})},"jimu/dijit/_filter/BlankValueProvider":function(){define(["dojo/_base/html","dojo/_base/declare","./ValueProvider"],function(h,q,e){return q([e],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,
"jimu-filter-blank-value-provider")},getDijits:function(){return[]},getStatus:function(){return 1},setValueObject:function(){},getValueObject:function(){return{isValid:!0,type:this.partObj.valueObj.type,value:null}},isBlankValueProvider:function(){return!0}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils esri/lang".split(" "),function(h,q,e,p,r,k,c,
g,b,m){return k([c,g,q],{baseClass:"jimu-filter-value-provider",fieldName:null,shortType:null,_enabled:!1,cascade:"none",filterCodedValue:!1,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,runtime:!0,staticValues:null,codedValues:null,layerInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;this.cascade=this.partObj.interactiveObj&&
this.partObj.interactiveObj.cascade;this.runtime&&this.codedValues&&this.filterCodedValueIfPossible&&b.isCodedValuesSupportFilter(this.layerDefinition,this.codedValues.length)?this.filterCodedValue=!0:this.filterCodedValue=!1},getDijits:function(){return[]},bindChangeEvents:function(){var b=this.getDijits();r.forEach(b,e.hitch(this,function(a){a.declaredClass&&0===a.declaredClass.indexOf("dijit.")&&p.addClass(a.domNode,a.declaredClass.replace(/\./g,"-"));this.own(h(a,"change",e.hitch(this,this._onChanged)))}))},
_onChanged:function(){this.emit("change")},tryLocaleNumber:function(d){var a=b.localizeNumber(d);if(null===a||void 0===a)a=d;return a},getPartObject:function(){var b=this.getValueObject();if(!b)return null;var a=e.clone(this.partObj);a.valueObj=b;return a},setValueObject:function(){},getValueObject:function(){},tryGetValueObject:function(){return this.getValueObject()},setRequired:function(){},getStatus:function(){var b=1,a=this.getDijits();0<a.length&&(b=r.map(a,e.hitch(this,function(a){return this.getStatusForDijit(a)})),
b=Math.min.apply(b,b));return b},getStatusForDijit:function(b){return b.validate()?b.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},isBlankValueProvider:function(){return!1},getFilterExpr:function(){var b="1\x3d1",b=this.getLayerFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var a=this.getCascadeFilterExpr(),b="("+b+") AND ("+a+")";return b},
getLayerFilterExpr:function(){var b="1\x3d1";this.layerInfo&&(b=this.layerInfo.getFilter());b||(b="1\x3d1");return b},getCascadeFilterExpr:function(){return"1\x3d1"},isDefined:function(b){return m.isDefined(b)},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(h,q,e,p,r,k){return q([e],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-filter-simple-value-provider");this._dijit="string"===this.shortType?new p({required:!1,trim:!0}):"number"===this.shortType?new k({required:!1,intermediateChanges:!0,constraints:{pattern:"#####0.##########"}}):new r({required:!1,trim:!0,value:new Date});h.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},
getDijits:function(){return[this._dijit]},setValueObject:function(c){this.isDefined(c.value)&&("date"===this.shortType?this._dijit.set("value",new Date(c.value)):this._dijit.set("value",c.value))},getValueObject:function(){if(this.isValidValue()){var c=this._dijit.get("value");"date"===this.shortType?c=c.toDateString():"number"===this.shortType&&(c=parseFloat(c));return{isValid:!0,type:this.partObj.valueObj.type,value:c}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():
this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(c){this._dijit.set("required",c)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(h,q,e){return h("dijit.form.DateTextBox",e,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:q,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(h,q,e,p,r,k,c,g,b,m,d,a,s,f,l,u,n){var w=p("dijit.Calendar",[s,f,l],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){g.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new w._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:m.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"keydown",m.hitch(this,"_onKeyDown")),d(this.dateRowsNode,"mouseover",m.hitch(this,"_onDayMouseOver")),d(this.dateRowsNode,"mouseout",m.hitch(this,"_onDayMouseOut")),d(this.dateRowsNode,"mousedown",m.hitch(this,"_onDayMouseDown")),d(this.dateRowsNode,"mouseup",m.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=k.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!k.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))k.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",k.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),k.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!k.contains(a,"dijitCalendarDisabledDate"))k.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&k.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var c=-1,n,d=this.currentFocus;switch(a.keyCode){case b.RIGHT_ARROW:c=1;case b.LEFT_ARROW:n="day";this.isLeftToRight()||(c*=-1);break;case b.DOWN_ARROW:c=1;case b.UP_ARROW:n="week";break;case b.PAGE_DOWN:c=1;case b.PAGE_UP:n=a.ctrlKey||a.altKey?"year":"month";break;case b.END:d=this.dateModule.add(d,"month",1),n="day";case b.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}n&&(d=this.dateModule.add(d,n,c));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});w._MonthDropDownButton=p("dijit.Calendar._MonthDropDownButton",n,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new w._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(b){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.dropDown.set("months",
c);this.containerNode.innerHTML=(6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[b.getMonth()]+"\x3c/div\x3e"}});w._MonthDropDown=p("dijit.Calendar._MonthDropDown",[f,u,l],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";h.forEach(a,function(a,b){c.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(r.get(a.target,"month"))},onChange:function(){}});return w})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(h,q,e,p,r,k,c,g,b,m,d,a,s,f,l){var u=q("dijit.CalendarLite",[s,f],{templateString:l,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=k.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&
(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),d=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),l=new this.dateClassObj,g=0<=this.dayOffset?this.dayOffset:e.getFirstDayOfWeek(this.lang);g>b&&
(g-=7);if(!this.summary){var f=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",f[a.getMonth()])}this._date2cell={};h.forEach(this.dateCells,function(f,m){var k=m+g,e=new this.dateClassObj(a),s="dijitCalendar",h=0;k<b?(k=d-b+k+1,h=-1,s+="Previous"):k>=b+c?(k=k-b-c+1,h=1,s+="Next"):(k=k-b+1,s+="Current");h&&(e=this.dateModule.add(e,"month",h));e.setDate(k);this.dateModule.compare(e,l,"date")||(s="dijitCalendarCurrentDate "+s);this.isDisabledDate(e,
this.lang)?(s="dijitCalendarDisabledDate "+s,f.setAttribute("aria-disabled","true")):(s="dijitCalendarEnabledDate "+s,f.removeAttribute("aria-disabled"),f.setAttribute("aria-selected","false"));(h=this.getClassForDate(e,this.lang))&&(s=h+" "+s);f.className=s+"Month dijitCalendarDateTemplate";s=e.valueOf();this._date2cell[s]=f;f.dijitDateValue=s;this._setText(this.dateLabels[m],e.getDateLocalized?e.getDateLocalized(this.lang):e.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);
a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;h.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?b.getObject(a.datePackage,!1):p;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?
b.getObject(a.datePackage+".locale",!1):r},_createMonthWidget:function(){return u._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var b=this.dowTemplateString,d=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),f=0<=this.dayOffset?this.dayOffset:e.getFirstDayOfWeek(this.lang);this.dayCellsHtml=a.substitute([b,b,b,b,b,b,b].join(""),{d:""},function(){return d[f++%7]});b=a.substitute(this.weekTemplateString,
{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);c.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=b.hitch(this,function(a,c,d){this[a].dojoClick=!0;return m(this[a],"click",b.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,
c,d))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,f=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(c,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||
b)&&c.focus();f&&f!=c&&(d("webkit")?f.setAttribute("tabIndex","-1"):f.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!g.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function c(a,
b){g.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}h.forEach(this._selectedCells||[],b.partial(c,!1));this._selectedCells=h.filter(h.map(a,this._getNodeByDate,this),function(a){return a});h.forEach(this._selectedCells,b.partial(c,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});u._MonthWidget=q("dijit.CalendarLite._MonthWidget",s,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",
this.lang,a),c=6==d("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+h.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return u})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(h,q,e,p,r,k,c,g){new Date("X");return p("dijit.form._DateTimeTextBox",[k,c],{templateString:g,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:q.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(b,c){var d=this._isInvalidDate(b),a=this._isInvalidDate(c);if(d||a)return d&&a?0:!d?1:-1;var d=this.format(b,this._unboundedConstraints),a=this.format(c,this._unboundedConstraints),
g=this.parse(d,this._unboundedConstraints),f=this.parse(a,this._unboundedConstraints);return d==a?0:h.compare(g,f,this._selector)},autoWidth:!0,format:function(b,c){return!b?"":this.dateLocaleModule.format(b,c)},parse:function(b,c){return this.dateLocaleModule.parse(b,c)||(this._isEmpty(b)?null:void 0)},serialize:function(b,c){b.toGregorian&&(b=b.toGregorian());return e.toISOString(b,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(b){b=
b||{};this.dateModule=b.datePackage?r.getObject(b.datePackage,!1):h;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=b.datePackage?r.getObject(b.datePackage+".locale",!1):q;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(b){b.selector=this._selector;b.fullYear=!0;var c=e.fromISOString;"string"==typeof b.min&&(b.min=c(b.min),this.dateClassObj instanceof Date||(b.min=new this.dateClassObj(b.min)));"string"==typeof b.max&&(b.max=c(b.max),this.dateClassObj instanceof Date||(b.max=new this.dateClassObj(b.max)));this.inherited(arguments);this._unboundedConstraints=r.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(b){return!b||
isNaN(b)||"object"!=typeof b||b.toString()==this._invalidDate},_setValueAttr:function(b,c,d){void 0!==b&&("string"==typeof b&&(b=e.fromISOString(b)),this._isInvalidDate(b)&&(b=null),b instanceof Date&&!(this.dateClassObj instanceof Date)&&(b=new this.dateClassObj(b)));this.inherited(arguments,[b,c,d]);this.value instanceof Date&&(this.filterString="");!1!==c&&this.dropDown&&this.dropDown.set("value",b,!1)},_set:function(b,c){if("value"==b){c instanceof Date&&!(this.dateClassObj instanceof Date)&&
(c=new this.dateClassObj(c));var d=this._get("value");if(d instanceof this.dateClassObj&&0==this.compare(c,d))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(b){this._isInvalidDate(b)&&(b=new this.dateClassObj);this._set("dropDownDefaultValue",b)},openDropDown:function(b){this.dropDown&&this.dropDown.destroy();var c=r.isString(this.popupClass)?r.getObject(this.popupClass,!1):this.popupClass,d=this,a=this.get("value");this.dropDown=new c({onChange:function(a){d.set("value",
a,!0)},id:this.id+"_popup",dir:d.dir,lang:d.lang,value:a,textDir:d.textDir,currentFocus:!this._isInvalidDate(a)?a:this.dropDownDefaultValue,constraints:d.constraints,filterString:d.filterString,datePackage:d.datePackage,isDisabledDate:function(a){return!d.rangeCheck(a,d.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(b,c){this._setValueAttr(this.parse(b,this.constraints),c,b)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox".split(" "),
function(h,q,e,p,r,k){return q([e,p,r],{templateString:k,postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-two-numbers-filter-value-provider")},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var c=parseFloat(this._dijit1.get("value")),g=parseFloat(this._dijit2.get("value"));c>g&&(this._dijit1.set("value",g),this._dijit2.set("value",c))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(c){this.isDefined(c.value1)&&
this._dijit1.set("value",c.value1);this.isDefined(c.value2)&&this._dijit2.set("value",c.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var c={isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))};
isNaN(c.value1)&&(c.value1=null);isNaN(c.value2)&&(c.value2=null);return c}return null},setRequired:function(c){this._dijit1.set("required",c);this._dijit2.set("required",c)}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoDatesValueProvider.html dijit/form/DateTextBox".split(" "),function(h,q,e,p,r,k){return q([e,p,r],{templateString:k,postCreate:function(){this.inherited(arguments);
h.addClass(this.domNode,"jimu-two-dates-filter-value-provider")},_onRangeDateBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var c=this._dijit1.get("value"),g=c.getTime(),b=this._dijit2.get("value"),k=b.getTime();g>k&&(this._dijit1.set("value",b),this._dijit2.set("value",c))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(c){this.isDefined(c.value1)&&this._dijit1.set("value",new Date(c.value1));this.isDefined(c.value2)&&this._dijit2.set("value",
new Date(c.value2))},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:this._dijit1.get("value").toDateString(),value2:this._dijit2.get("value").toDateString()}:null},setRequired:function(c){this._dijit1.set("required",c);this._dijit2.set("required",c)}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListValueProvider.html dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),
function(h,q,e,p,r,k,c,g,b,m,d,a){return k([c,g,b],{templateString:m,codedValues:null,staticValues:null,showNullValues:!1,postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-filter-list-value-provider");this._uniqueValueCache={};var a=new d({idProperty:"id",data:[]});this.valuesSelect.set("store",a);!this.staticValues&&"function"===typeof this.valuesSelect._onDropDownMouseDown&&(!this.codedValues||this.codedValues&&this.filterCodedValue)&&this.own(h.before(this.valuesSelect,
"_onDropDownMouseDown",e.hitch(this,this._onBeforeDropDownMouseDown)))},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,!0);return arguments},getDijits:function(){return[this.valuesSelect]},setValueObject:function(a){return this.staticValues?this._setValueForStaticValues(a.value,this.staticValues):this.codedValues?this.filterCodedValue?this._tryUpdatingUniqueValues(a.value,!1):this._setValueForStaticValues(a.value,this.codedValues):this._tryUpdatingUniqueValues(a.value,
!1)},getValueObject:function(){if(this.isValidValue()){var a=this.valuesSelect.get("item").value;return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(a){this.valuesSelect.set("required",a)},_setValueForStaticValues:function(a,b){var c=null,d=-1,c=null;b&&(c=r.map(b,e.hitch(this,
function(b,c){var f={id:c,value:b.value,label:b.label};f.value===a&&(d=c);return f})),this.valuesSelect.store.setData(c),0<=d&&(c=this.valuesSelect.store.get(d))&&this.valuesSelect.set("item",c))},_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(a,b){var c=new q;if(this.valuesSelect._opened)c.resolve();else{var d=this.getFilterExpr();d!==this._uniqueValueLoadingExpr?(this.valuesSelect.readOnly=!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),
this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=d,this._uniqueValueLoadingDef=this._getUniqueValues(d),this._uniqueValueLoadingDef.then(e.hitch(this,function(d){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(a,d),this._hideLoadingIcon(),b&&this.valuesSelect.toggleDropDown(),c.resolve())}),e.hitch(this,function(a){console.error(a);this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),
c.reject(a))}))):c.resolve()}return c},_setValueForUniqueValues:function(a,b){b.sort(function(a,b){return a.value<b.value?-1:a.value===b.value?0:1});this.showNullValues||(b=r.filter(b,e.hitch(this,function(a){return"\x3cNull\x3e"!==a.value&&null!==a.value})));if(void 0===a){var c=this.getValueObject();c&&(a=c.value)}var d=-1,c=null,g=r.map(b,e.hitch(this,function(b,c){var g={id:c,value:b.value,label:b.label};b.value===a&&(d=c);return g}));this.valuesSelect.store.setData(g);0<=d&&(c=this.valuesSelect.store.get(d));
this.valuesSelect.set("item",c)},_showLoadingIcon:function(){p.addClass(this.valuesSelect.domNode,"loading")},_hideLoadingIcon:function(){p.removeClass(this.valuesSelect.domNode,"loading")},_getUniqueValues:function(b){var c=new q;this._uniqueValueCache[b]?c.resolve(this._uniqueValueCache[b]):(this._showLoadingIcon(),a.getUniqueValues(this.url,this.fieldName,b,this.layerDefinition).then(e.hitch(this,function(a){this.domNode&&(this._uniqueValueCache[b]=a,c.resolve(a),this._hideLoadingIcon())}),e.hitch(this,
function(a){this.domNode&&(c.reject(a),this._hideLoadingIcon())})));return c}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(h,q,e,p,r){return h("dijit.form.FilteringSelect",[p,r],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},
_callbackSetLabel:function(k,c,g,b){c&&c[this.searchAttr]!==this._lastQuery||!c&&k.length&&this.store.getIdentity(k[0])!=this._lastQuery||(k.length?this.set("item",k[0],b):this.set("value","",b||void 0===b&&!this.focused,this.textbox.value,null))},_openResultList:function(k,c,g){c[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(k,
c,g,b){this._onChangeActive||(c=null);if(void 0===b){if(null===k||""===k)if(k="",!q.isString(g)){this._setDisplayedValueAttr(g||"",c);return}var m=this;this._lastQuery=k;e(this.store.get(k),function(b){m._callbackSetLabel(b?[b]:[],void 0,void 0,c)})}else this.valueNode.value=k,this.inherited(arguments,[k,c,g,b])},_setItemAttr:function(k,c,g){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(k){return k.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(k,
c){null==k&&(k="");if(!this._created){if(!("displayedValue"in this.params))return;c=!1}if(this.store){this.closeDropDown();var g=q.clone(this.query),b=this._getDisplayQueryString(k),m;this.store._oldAPI?m=b:(m=this._patternToRegExp(b),m.toString=function(){return b});this._lastQuery=g[this.searchAttr]=m;this._lastDisplayedValue=this.textbox.value=k;this._set("displayedValue",k);var d=this,a={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};q.mixin(a,this.fetchProperties);this._fetchHandle=this.store.query(g,
a);e(this._fetchHandle,function(b){d._fetchHandle=null;d._callbackSetLabel(b||[],g,a,c)},function(a){d._fetchHandle=null;d._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"widgets/GroupFilter/SaveJSON":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/html dojo/has jimu/utils".split(" "),function(h,q,e,p,r,k){return q([h],{declaredClass:"saveJSON",config:null,constructor:function(c){q.safeMixin(this,
c)},_getDownloadUrl:function(c){return window.Blob&&window.URL&&window.URL.createObjectURL?(c=new Blob([c],{type:"text/json"}),URL.createObjectURL(c)):"data:attachment/json;charset\x3dutf-8,"+encodeURIComponent(c)},exportsJson:function(c,g){var b=JSON.stringify(g),k=new e;try{if(r("ie")&&10>r("ie")){var d=window.top.open("about:blank","_blank");d.document.write("sep\x3d,\r\n"+b);d.document.close();d.document.execCommand("SaveAs",!0,c);d.close();this.savePrompt()}else if(10===r("ie")||this._isIE11()||
this._isEdge()){var a=new Blob([b],{type:"text/json"});navigator.msSaveBlob(a,c);this.savePrompt()}else{var h=p.create("a",{href:this._getDownloadUrl(b),target:"_blank",download:c},document.body);if(r("safari")){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0);h.dispatchEvent(f)}else h.click();this.savePrompt();p.destroy(h)}k.resolve()}catch(l){k.reject(l)}return k},_isIE11:function(){return 11===k.has("ie")},_isEdge:function(){return k.has("edge")},savePrompt:function(){this.emit("complete",
{})}})})},"widgets/GroupFilter/ReadJSON":function(){define("dojo/Evented dojo/_base/declare dojo/has dojo/_base/lang jimu/utils jimu/dijit/Message".split(" "),function(h,q,e,p,r,k){return q([h],{declaredClass:"readJSON",config:null,jsonFile:null,constructor:function(c){q.safeMixin(this,c)},checkFileReader:function(){this.supportHTML5()?(console.log("HTML 5 loader"),this._processFiles(this.jsonFile)):!this.supportHTML5()&&!e("safari")&&this.isEnabledFlash()?r.file.loadFileAPI().then(p.hitch(this,function(){console.log("loading FileAPI")})):
console.log("no loader")},_processFiles:function(c){0<c.length&&(c=c[0],-1!==c.name.indexOf(".json")?c&&this.handleJson(c):new k({message:"Not a json file"}))},handleJson:function(c){if(this.supportHTML5()){var g=new FileReader;g.onload=function(b){return function(){-1<g.result.indexOf("groups")?b.completePrompt(g.result):(new k({message:"json file is Invalid"}),b.errorPrompt("error"))}}(this);g.readAsText(c)}else window.FileAPI.readAsText(c,p.hitch(this,function(b){}))},supportHTML5:function(){return window.File&&
window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return e("safari")&&6>e("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var c=null;if(document.all)try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(g){c=null}else navigator.plugins&&0<navigator.plugins.length&&(c=navigator.plugins["Shockwave Flash"]);return!!c},completePrompt:function(c){this.emit("complete",{UserSettings:c})},errorPrompt:function(){this.emit("error",
{UserSettings:"error"})}})})},"widgets/GroupFilter/LayersHandler":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/request".split(" "),function(h,q,e,p,r,k,c){return q([h],{declaredClass:"LayersHandler",layers:null,layerStore:[],fieldName:null,childList:null,validFieldTypes:"esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeDouble esriFieldTypeSingle esriFieldTypeString esriFieldTypeDate esriFieldTypeGeometry esriFieldTypeOID esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeXML".split(" "),
layersOnly:!1,constructor:function(c){q.safeMixin(this,c)},getAllMapLayers:function(){var c=[],b=new r,m;this.layerStore=[];p.forEach(this.layers,e.hitch(this,function(b){b.featureCollection||("undefined"!==typeof b.originOperLayer&&b.originOperLayer.layerType&&("ArcGISFeatureLayer"===b.originOperLayer.layerType||"ArcGISImageServiceLayer"===b.originOperLayer.layerType)?"undefined"===typeof b.originOperLayer.featureCollection&&(m={label:b.title,id:b.id,url:b.url,fieldName:this.fieldName,type:"Feature Layer",
checked:!1,children:[],layer:b.layerObject},c.push(this._getLayerInfo(m)),this.layerStore.push(m)):0<b.newSubLayers.length?(this.childList=[],"undefined"!==typeof b.originOperLayer.layerType&&"ArcGISTiledMapServiceLayer"===b.originOperLayer.layerType||(p.forEach(b.layerObject.layerInfos,e.hitch(this,function(a){a={label:a.name,id:b.id+"."+a.id,url:b.originOperLayer.url+"/"+a.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:b.layerObject};this.childList.push(a);c.push(this._getLayerInfo(a))})),
m={label:b.title,id:b.id,url:b.originOperLayer.url,type:"Service",checked:!1,children:this.childList,layer:b.layerObject},this.layerStore.push(m))):"ArcGISMapServiceLayer"===b.originOperLayer.layerType&&(this.childList=[],p.forEach(b.layerObject.layerInfos,e.hitch(this,function(a){a={label:a.name,id:b.id+"."+a.id,url:b.originOperLayer.url+"/"+a.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:b.layerObject};this.childList.push(a);c.push(this._getLayerInfo(a))})),m={label:b.title,
id:b.id,url:b.originOperLayer.url,type:"MapService",checked:!1,children:this.childList,layer:b.layerObject},this.layerStore.push(m)))}));k(c).then(e.hitch(this,function(){var c=this._controlComplete();this.emit("complete",c);b.resolve(c)}),e.hitch(this,function(){b.resolve(null)}));return b.promise},_getLayerInfo:function(g){var b=new r;g.url?0===g.url.length?b.resolve():c({url:g.url,content:{f:"json"},callbackParamName:"callback"}).then(e.hitch(this,function(c){if(c.hasOwnProperty("fields")&&!1===
this.layersOnly){var d=p.map(c.fields,e.hitch(this,function(a){return{label:a.alias,id:g.id+"."+a.name,name:a.name,type:"Field",fieldType:a.type,checked:!1}})),d=p.filter(d,e.hitch(this,function(a){return 0<=p.indexOf(this.validFieldTypes,a.fieldType)}));g.children=d}g.geometryType=c.geometryType;g.visible=!0;this.geometryTypes&&!p.some(this.geometryTypes,function(a){if(a===g.geometryType)return!0})&&(g.visible=!1);b.resolve(c)}),function(){b.resolve(null)}):b.resolve();return b.promise},_controlComplete:function(){p.forEach(this.layerStore,
function(c){if(c.children&&0<c.children.length){var b=p.filter(c.children,function(b){return b.hasOwnProperty("visible")?b.visible:!0});c.children=b;0===c.children.length&&(c.visible=!1)}});return this.store={data:{identifier:"id",label:"label",items:p.filter(this.layerStore,function(c){return c.hasOwnProperty("visible")?c.visible:!0})}}}})})},"widgets/GroupFilter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},
"url:jimu/dijit/templates/_SingleFilterParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr class\x3d"first-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"second-tr"\x3e\r\n        \x3ctd data-dojo-attach-point\x3d"valueProviderTd"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"third-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/ListValueProvider.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"valuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/GroupFilter/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"groupContainer" data-dojo-attach-point\x3d"widgetIntro"\x3e\r\n\t\t\x3cdiv class\x3d"group-picker"\x3e\r\n\t\t\t\x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"groupHeader"\x3e${nls.labels.selectGroup}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"saveTD" data-dojo-attach-point\x3d"optionsIcon" id\x3d"saveTD" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\x3cdiv data-dojo-attach-point\x3d"groupPicker" id\x3d"groupPicker"\x3e\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" id\x3d"groupDesc" data-dojo-attach-point\x3d"groupDesc"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"container" data-dojo-attach-point\x3d"filterBlock" id\x3d"filterBlock"\x3e\r\n\t\t\x3cdiv class\x3d"filter-block" data-dojo-attach-point\x3d"filterBlockInner" id\x3d"filterBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblPredicates" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"saveContainer" data-dojo-attach-point\x3d"saveBlock" id\x3d"saveBlock"\x3e\r\n\t\t\x3cdiv class\x3d"save-block" data-dojo-attach-point\x3d"saveBlockInner" id\x3d"saveBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdFirstLabel"\x3e${nls.labels.saveHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"close-save" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cdiv class\x3d"jimu-btn saveFunction" data-dojo-attach-event\x3d"click:saveJsonToFile" \x3e${nls.buttons.save}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.uploadHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"file" id\x3d"jsonFileInput" data-dojo-attach-point\x3d"jsonFileInput" data-dojo-attach-event\x3d"change:readJsonToConfig" accept\x3d".json"\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"loadProgressHeader" id\x3d"tdProgress"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\x3cbr\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.layerOptionHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr style\x3d"height:0px; display:none;"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkAppendToDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.AppendDefHeading}\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"slAppendChoice" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"OR"\x3e${nls.inputs.optionOR}\x3c/option\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"AND"\x3e${nls.inputs.optionAND}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkPersistDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.PersistDefHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\r\n\t\x3cdiv class\x3d"buttonContainer"\x3e\r\n\t\t\x3ctable class\x3d"buttonContainerTable" border\x3d0\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"filter-add-criteria"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnCriteria" data-dojo-attach-event\x3d"click:btnNewRowAction"\x3e${nls.buttons.addCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3ctable class\x3d"buttonContainerSubtable" border\x3d0\x3e\r\n\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-apply"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"click:setFilterLayerDef"\x3e${nls.buttons.applyCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-cancel"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnReset" data-dojo-attach-event\x3d"click:resetLayerDef"\x3e${nls.buttons.removeCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/css/style.css":'.jimu-widget-map-filter {width:100%; height:100%;}.jimu-widget-map-filter .groupContainer {display: block;}.jimu-widget-map-filter .container {border-color: #e1e1e1; border-top: 3px solid; width: 100%; height: 60%; position:relative; overflow-y: auto; overflow-x: auto; display: block;}.jimu-widget-map-filter .saveContainer {width: 100%; height: 100%; position:absolute; top: 0px; left: 0px; z-index: 999; overflow-y: auto; overflow-x: auto; display: none;}.jimu-widget-map-filter .save-block {position: absolute; left: 5px;}.jimu-widget-map-filter .close-save {position:relative; float: right; content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .close-save:after {position:relative; float: right; content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .headerTable {width: 100%;}.jimu-widget-map-filter .groupHeader {font-size: 10pt; padding-left: 0px; padding-bottom: 5px; width: 100%;}.jimu-widget-map-filter .saveTD {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTD:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose:after {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .group-picker {padding-bottom: 5px;}.jimu-widget-map-filter .filter-block {position: absolute; left: 0px; top: 5px;}.jimu-widget-map-filter .filter-row {position: relative; width: 100%;}.jimu-widget-map-filter .tableFormat {table-layout: fixed; width:100%;}.jimu-widget-map-filter .rowHeader {color: #000000;}.jimu-widget-map-filter .saveFunction {margin-top: 5px;}.jimu-widget-map-filter .tableRow {background-color: #E3E3E3;}.jimu-widget-map-filter .tdOperatorHide {display: block; width: 75px;}.jimu-widget-map-filter .operatorSelect {}.jimu-widget-map-filter .tdValue {width: 200px; height: 20px; padding-left: 5px;}.jimu-widget-map-filter .userInputNormal {width: 95%;}.jimu-widget-map-filter .tdConjunction {width: 75px;}.jimu-widget-map-filter .conjuncSelect {width: 70px;}.jimu-widget-map-filter .tdRemove {width: 16px; text-align: right;}.jimu-widget-map-filter .tdFirstLabel {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdLabel {text-align: left; padding-left: 5px; padding-top: 15px; padding-bottom: 2px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdData {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 5px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdUploadData {text-align: left; padding-left: 5px; padding-top: 10px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdSave {text-align: right; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .loadProgressHeader {display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow:after {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .advModeOffset {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeOffset:after {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeClose {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeClose:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeOpen {content: url(""); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .deleteCell {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:after {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:hover {content: url("../images/delete_hover.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .buttonContainer {position: absolute; left: 0px; bottom: 0px; width: 100%;}.jimu-widget-map-filter .buttonContainerTable {width: 100%;}.jimu-widget-map-filter .buttonContainerSubtable {float: right;}.jimu-widget-map-filter .filter-add-criteria {text-align: left;}.jimu-widget-map-filter .filter-button-apply {text-align: right; padding-right: 5px;}.jimu-widget-map-filter .filter-button-cancel {text-align: right;}.jimu-widget-map-filter .criteriaCellSize {width: 90%; vertical-align: top; padding-top: 5px; padding-left: 2px;}.jimu-widget-map-filter .deleteCellSize {width: 20px; text-align: right; vertical-align: top; padding-top: 5px;}.jimu-widget-map-filter .hide-items {display: none;}.jimu-widget-map-filter .operator-class {}.jimu-widget-map-filter .value-class {}',
"*now":function(h){h(['dojo/i18n!*preload*widgets/GroupFilter/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit jimu/dijit/FilterParameters dojo/dom dojo/dom-construct dojo/dom-class dojo/dom-attr dojo/dom-style dojo/on dojo/query dojo/string dojo/_base/lang dojo/_base/array dojo/date/locale dijit/form/Select dijit/form/TextBox dijit/form/DateTextBox dijit/form/NumberTextBox dijit/registry jimu/LayerInfos/LayerInfos jimu/utils jimu/FilterManager esri/tasks/query esri/tasks/QueryTask esri/geometry/geometryEngine esri/layers/FeatureLayer ./SaveJSON ./ReadJSON ./LayersHandler dojox/html/entities dijit/form/CheckBox".split(" "),function(h,
q,e,p,r,k,c,g,b,m,d,a,s,f,l,u,n,w,A,x,y,z,v,H,E,D,C,G,I,J,K,F){return h([e,q],{baseClass:"jimu-widget-map-filter",layerList:null,msLayersDesc:null,grpSelect:null,groupCounter:0,groupCurrVal:null,defaultDef:null,runTimeConfig:null,useDomain:null,useDate:null,useValue:null,runInitial:!1,graphicsHolder:null,slAppendChoice:null,chkAppendToDef:null,filterExt:null,postCreate:function(){this.inherited(arguments);this.defaultDef=[];this.graphicsHolder=[]},startup:function(){this.inherited(arguments);this.config.optionsMode&&
g.add(this.optionsIcon,"hide-items");""!==this.config.groups[0].defaultVal&&""!==this.config.groups[0].operator&&(this.runInitial=!0);"undefined"!==typeof this.config.webmapAppendMode&&(this.chkAppendToDef.checked=this.config.webmapAppendMode,this.slAppendChoice.value=this.config.slAppendChoice);this.createMapLayerList()},btnNewRowAction:function(){this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},createMapLayerList:function(){z.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,
function(a){a._layerInfos&&0<a._layerInfos.length&&(this.layerList=a._layerInfos,this._pullMapServiceFields(a._layerInfos),l.forEach(this.layerList,f.hitch(this,function(a){"ArcGISTiledMapServiceLayer"!==a.originOperLayer.layerType&&"undefined"===typeof a.originOperLayer.featureCollection&&("undefined"!==typeof a.layerObject._defnExpr?this.defaultDef.push({layer:a.id,definition:a.layerObject._defnExpr,visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.defaultDefinitionExpression&&
"function"===typeof a.layerObject.getDefinitionExpression()?this.defaultDef.push({layer:a.id,definition:a.layerObject.getDefinitionExpression(),visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.layerDefinitions?this.defaultDef.push({layer:a.id,definition:a.layerObject.layerDefinitions,visible:a._visible}):this.defaultDef.push({layer:a.id,definition:"",visible:a.layerObject.visible}))})))}))},_pullMapServiceFields:function(a){this.msLayersDesc=[];a=new K({layers:a});this.own(d(a,"complete",
f.hitch(this,function(a){l.forEach(a.data.items,f.hitch(this,function(a){0<a.children.length&&this.msLayersDesc.push(a)}));this.createGroupSelection()})));this.own(d(a,"error",f.hitch(this,function(){console.log("error")})));a.getAllMapLayers()},checkDomainUse:function(a){this.useValue=this.useDomain=null;l.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&l.forEach(b.layers,f.hitch(this,function(a){l.forEach(this.layerList,f.hitch(this,function(b){"undefined"!==typeof b.newSubLayers&&
(0<b.newSubLayers.length?l.forEach(this.msLayersDesc,f.hitch(this,function(b){l.forEach(b.children,f.hitch(this,function(b){b.id===a.layer&&l.forEach(b.children,f.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain)}))}))})):a.layer===b.id&&l.forEach(b.layerObject.fields,f.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain,"undefined"!==typeof b.domain&&(this.useDomain=b.domain))})))}))}))}))},checkDateUse:function(a){this.useDate=
null;l.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&l.forEach(b.layers,f.hitch(this,function(a){l.forEach(this.layerList,f.hitch(this,function(b){a.layer===b.id&&l.forEach(b.layerObject.fields,f.hitch(this,function(b){b.name===a.field&&0<=b.type.indexOf("Date")&&(this.useDate=!0)}))}))}))}))},createGroupSelection:function(){var a=[],b="";l.forEach(this.config.groups,f.hitch(this,function(b){var c={};c.value=b.name;c.label=b.name;c.selected=!1;a.push(c)}));this.grpSelect=(new n({options:a})).placeAt(this.groupPicker);
this.grpSelect.startup();this.own(d(this.grpSelect,"change",f.hitch(this,function(a){this.resetLayerDef({group:this.groupCurrVal});this.removeAllRows();this.checkDomainUse({group:a});this.checkDateUse({group:a});this.reconstructRows(a);this.updateGroupDesc(a);this.groupCurrVal=a;setTimeout(f.hitch(this,this.setFilterLayerDef),1E3)})));this.checkDomainUse({group:this.grpSelect.value});this.checkDateUse({group:this.grpSelect.value});this.groupCurrVal=this.grpSelect.value;"undefined"!==typeof this.config.groups[0]&&
(b=this.config.groups[0].desc,this.groupDesc.innerHTML=b);var b=this.checkDefaultValue(this.config.groups[0]),c=this.checkDefaultOperator(this.config.groups[0]);this.createNewRow({operator:c,value:b,conjunc:"OR",state:"new"})},createNewRow:function(b){var d=k.byId("tblPredicates"),t;"new"===b.state&&(1<d.rows.length?(t=d.rows[d.rows.length-1].cells[0].firstChild,t=t.rows[2].cells[0],this.createConditionSelection(t,b)):1===d.rows.length&&(t=d.rows[d.rows.length-1].cells[0].firstChild,t=t.rows[2].cells[0],
this.createConditionSelection(t,b)));t=d.insertRow(-1);var B=t.insertCell(0),l=t.insertCell(1);g.add(B,"criteriaCellSize");g.add(l,"deleteCellSize");var e=c.create("table",{border:"0",width:"100%"},B),B=e.insertRow(-1),h=B.insertCell(0),n=e.insertRow(-1).insertCell(0),e=e.insertRow(-1).insertCell(0);m.set(e,{paddingLeft:"3px",paddingRight:"3px"});g.add(B,"operator-class");this.colorRows();this.createOperatorSelection(h,b);this.removeTableRow(l,t,d.rows.length);this.createInputFilter(n,b);this.resize();
this.config.simpleMode&&(g.add(this.btnCriteria,"hide-items"),g.add(B,"hide-items"),a(".container").style("borderTop","0px"),m.set(n,{paddingLeft:"0px",paddingRight:"0px"}));"reload"===b.state?""!==b.conjunc&&(t=d.rows[d.rows.length-1].cells[0].firstChild,t=t.rows[2].cells[0],this.createConditionSelection(t,b)):this.runInitial&&(this.runInitial=!1,setTimeout(f.hitch(this,this.setFilterLayerDef),1E3))},colorRows:function(){var a=k.byId("tblPredicates").rows;l.forEach(a,function(a,b){0===b%2?g.remove(a,
"tableRow"):g.add(a,"tableRow")})},createOperatorSelection:function(a,b){var c=(new n({options:[{value:"\x3d",label:this.nls.inputs.optionEQUAL},{value:"\x3c\x3e",label:this.nls.inputs.optionNOTEQUAL},{value:"\x3e",label:this.nls.inputs.optionGREATERTHAN},{value:"\x3e\x3d",label:this.nls.inputs.optionGREATERTHANEQUAL},{value:"\x3c",label:this.nls.inputs.optionLESSTHAN},{value:"\x3c\x3d",label:this.nls.inputs.optionLESSTHANEQUAL},{value:"START",label:this.nls.inputs.optionSTART},{value:"END",label:this.nls.inputs.optionEND},
{value:"LIKE",label:this.nls.inputs.optionLIKE},{value:"NOT LIKE",label:this.nls.inputs.optionNOTLIKE}],"class":"operatorSelect"})).placeAt(a);c.startup();c.set("value",F.decode(b.operator));this.own(d(c,"click",f.hitch(this,function(){})));this.own(d(c,"change",f.hitch(this,function(){})))},createInputFilter:function(a,b){c.empty(a);if(null!==this.useDomain)if("undefined"!==typeof this.useDomain.codedValues){var d=new r;d.placeAt(a);d.startup();this.createValueList(b,d)}else d="",""!==b.value&&(d=
Number(b.value)),(new x({value:d,placeHolder:s.substitute(this.nls.inputs.textboxNumber,{"0":this.useDomain.minValue,1:this.useDomain.maxValue}),"class":"userInputNormal",constraints:{min:this.useDomain.minValue,max:this.useDomain.maxValue}})).placeAt(a).startup(),this.formatSpacing(a);else if(!0===this.useValue)d=new r,d.placeAt(a),d.startup(),this.createValueList(b,d);else{if(!0===this.useDate){var d=u.format(""!==b.value?new Date(b.value):new Date,{selector:"date",fullYear:!0}),f=(new A({value:d,
placeHolder:d,"class":"userInputNormal"})).placeAt(a);f.startup();f.set("displayedValue",d)}else(new w({value:b.value,placeHolder:this.nls.inputs.textboxText,"class":"userInputNormal"})).placeAt(a).startup();this.formatSpacing(a)}},createValueList:function(a,b){var c={},g=[],k="";l.forEach(this.config.groups,f.hitch(this,function(e){e.name===this.grpSelect.value&&l.forEach(e.layers,f.hitch(this,function(e){k="";l.forEach(this.layerList,f.hitch(this,function(h){0<h.newSubLayers.length?l.forEach(this.msLayersDesc,
f.hitch(this,function(h){l.forEach(h.children,f.hitch(this,function(l){if(l.id===e.layer){if(k!==l.id&&!0===e.useDomain){var h=new G(l.url);this.own(d(h,"load",f.hitch(this,function(){this._callFilterDijit(e,a,l.url,h,g,c,b)})))}k=l.id}}))})):e.layer===h.id&&!0===e.useDomain&&this._callFilterDijit(e,a,h.layerObject.url,h.layerObject,g,c,b)}))}))}))},_callFilterDijit:function(c,d,g,e,k,h,n){var m={fieldObj:{}};m.fieldObj.name=c.field;m.fieldObj.label=c.field;m.fieldObj.shortType=c.dataType.replace("esriFieldType",
"").toLowerCase();if("guid"!==m.fieldObj.shortType||"globalid"!==m.fieldObj.shortType)m.fieldObj.shortType="string";"date"!==m.fieldObj.shortType&&"string"!==m.fieldObj.shortType&&(m.fieldObj.shortType="number");m.fieldObj.type=c.dataType;m.operator=m.fieldObj.shortType+"OperatorIs";m.valueObj={};m.valueObj.isValid=!0;m.valueObj.type="unique";-1<c.dataType.indexOf("Integer")||-1<c.dataType.indexOf("Double")||-1<c.dataType.indexOf("Short")?m.valueObj.value=this.useDomain?Number(d.value):d.value:m.valueObj.value=
d.value;m.interactiveObj={};m.interactiveObj.prompt="";m.interactiveObj.hint="";m.caseSensitive=!1;k.push(m);h.logicalOperator="OR";h.expr="";h.parts=k;n.build(g,e,h).then(f.hitch(this,function(){}));c=a(".jimu-single-filter-parameter");l.forEach(c,function(c){var d=a("table",c);l.forEach(d,function(a){b.set(a,"cellpadding","1");b.set(a,"cellspacing","1")});c=a("colgroup",c);0<c.length&&b.set(c[0].childNodes[1],"width","0px")})},formatSpacing:function(a){m.set(a,{paddingLeft:"2px",paddingRight:"2px"})},
createConditionSelection:function(a,b){c.empty(a);var d=(new n({options:[{value:"OR",label:this.nls.inputs.optionOR},{value:"AND",label:this.nls.inputs.optionAND}],"class":"conjuncSelect"})).placeAt(a);d.startup();d.set("value",b.conjunc)},removeTableRow:function(a,b,g){1<g&&(g=c.create("div",{"class":"deleteCell",innerHTML:""}),this.own(d(g,"click",f.hitch(this,function(){c.destroy(b);var a=k.byId("tblPredicates");1<=a.rows.length&&c.empty(a.rows[a.rows.length-1].cells[0].firstChild.rows[2].cells[0]);
this.colorRows()}))),c.place(g,a))},removeAllRows:function(){var a=k.byId("tblPredicates");if(1<=a.rows.length){var b=y.byNode(a.rows[0].cells[0].firstChild.rows[1].cells[0].childNodes[0]);"undefined"!==typeof b&&p.byId(b.id).destroyRecursive(!0);c.destroy(a.rows[0]);this.removeAllRows()}},reconstructRows:function(a){""!==a?l.forEach(this.config.groups,f.hitch(this,function(b){if(b.name===a){var c="",d="\x3d";"undefined"!==typeof b.def?0<b.def.length?l.forEach(b.def,f.hitch(this,function(a){this.createNewRow({value:a.value,
operator:a.operator,conjunc:a.conjunc,state:"reload"})})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"}))}})):this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},checkDefaultValue:function(a){var b="";""!==a.defaultVal&&(b=a.defaultVal);return b},checkDefaultOperator:function(a){var b=
"\x3d";""!==a.operator&&(b=a.operator);return b},parseTable:function(){var b=[],c=k.byId("tblPredicates").rows;l.forEach(c,f.hitch(this,function(c,d){if(0<=d){var f=c.cells[0].firstChild,g=y.byNode(f.rows[0].cells[0].childNodes[0]),e=y.byNode(f.rows[1].cells[0].childNodes[0]),k={};"undefined"!==typeof f.rows[2].cells[0].childNodes[0]?k=y.byNode(f.rows[2].cells[0].childNodes[0]):k.value="";var l="";if("undefined"!==typeof e.partsObj){if(e=e.getValueProviders()[0].getValueObject())l=e.value}else l=
e.value;f=a(".dijitReset.dijitInputInner",f.rows[1].cells[0].childNodes[0]);0<f.length&&""===f[0].value&&(l="");b.push({operator:g.value,userValue:l,conjunc:k.value})}}));return b},formatDate:function(a){var b=u.format(a,{datePattern:"yyyy-MM-dd",selector:"date"});a=u.format(a,{selector:"time",timePattern:"HH:mm:ss"});return b+" "+a},createQuery:function(a,b,c,d,f,g){isNaN(d)&&(d=F.decode(d.replace(/'/g,"''")));if(""===d)return"\x3c\x3e"===c||"NOT LIKE"===c?-1<g.indexOf("Double")||-1<g.indexOf("Single")?
[b,"IS NOT NULL",f].join(" ")+" ":[b,"\x3c\x3e '' OR",b,"IS NOT NULL",f].join(" ")+" ":-1<g.indexOf("Double")||-1<g.indexOf("Single")?[b,"IS NULL",f].join(" ")+" ":[b,"\x3d '' OR",b,"IS NULL",f].join(" ")+" ";"LIKE"===c||"NOT LIKE"===c?!1===a?(d="UPPER('%"+d+"%')",b="UPPER("+b+")"):d="'%"+d+"%'":"START"===c?(c="LIKE",!1===a?(d="UPPER('"+d+"%')",b="UPPER("+b+")"):d+="%"):"END"===c?(c="LIKE",!1===a?(d="UPPER('%"+d+"')",b="UPPER("+b+")"):d="%"+d):!1===a&&(-1<g.indexOf("Date")?"\x3d"===c||"\x3c\x3e"===
c?(c="\x3d"===c?"BETWEEN":"NOT BETWEEN",d="'"+this.formatDate(d)+"' AND '"+this.formatDate(d)+"'"):d="'"+this.formatDate(d)+"'":(d="UPPER('"+d+"')",b="UPPER("+b+")"));return[b,c,d,f].join(" ")+" "},setFilterLayerDef:function(){this.filterExt=null;this.graphicsHolder=[];var a=this.parseTable();l.forEach(this.config.groups,f.hitch(this,function(b){if(this.grpSelect.value===b.name){var c=[];l.forEach(this.layerList,f.hitch(this,function(d){var g=[],e="",k="",m="";l.forEach(b.layers,f.hitch(this,function(h,
n){"undefined"!==typeof b.appendSameLayer&&!0===b.appendSameLayer?k!==h.layer?""!==e&&(this.setupFilterToApply(d,m,e,g),e=""):""!==k&&(e=e+" "+b.appendSameLayerConjunc+" ",e===" "+b.appendSameLayerConjunc+" "&&(e="")):e="";if(d.id===h.layer)b.def=[],m="FeatureLayer",l.forEach(a,f.hitch(this,function(a){l.forEach(d.layerObject.fields,f.hitch(this,function(d){if(d.name===h.field){if(-1<d.type.indexOf("Integer")||-1<d.type.indexOf("Double")||-1<d.type.indexOf("Single")){var f=v.sanitizeHTML(a.userValue);
if(!1===isNaN(f)){if(0!==v.sanitizeHTML(a.userValue)%1){var g=f.split(".");6<g[1].length&&(g[1]=g[1].substring(0,6),f=g[0]+"."+g[1]);"\x3d"===a.operator?a.operator="LIKE":"\x3c\x3e"===a.operator&&(a.operator="NOT LIKE")}e+=this.createQuery(!0,h.field,a.operator,f,a.conjunc,d.type)}else console.log("Not a Number")}else-1<d.type.indexOf("Date")?""!==a.userValue?(f=new Date(v.sanitizeHTML(a.userValue)),-1<d.type.indexOf("Time")?u.format(f,{fullYear:!0,datePattern:"yyyy-MM-dd, HH:mm:ss a"}):u.format(f,
{fullYear:!0,datePattern:"yyyy-MM-dd"}),e+=this.createQuery(!1,h.field,a.operator,f,a.conjunc,d.type)):e+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,d.type):e+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,d.type);b.def.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc});c.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc})}}))}));else if(0<=h.layer.indexOf(d.id)){b.def=
[];m="MapService";var p=h.layer.split(".");l.forEach(a,f.hitch(this,function(a){if(""!==a.userValue)if(-1<h.dataType.indexOf("Integer")||-1<h.dataType.indexOf("Double"))e+=this.createQuery(!0,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);else if(-1<h.dataType.indexOf("Date"))if(""!==a.userValue){var d=new Date(v.sanitizeHTML(a.userValue)),d=-1<h.dataType.indexOf("Time")?u.format(d,{fullYear:!0,datePattern:"yyyy-MM-dd, HH:mm:ss a"}):u.format(d,{fullYear:!0,datePattern:"yyyy-MM-dd"});
e+=this.createQuery(!1,h.field,a.operator,d,a.conjunc,h.dataType)}else e+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);else e+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);else e+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);b.def.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc});c.push({field:h.field,value:v.sanitizeHTML(a.userValue),
operator:a.operator,conjunc:a.conjunc})}));""!==e&&(g[p[1]]=e.trim())}k=h.layer;"undefined"!==typeof b.appendSameLayer&&!1===b.appendSameLayer?this.setupFilterToApply(d,m,e,g):n===b.layers.length-1&&this.setupFilterToApply(d,m,e,g)}))}));"undefined"!==typeof c&&0<c.length&&this._publishData(c)}}))},setupFilterToApply:function(a,b,c,d){"FeatureLayer"===b?""!==c&&(this._applyFilter(a.layerObject,c.trim()),a.layerObject.setVisibility(!0)):"MapService"===b&&0<d.length&&(this.chkAppendToDef.checked?l.forEach(this.defaultDef,
f.hitch(this,function(b){b.layer===a.id&&(l.forEach(d,f.hitch(this,function(a,c){for(var f in b.definition)"undefined"!==b.definition[f]&&d[c.toString()]&&(d[c.toString()]="("+b.definition[f]+") "+this.slAppendChoice.value+" "+a)})),a.layerObject.setLayerDefinitions(d),this._zoomOnFilter(a.layerObject))})):(a.layerObject.setLayerDefinitions(d),this._zoomOnFilter(a.layerObject)),a.layerObject.setVisibility(!0))},resetLayerDef:function(a){"undefined"===typeof a.group&&(a.group=this.grpSelect.value);
l.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&l.forEach(b.layers,f.hitch(this,function(a){l.forEach(this.layerList,f.hitch(this,function(b){var c=!1;a.layer===b.id?c=!0:0<b.newSubLayers.length&&l.forEach(b.newSubLayers,f.hitch(this,function(d){d=b.id+"."+d.id.substring(d.id.lastIndexOf("_")+1);a.layer===d&&(c=!0)}));c&&l.forEach(this.defaultDef,f.hitch(this,function(a){a.layer===b.id&&("undefined"!==typeof b.layerObject.defaultDefinitionExpression?this._applyFilter(b.layerObject,
a.definition):"undefined"!==typeof b.layerObject.layerDefinitions?b.layerObject.setLayerDefinitions(a.definition):this._applyFilter(b.layerObject,a.definition),b.layerObject.setVisibility(a.visible))}))}))}))}))},updateGroupDesc:function(a){l.forEach(this.config.groups,f.hitch(this,function(b){b.name===a&&(this.groupDesc.innerHTML=b.desc)}))},toggleSaveFilter:function(){var b;0<a(".saveTD").length?(b=a(".container"),0<b.length&&(g.replace(k.byId("saveTD"),"saveTDClose","saveTD"),b.style("display",
"none"),a(".saveContainer").style("display","block"),a(".groupContainer").style("display","none"),a(".buttonContainer").style("display","none"))):(b=a(".saveTDClose"),0<b.length&&(g.replace(b[0],"saveTD","saveTDClose"),b=a(".container"),0<b.length&&(g.replace(k.byId("saveTD"),"saveTD","saveTDClose"),b.style("display","block"),a(".saveContainer").style("display","none"),a(".groupContainer").style("display","block"),a(".buttonContainer").style("display","block"))))},saveJsonToFile:function(){var a=
new I({config:this.config});this.own(d(a,"complete",f.hitch(this,function(){console.log("save done")})));a.exportsJson(this.nls.files.jsonFile+".json",this.config)},readJsonToConfig:function(){a(".loadProgressHeader").style("display","block");a(".loadProgressShow").style("display","block");var b=new J({config:this.config,jsonFile:this.jsonFileInput.files});this.own(d(b,"complete",f.hitch(this,function(b){this.config=JSON.parse(b.UserSettings);this.resetLayerDef({group:this.grpSelect.value});this.removeAllRows();
this.checkDomainUse({group:this.grpSelect.value});this.checkDateUse({group:this.grpSelect.value});this.reconstructRows(this.grpSelect.value);this.updateGroupDesc(this.grpSelect.value);setTimeout(f.hitch(this,this.setFilterLayerDef),1E3);a(".loadProgressHeader").style("display","none");a(".loadProgressShow").style("display","none");this.jsonFileInput.value=null;this.toggleSaveFilter()})));this.own(d(b,"error",f.hitch(this,function(){this.jsonFileInput.value=null;a(".loadProgressHeader").style("display",
"none");a(".loadProgressShow").style("display","none")})));b.checkFileReader();return!0},_publishData:function(a){var b=[],c=[];l.forEach(a,f.hitch(this,function(a){-1===b.indexOf(a.field)&&b.push(a.field);-1===c.indexOf(a.value)&&c.push(a.value)}));this.publishData({message:{fields:b,values:c}})},resize:function(){var c=a(".jimu-single-filter-parameter");0<c.length&&l.forEach(c,f.hitch(this,function(c){c=a("colgroup",c);0<c.length&&b.set(c[0].childNodes[1],"width","0px")}));320>=window.innerWidth?
(g.add(this.btnCriteria,"hide-items"),a(".operator-class").style("display","none"),a(".container").style("borderTop","0px"),a(".value-class").style("paddingTop","-10px")):this.config.simpleMode||(g.remove(this.btnCriteria,"hide-items"),a(".operator-class").style("display","block"),a(".container").style("borderTop","3px solid"),a(".value-class").style("paddingTop","0px"))},_applyFilter:function(a,b){var c=!1;"AND"===this.slAppendChoice.value&&(c=!0);H.getInstance().applyWidgetFilter(a.id,this.id,b,
this.chkAppendToDef.checked,c);this._zoomOnFilter(a)},_zoomOnFilter:function(a){if(this.config.zoomMode)if("undefined"!==typeof a.layerDefinitions&&0<a.layerDefinitions.length)var b=d(this.map,"update-end",f.hitch(this,function(){var c=new E;c.outFields=["*"];for(var d in a.layerDefinitions)if(a.layerDefinitions.hasOwnProperty(d)){var e=a.url+"/"+d;c.where=a.layerDefinitions[d];c.returnGeometry=!0;c.outSpatialReference=this.map.spatialReference;(new D(e)).executeForExtent(c,f.hitch(this,this._queryExtentToZoom))}b.remove()}));
else{var c=new E;c.outFields=["*"];if("ArcGISImageServiceLayer"===a.type){var e=a.url;c.where=a.getDefinitionExpression();c.returnGeometry=!0;c.outSpatialReference=this.map.spatialReference;(new D(e)).executeForExtent(c,f.hitch(this,this._queryExtentToZoom))}else a.queryExtent(c,f.hitch(this,this._queryExtentToZoom))}},_queryExtentToZoom:function(a){if("undefined"!==typeof a.extent&&null!==a.extent){var b;b=102100!==a.extent.spatialReference.wkid&&102113!==a.extent.spatialReference.wkid&&3857!==a.extent.spatialReference.wkid&&
4326!==a.extent.spatialReference.wkid?C.buffer(a.extent,10,9002,!1).getExtent():C.geodesicBuffer(a.extent,10,9002,!1).getExtent();null===this.filterExt&&(this.filterExt=b);b=b.update(this.filterExt.xmin<b.xmin?this.filterExt.xmin:b.xmin,this.filterExt.ymin<b.ymin?this.filterExt.ymin:b.ymin,this.filterExt.xmax>b.xmax?this.filterExt.xmax:b.xmax,this.filterExt.ymax>b.ymax?this.filterExt.ymax:b.ymax,b.spatialReference);this.filterExt=b=102100!==a.extent.spatialReference.wkid&&102113!==a.extent.spatialReference.wkid&&
3857!==a.extent.spatialReference.wkid&&4326!==a.extent.spatialReference.wkid?C.buffer(b,200,9002,!1).getExtent():C.geodesicBuffer(b,200,9002,!1).getExtent();this.map.setExtent(b)}},onOpen:function(){console.log("onOpen")},onClose:function(){this.chkPersistDef.checked||(this.resetLayerDef({group:this.grpSelect.value}),this.removeAllRows(),this.reconstructRows(""))},onMinimize:function(){console.log("onMinimize")},onMaximize:function(){console.log("onMaximize")},onSignIn:function(a){console.log("onSignIn")},
onSignOut:function(){console.log("onSignOut")}})});